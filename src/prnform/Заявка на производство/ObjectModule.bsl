Функция Печать() Экспорт
	
	ТабДокумент = ПечатьПоЗаказуПокупателя();
	ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт; 
	ТабДокумент.АвтоМасштаб = Истина;
	
	Возврат ТабДокумент;
			
КонецФункции // Печать

Функция ПечатьПоЗаказуПокупателя()
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("Макет");
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЗаданиеНаПроизводствоДисковТовары.Номенклатура.Код КАК Код,
		|	ЗаданиеНаПроизводствоДисковТовары.Номенклатура КАК Номенклатура,
		|	ЗаданиеНаПроизводствоДисковТовары.Количество КАК Количество,
		|	ЗаданиеНаПроизводствоДисковТовары.Применяемость,
		|	ЗаданиеНаПроизводствоДисковТовары.КомментарийТюнинг,
		|	ЗаданиеНаПроизводствоДисковТовары.Ссылка.Менеджер КАК Менеджер,
		|	ЗаданиеНаПроизводствоДисковТовары.Заготовка,
		|	ЗаданиеНаПроизводствоДисковТовары.Заготовка.Код КАК КодЗаготовки
		|ИЗ
		|	Документ.ЗаданиеНаПроизводствоДисков.Товары КАК ЗаданиеНаПроизводствоДисковТовары
		|ГДЕ
		|	ЗаданиеНаПроизводствоДисковТовары.Ссылка = &Ссылка";
		
		//Запрос.УстановитьПараметр("ВидТовара", Перечисления.ВидыТоваров.Диски);
		//Запрос.УстановитьПараметр("НоменклатурнаяГруппа", справочники.НоменклатурныеГруппы.НайтиПоКоду("00022"));

    Запрос.УстановитьПараметр("Ссылка", СсылкаНаОбъект);                                  
	Результат = Запрос.Выполнить();                                                                        

	ВыборкаДетальныеЗаписи = Результат.Выгрузить();
    Ном = Неопределено;
	Нагрузка = Неопределено;
	КоличествоИтого = 0;
	Шапка = Макет.ПолучитьОбласть("Шапка");
	Шапка.Параметры.Номер = СсылкаНаОбъект.Номер;
	Шапка.Параметры.дата = Формат(СсылкаНаОбъект.Дата,"ДЛФ=Д");
//	ТабДокумент.Вывести(Шапка);
	Областьстроки = Макет.ПолучитьОбласть("Строка");
	//ОбластьКартинка = Макет.ПолучитьОбласть("строка");
		
	Для каждого стр из ВыборкаДетальныеЗаписи Цикл
		
		ТабДокумент.Вывести(Шапка);

			//ЗаполнитьЗначенияСвойств(Областьстроки, ВыборкаДетальныеЗаписи); 
			Областьстроки.Параметры.Код = стр.Код;
			Областьстроки.Параметры.Номенклатура = стр.Номенклатура;
			Областьстроки.Параметры.количество = стр.количество;
			Областьстроки.Параметры.Применяемость = стр.Применяемость;
			Областьстроки.Параметры.КомментарийТюнинг = стр.КомментарийТюнинг;
			Областьстроки.Параметры.Менеджер = стр.Менеджер;
			Областьстроки.Параметры.КодЗаготовки = стр.КодЗаготовки;
			Областьстроки.Параметры.Заготовка = стр.Заготовка;
			
			
			
			ФайлПустаяКартинка=ПолучитьФайлССервера("http://photo.yst.ru/nopic_tyre_s.png");
			Областьстроки.Рисунки.Очистить();
			АдресКартинки = ПолучитьАдресКартинкиТовара(стр.Номенклатура);
			Картинка = неопределено;
			Если АдресКартинки<>"" и АдресКартинки <> неопределено тогда
				ФайлКартинки = ПолучитьФайлССервера(АдресКартинки);
				Если ФайлКартинки<>"" тогда				
					Картинка = неопределено;
					Если АдресКартинки<>"" и АдресКартинки <> неопределено тогда
						Картинка = Новый Картинка(ПолучитьФайлССервера(АдресКартинки));
						Если  Картинка = Неопределено Тогда
							Картинка = Новый Картинка(ФайлПустаяКартинка);
						КонецЕсли;	
						ФотоТовара = Областьстроки.Рисунки.Добавить(ТипРисункаТабличногоДокумента.Картинка);
						ФотоТовара.Верх = 0;
						ФотоТовара.Лево = 0;
						ФотоТовара.РазмерКартинки = РазмерКартинки.Пропорционально;
						ФотоТовара.Картинка = Картинка;
						ФотоТовара.Расположить(Областьстроки.Область(1, 2, 1, 1));
					КонецЕсли;
				КонецЕсли;
		    КонецЕсли;
			//ТабДокумент.Присоединить(ОбластьКартинка);
			ТабДокумент.Вывести(Областьстроки);
            ТабДокумент.ВывестиГоризонтальныйРазделительСтраниц();
		
		
	КонецЦикла;

Возврат ТабДокумент;	
	
КонецФункции