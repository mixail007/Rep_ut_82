Функция Печать() Экспорт
	
	Если Не Метаданные.Имя = "УправлениеТорговлей" Тогда
		Сообщить("Печатная форма предназначена для использования в конфигурации ""Управление торговлей""", СтатусСообщения.Внимание);
	КонецЕсли;
	
	Возврат ПечатьПоступления(СсылкаНаОбъект);
	
КонецФункции // Печать

Функция ПечатьПоступления (СсылкаНаОбъект) Экспорт
	
	Таб = Новый ТабличныйДокумент;

	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ЗаказПоставщикуСезонный") Тогда
		ТипДока = "ЗаказПоставщикуСезонный";
	ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ЗаказПоставщику") Тогда
		ТипДока = "ЗаказПоставщику";
	Иначе
		возврат Таб;
	КонецЕсли;	
	
	Макет = ПолучитьМакет("Макет");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
	ОбластьПроизводитель = Макет.ПолучитьОбласть("Производитель");
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьИтог = Макет.ПолучитьОбласть("Итог");
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	 "ВЫБРАТЬ
	 |	ЗаказПоставщикуСезонныйТовары.Номенклатура.Производитель КАК Производитель,
	 |	ЗаказПоставщикуСезонныйТовары.Номенклатура КАК Номенклатура,
	 |	ЗаказПоставщикуСезонныйТовары.Номенклатура.Код КАК Код,
	 |	ЗаказПоставщикуСезонныйТовары.Количество КАК Кол,
	 |	ЗаказПоставщикуСезонныйТовары.Сумма КАК Сумма,
	 |	ЗаказПоставщикуСезонныйТовары.СуммаНДС КАК СуммаНДС,
	 |	ЗаказПоставщикуСезонныйТовары.Вес КАК Вес
	 |ИЗ
	 |	Документ."+ТипДока+".Товары КАК ЗаказПоставщикуСезонныйТовары
	 |ГДЕ
	 |	ЗаказПоставщикуСезонныйТовары.Ссылка = &Ссылка
	 |
	 |УПОРЯДОЧИТЬ ПО
	 |	ЗаказПоставщикуСезонныйТовары.Номенклатура.Производитель.Наименование,
	 |	Номенклатура.Код
	 |ИТОГИ
	 |	СУММА(Кол),
	 |	СУММА(Сумма),
	 |	СУММА(СуммаНДС),
	 |	СУММА(Вес)
	 |ПО
	 |	Производитель";
	 
		 
	 Запрос.УстановитьПараметр("Ссылка", СсылкаНаОбъект);
	 Таб.Вывести(ОбластьШапка);
	 Таб.ФиксацияСверху = Таб.ВысотаТаблицы;
	 ИтКол = 0;
	 ИтВес = 0;
	 ИтСум = 0;
	 ИтСумНДС = 0;
	 Таб.НачатьАвтогруппировкуСтрок();
	 Выборка = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	 Пока Выборка.Следующий() Цикл
		 ОбластьПроизводитель.Параметры.Заполнить(Выборка);
		 Таб.Вывести(ОбластьПроизводитель,1);
		 ИтКол = ИтКол+Выборка.Кол;
		 ИтВес = ИтВес+Выборка.Вес;
		 ИтСум = ИтСум+Выборка.Сумма;
		 ИтСумНДС = ИтСумНДС+Выборка.СуммаНДС;
		 ВыборкаТов = Выборка.Выбрать();
		 Пока ВыборкаТов.Следующий() Цикл
			 ОбластьСтрока.Параметры.Заполнить(ВыборкаТов);
			 Таб.Вывести(ОбластьСтрока,2,,Ложь);
		КонецЦикла;
	 КонецЦикла;	 
	 Таб.ЗакончитьАвтогруппировкуСтрок(); 

	 ОбластьИтог.Параметры.ИтКол = ИтКол;
	 ОбластьИтог.Параметры.ИтСум = ИтСум;
	 ОбластьИтог.Параметры.ИтВес = ИтВес;
 	 ОбластьИтог.Параметры.ИтСумНДС = ИтСумНДС;
	 Таб.Вывести(ОбластьИтог);

	 Таб.ТолькоПросмотр = Истина;
	 Таб.Показать();
	
КонецФункции