Перем ДатаНачалаТТН_13032012, ДатаНачалаТТН_250711, мВалютаРегламентированногоУчета Экспорт;


Функция Печать(ИзДокумента=Истина, мск = "") Экспорт
	
	Если НЕ ЗначениеЗаполнено(СсылкаНаОбъект) Тогда
		#Если Клиент Тогда
			Сигнал();
			Предупреждение("Выберите документ, для которого необходимо сформировать Транспортную Накладную.",30,"Выберите документ");
		#КонецЕсли		  
	КонецЕсли;  
	
	если ИзДокумента Тогда //откроем форму
		//Форма  = ЭтотОбъект.ПолучитьФорму("Форма").ОткрытьМодально(); //так было
		ЭтотОбъект.ПолучитьФорму("Форма").Открыть();
		ТабДок = Неопределено;
	Иначе
		//+++04.08.2011	ВвестиЧисло(номСтолб,"Число столбцов для назв.товаров",1, 0);
		//АВТО-определение как надо печатать...
		Если (ЭтотОбъект.СсылкаНаОбъект.Организация.ИНН = "7604069216")          // ЗАО ТК Яршинторг (Ярославль)
			или (ЭтотОбъект.СсылкаНаОбъект.Организация.ИНН = "760200230721") Тогда  // ИП Фролов
			номСтолб=0;
			//Орлов++
			ВариантОформления = 0;//один перевозчик
			Если ЭтотОбъект.Перевозчик <> "" И ЭтотОбъект.Перевозчик2 <> "" И ЭтотОбъект.Перевозчик = ЭтотОбъект.Перевозчик2 Тогда
				ВариантОформления = 1;//один перевозчик, две машины
			ИначеЕсли ЭтотОбъект.Перевозчик <> "" И ЭтотОбъект.Перевозчик2 <> "" И ЭтотОбъект.Перевозчик <> ЭтотОбъект.Перевозчик2 Тогда
				ВариантОформления = 2;//два перевозчика, две машины
			КонецЕсли;
			//было:
			//ТабДок = ПечатьТТН_250711_ЯШТ(номСтолб, мск); // числоСтолбцов =1,2,3,4
			//стало:
			ТабДок = ПечатьТТН_250711_ЯШТ(номСтолб, мск, ВариантОформления); // числоСтолбцов =1,2,3,4
			Если ВариантОформления = 2 Тогда
				ПечатьТТН_250711_ЯШТ_2_экземпляр(номСтолб, мск, ВариантОформления);
			КонецЕсли;
			//Орлов--
		Иначе//как было
			ТабДок = ПечатьТТН_250711(); 
		КонецЕсли;
	КонецЕсли;
	
	Возврат ТабДок;
	
КонецФункции

//+++(
функция ПечатьТТН_250711()
	
		#Если Клиент Тогда
		Если СсылкаНаОбъект.Дата<ДатаНачалаТТН_250711 Тогда
			Сигнал();
		    Предупреждение("Транспортная Накладная (Приложение №4) - принята 15.04.2011 №272,
	  				  | но вступает в силу только с "+Формат(ДатаНачалаТТН_250711,"ДФ=dd.MM.yyyy")+",
					  | и на дату: "+Формат(СсылкаНаОбъект.Дата,"ДФ=dd.MM.yyyy")+" - еще не действует!",60,"Транспортная Накладная - не действительна!");
		КонецЕсли;  
		#КонецЕсли		  
				  
	
	
ТабДокумент = Новый ТабличныйДокумент;
ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ТТН_Приложение4";

Макет       = ПолучитьМакет("Приложение4");

ОбластьМакета = Макет.ПолучитьОбласть("Лицевая");

	ОбШтрихКод=ОбластьМакета.Рисунки.Штрихкод.Объект;
	ОбШтрихКод.ТипКода = 4; 
	ОбШтрихКод.Сообщение = СформироватьШКРеализации(СсылкаНаОбъект,"2");//XMLСтрока(ЭтотОбъект.Ссылка.УникальныйИдентификатор()); 
	ОбШтрихКод.ОтображатьТекст = Ложь;




//-------параметры лицевой стороны-----------------------
    Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ОперацияПоОтветственномуХранению") Тогда
		Шапка = ПолучитьШапку_отвХран();	
	ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
		Шапка = ПолучитьШапку_Перемещение();
	Иначе
		Шапка = ПолучитьШапку();
	КонецЕсли;

	СведенияОПоставщике       = СведенияОЮрФизЛице(Шапка.Организация, Шапка.ДатаДокумента,, Шапка.БанковскийСчет);	
	//СведенияОПокупателе       = СведенияОЮрФизЛице(Шапка.Покупатель,       Шапка.ДатаДокумента);
	СведенияОГрузоотправителе = СведенияОЮрФизЛице(Шапка.Грузоотправитель,  Шапка.ДатаДокумента);
	СведенияОГрузополучателе  = СведенияОЮрФизЛице(Шапка.Грузополучатель,   Шапка.ДатаДокумента);

	
	
	ГрузоотправительПредставление = ОписаниеОрганизации(СведенияОГрузоотправителе, "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны");//,НомерСчета,Банк,БИК,КоррСчет");
	Если Шапка.Грузоотправитель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ФизЛицо Тогда 
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = ГрузоотправительПредставление;
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = "";
	Иначе	
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = "";
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = ГрузоотправительПредставление;
	КонецЕсли;	
	
	ГрузополучательПредставление  = ОписаниеОрганизации(СведенияОГрузополучателе,  "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны"); //,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
	Если Шапка.Грузополучатель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ЮрЛицо Тогда
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = ГрузополучательПредставление;
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = "";
	Иначе 
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = "";
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = ГрузополучательПредставление;
	КонецЕсли;
	//ОбластьМакета.Параметры.ПлательщикПредставление       = ОписаниеОрганизации(СведенияОПокупателе);
	

	
	//---------------Заполнение значений макета ----------------------------
	ОбластьМакета.Параметры.НомерЭкземпляра = НомерЭкземпляра;
	ОбластьМакета.Параметры.НомерДокумента  = ПолучитьНомерНаПечать(Шапка);
	ОбластьМакета.Параметры.ДатаДокумента   = Формат(Шапка.ДатаДокумента, "Л=ru_RU; ДЛФ=DD; ДП=-");
	ГрузоотправительПредставление = ОписаниеОрганизации(СведенияОГрузоотправителе, "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны");//,НомерСчета,Банк,БИК,КоррСчет");
	
	Если Шапка.Грузоотправитель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ФизЛицо Тогда 
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = ГрузоотправительПредставление;
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = "";
	Иначе	
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = "";
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = ГрузоотправительПредставление;
	КонецЕсли;	
	
	ГрузополучательПредставление  = ОписаниеОрганизации(СведенияОГрузополучателе,  "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны"); //,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
	Если Шапка.Грузополучатель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ЮрЛицо Тогда
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = ГрузополучательПредставление;
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = "";
	Иначе 
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = "";
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = ГрузополучательПредставление;
	КонецЕсли;
	//ОбластьМакета.Параметры.ПлательщикПредставление       = ОписаниеОрганизации(СведенияОПокупателе);
	
	
	//1,2
	//ОтпускРазрешилДолжность					ФИООтпускРазрешил	ГрузПринялДолжность					ГрузПолучилДолжность
	
	//  Если НЕ Шапка.ОтгрузкаЧерезЧП Тогда
	Кладовщик = ПолучитьКладовщика();
	
		ОбластьМакета.Параметры.ФИООтпускПроизвел = Кладовщик;
		ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "";
	//КонецЕсли; 
	  ОбластьМакета.Параметры.ФИОГрузПолучил = "";
	  ОбластьМакета.Параметры.ГрузПолучилДолжность = "";
	  
	 //3 ------------------------------------------------------------  
	ОбластьМакета.Параметры.Пункт3_1 = Пункт3_1;
	
	//+++ Нетто, Брутто //, ОбъемШтук, ОбъемМест
	выборка2 = ПолучитьВесОбъем();
	Если Выборка2.Количество()>0 Тогда
	Выборка2.Следующий();
	ОбластьМакета.Параметры.МассаГрузаНетто  = ?(Выборка2.Нетто<>0,Формат(Выборка2.Нетто,"ЧН= ")+"кг; ", "");
	ОбластьМакета.Параметры.МассаГрузаБрутто = ?(Выборка2.Брутто<>0, "("+Формат(Выборка2.Брутто,"ЧН= ")+"кг); ", "");
	кол = Выборка2.Количество;
	колМест = Выборка2.КоличествоМест;
	//ОбластьМакета.Параметры.ВсегоМестПрописью = ?(колМест=0, ?(кол=0,"",Строка(кол)+" шт."), строка(колМест)+" мест");
	
	Иначе 
	ОбластьМакета.Параметры.МассаГрузаНетто  = "";
	ОбластьМакета.Параметры.МассаГрузаБрутто = "";
	ОбластьМакета.Параметры.ВсегоМестПрописью = "";
	конецЕсли;
	
	
	//3.2 КолМест, маркировка-------------------------------------------
	ОбластьМакета.Параметры.Пункт3_2 = Пункт3_2;
	
	// [МассаГрузаНетто]; [МассаГрузаБрутто]; [Размеры]; [ОбъемМест]
	ОбластьМакета.Параметры.Пункт3_3 = Пункт3_3;

	
	//4
	ОбластьМакета.Параметры.ПереченьДопДокументов = ПереченьДопДокументов;
	ОбластьМакета.Параметры.ПереченьСертификатов  = ПереченьСертификатов;
	//5
    ОбластьМакета.Параметры.Пункт5_1 = Пункт5_1;
 	ОбластьМакета.Параметры.Пункт5_2 = Пункт5_2;
 	ОбластьМакета.Параметры.Пункт5_3 = Пункт5_3;
 	
	//6,7
	Если СведенияОГрузоотправителе.Представление<>Неопределено Тогда 
	ОбластьМакета.Параметры.ПунктПогрузки  = ?(ПунктПогрузки="", ?(СведенияОГрузоотправителе.ФактическийАдрес="", СведенияОГрузоотправителе.ЮридическийАдрес, СведенияОГрузоотправителе.ФактическийАдрес), ПунктПогрузки);
	КонецЕсли;

	Если СведенияОГрузоПолучателе.Представление<>Неопределено Тогда 
	ОбластьМакета.Параметры.ПунктРазгрузки = ?(ПунктРазгрузки="", ?(СведенияОГрузоПолучателе.ФактическийАдрес="",СведенияОГрузоПолучателе.ЮридическийАдрес,СведенияОГрузоПолучателе.ФактическийАдрес) , ПунктРазгрузки);
	КонецЕсли;
    ОбластьМакета.Параметры.Пункт6_6 = Пункт6_6;
	ОбластьМакета.Параметры.Пункт7_6 = Пункт7_6;
	
	ОбластьМакета.Параметры.ДатаВремяПогрузки = ДатаВремяПогрузки;// ?(ДатаВремяПогрузки<>Дата(1,1,1), ДатаВремяПогрузки, СсылкаНаОбъект.Дата );
	ОбластьМакета.Параметры.ДатаВремяВыгрузки = ДатаВремяВыгрузки;// ?(ДатаВремяВыгрузки<>Дата(1,1,1), ДатаВремяВыгрузки, СрокДоставки );
	
	ОбластьМакета.Параметры.СостояниеГрузаОтправителя  = СостояниеГрузаОтправителя;
	ОбластьМакета.Параметры.СостояниеГрузаПолучателя  = СостояниеГрузаПолучателя;
							
	ОбластьМакета.Параметры.ВсегоМестПрописью = Пункт3_2;
	//ОбластьМакета.Параметры.ВсегоНаименований = Формат(СсылкаНаОбъект.Товары.Количество(),"ЧН=-")+" тов.";
	
	//8
	ОбластьМакета.Параметры.СрокДоставки1 = Формат(СрокДоставки1,"ДФ=dd.MM.yyyy; ДП=---");
	//+++ ОбластьМакета.Параметры.ВидПеревозки = ?(ЗначениеЗаполнено(ВидПеревозки), ВидПеревозки, "Автомобильным транспортом");
	
	ТабДокумент.Вывести(ОбластьМакета);

	
	
ТабДокумент.ВывестиГоризонтальныйРазделительСтраниц();

				
//========================параметры оборотной стороны==========================================
ОбластьМакета = Макет.ПолучитьОбласть("Оборотная");

//10
Если ТипЗнч(Перевозчик)<>Тип("Строка") Тогда
  Если ЗначениеЗаполнено(Перевозчик) Тогда
	СведенияОПеревозчике = СведенияОЮрФизЛице(Перевозчик,  Шапка.ДатаДокумента);
    ПеревозчикПредставление = ОписаниеОрганизации(СведенияОПеревозчике,  "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны"); //,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
	
	Если Перевозчик.ЮрФизЛицо = перечисления.ЮрФизЛицо.ФизЛицо Тогда 
		ОбластьМакета.Параметры.ОрганизацияПеревозчикФ = ПеревозчикПредставление;
		ОбластьМакета.Параметры.ОрганизацияПеревозчикЮ = "";
	Иначе	
		ОбластьМакета.Параметры.ОрганизацияПеревозчикФ ="";
		ОбластьМакета.Параметры.ОрганизацияПеревозчикЮ = ПеревозчикПредставление;
	КонецЕсли;

	//Иначе
	//Перевозчик = Шапка.Грузоотправитель;
	//СведенияОПеревозчике = СведенияОгрузоотправителе;
	//ПеревозчикПредставление = ГрузоотправительПредставление;
	//ФИОруководителя = Руководители.Руководитель;
  КонецЕсли;
Иначе //строка!
  ОбластьМакета.Параметры.ОрганизацияПеревозчикЮ = Перевозчик;
КонецЕсли;

    //+++ 29.07.2011 Кладовщик = ПолучитьКладовщика();
 	ОбластьМакета.Параметры.ФИОруководителя = ""; //Кладовщик

 	ОбластьМакета.Параметры.ФИОВодителя               = Водитель;
	ОбластьМакета.Параметры.ВодительскоеУдостоверение = ВодительскоеУдостоверение;
	
	
//11
	ОбластьМакета.Параметры.МаркаАвтомобиля           = СокрЛП(МаркаАвтомобиля);
	ОбластьМакета.Параметры.Прицеп                    = ?(ЗначениеЗаполнено(МаркаПрицепа), "Прицеп: "+МаркаПрицепа, "");
	
	ОбластьМакета.Параметры.ГосНомерАвтомобиля        = ГосНомерАвтомобиля;
	ОбластьМакета.Параметры.ГосНомерПрицепа           = ?(ЗначениеЗаполнено(ГосНомерПрицепа), "Прицеп: "+ГосНомерПрицепа, "");
	
//12
	ОбластьМакета.Параметры.СостояниеГрузаОтправителя  = СостояниеГрузаОтправителя;
	ОбластьМакета.Параметры.СостояниеГрузаПолучателя  = СостояниеГрузаПолучателя;
	
//15
ОбластьМакета.Параметры.ВсегоКОплате     = "";
ОбластьМакета.Параметры.ПроцентНаценки   = ""; //"процент: ";
ОбластьМакета.Параметры.СкладскиеРасходы = "";

//16
	 ОбластьМакета.Параметры.ФИООтпускПроизвел       = кладовщик;
     ОбластьМакета.Параметры.ДатаПогрузки = ЭтотОбъект.ДатаВремяПогрузки; //кладовщик
	
	 //  ОбластьМакета.Параметры.Пункт10_1Ведомость = Пункт10_1;
	  
	  ОбластьМакета.Параметры.ФИОГрузПолучил = СсылкаНаОбъект.Контрагент.ОсновноеКонтактноеЛицо;//осн.контактное лицо!
	  ОбластьМакета.Параметры.ДатаРазгрузки = ЭтотОбъект.ДатаВремяВыгрузки; //кладовщик
 	 // ОбластьМакета.Параметры.Пункт10_1Ведомость = Пункт10_2;
	  
ТабДокумент.Вывести(ОбластьМакета);

возврат ТабДокумент;

КонецФункции // ПечатьТТН_250711()

//04.08.2011 - название - в виде таблицы 
функция ПечатьТТН_250711_ЯШТ(КолСтолб = 0, КонтрагентМосква="", ВариантОформления = 0)
	#Если Клиент Тогда
		Если СсылкаНаОбъект.Дата<ДатаНачалаТТН_250711 Тогда
			Сигнал();
			Предупреждение("Транспортная Накладная (Приложение №4) - принята 15.04.2011 №272,
			| но вступает в силу только с "+Формат(ДатаНачалаТТН_250711,"ДФ=dd.MM.yyyy")+",
			| и на дату: "+Формат(СсылкаНаОбъект.Дата,"ДФ=dd.MM.yyyy")+" - еще не действует!",60,"Транспортная Накладная - не действительна!");
		КонецЕсли;  
	#КонецЕсли		  
	
	
	
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	
	Если СсылкаНаОбъект.Дата<ДатаНачалаТТН_13032012 Тогда 
		ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ТТН_Приложение4";
		Макет       = ПолучитьМакет("Приложение4_ЯШТ");
	Иначе
		Если ВариантОформления = 0 ИЛИ ВариантОформления = 2 Тогда
			ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ТТН_Приложение4_13032012";
			Макет       = ПолучитьМакет("Приложение4_ЯШТ_13032012");	
		ИначеЕсли ВариантОформления = 1 Тогда
			ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ТТН_Приложение4_ЯШТ_13032013_2_водителя";
			Макет       = ПолучитьМакет("Приложение4_ЯШТ_13032013_2_водителя");
		КонецЕсли;
		//Орлов--
	КонецЕсли;
	ОбластьМакета = Макет.ПолучитьОбласть("Лицевая");
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
		ОбШтрихКод=ОбластьМакета.Рисунки.Штрихкод.Объект;
		ОбШтрихКод.ТипКода = 4; 
		ОбШтрихКод.Сообщение = СформироватьШКРеализации(СсылкаНаОбъект,"2");//XMLСтрока(ЭтотОбъект.Ссылка.УникальныйИдентификатор()); 
		ОбШтрихКод.ОтображатьТекст = Ложь;
	ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
		ОбШтрихКод=ОбластьМакета.Рисунки.Штрихкод.Объект;
		ОбШтрихКод.ТипКода = 4; 
		ОбШтрихКод.Сообщение = СформироватьШКРеализации(СсылкаНаОбъект,"T");  // "T" - английское
		ОбШтрихКод.ОтображатьТекст = Ложь;
    иначе
		ОбластьМакета.Рисунки.Штрихкод.ВыводитьНаПечать = Ложь;
	конецЕсли;
	//-------параметры лицевой стороны-----------------------
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ОперацияПоОтветственномуХранению") Тогда
		Шапка = ПолучитьШапку_отвХран();
		
	ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
		Шапка = ПолучитьШапку_Перемещение();
	Иначе
		Шапка = ПолучитьШапку();
	КонецЕсли;
	
	СведенияОПоставщике       = СведенияОЮрФизЛице(Шапка.ЮрФизЛицо,    Шапка.ДатаДокумента,, Шапка.БанковскийСчет);	
	//СведенияОПокупателе     = СведенияОЮрФизЛице(Шапка.Покупатель,      Шапка.ДатаДокумента);
	///////////////////////Плотников 11.02.2016 ОперацияПоОтветственномуХранению.Перемещение
	
	СведенияОГрузоотправителе = СведенияОЮрФизЛице(Шапка.Грузоотправитель,  Шапка.ДатаДокумента);
		
	///////////////////////Плотников 11.02.2016 ОперацияПоОтветственномуХранению.Перемещение
	
	Если КонтрагентМосква="" Тогда //+++ 10.05.2012
		СведенияОГрузополучателе  = СведенияОЮрФизЛице(Шапка.Грузополучатель,   Шапка.ДатаДокумента);
	Иначе
		СведенияОГрузополучателе  = СведенияОЮрФизЛице(КонтрагентМосква,   Шапка.ДатаДокумента);
	КонецЕсли;
		 
   	ГрузоотправительПредставление = ОписаниеОрганизации(СведенияОГрузоотправителе, "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны");//,НомерСчета,Банк,БИК,КоррСчет");
	ГрузополучательПредставление  = ОписаниеОрганизации(СведенияОГрузополучателе,  "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны"); //,Телефоны,НомерСчета,Банк,БИК,КоррСчет");

	Если Шапка.Грузоотправитель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ФизЛицо Тогда 
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = ГрузоотправительПредставление;
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = "";
	Иначе	
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = "";
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = ГрузоотправительПредставление;
	КонецЕсли;	
	
	Если Шапка.Грузополучатель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ЮрЛицо Тогда
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = ГрузополучательПредставление;
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = "";
	Иначе 
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = "";
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = ГрузополучательПредставление;
	КонецЕсли;
			
	//ОбластьМакета.Параметры.ПлательщикПредставление       = ОписаниеОрганизации(СведенияОПокупателе);
	
	
	//---------------Заполнение значений макета ----------------------------
	ОбластьМакета.Параметры.НомерЭкземпляра = НомерЭкземпляра;
	ОбластьМакета.Параметры.НомерДокумента  = ПолучитьНомерНаПечать(СсылкаНаОбъект); //23.08.2018
	ОбластьМакета.Параметры.ДатаДокумента   = Формат(Шапка.ДатаДокумента, "Л=ru_RU; ДЛФ=DD; ДП=-");
	ГрузоотправительПредставление = ОписаниеОрганизации(СведенияОГрузоотправителе, "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны"); //НомерСчета,Банк,БИК,КоррСчет"
	
	Если Шапка.Грузоотправитель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ФизЛицо Тогда 
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = ГрузоотправительПредставление;
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = "";
	Иначе	
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = "";
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = ГрузоотправительПредставление;
	КонецЕсли;	
		
	ГрузополучательПредставление  = ОписаниеОрганизации(СведенияОГрузополучателе,  "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны"); //,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
	//ОЛ 12.02.2015
	//В Белоруссии вместо ИНН должно быть УНП, в Казахстане - БИН
	
	//у перемещения - нет договора +++ 12.02.2015
	дог = ?(ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.ПеремещениеТоваров"),
					?(СсылкаНаОбъект.ВнутреннийЗаказ.Пустая(), справочники.ДоговорыКонтрагентов.ПустаяСсылка(), 
						?(СсылкаНаОбъект.ВнутреннийЗаказ.ДокументОснование.Пустая(), справочники.ДоговорыКонтрагентов.ПустаяСсылка(), СсылкаНаОбъект.ВнутреннийЗаказ.ДокументОснование.ДоговорКонтрагента)
					  ),
					СсылкаНаОбъект.ДоговорКонтрагента);
					
	Если дог.ТипДоговора = Справочники.ТипыДоговоров.ШинтрейдЯрославль Тогда
		Если СокрЛП(Шапка.Грузополучатель.НаименованиеИННэкспорт)<>"" Тогда
			ГрузополучательПредставление = СтрЗаменить(ГрузополучательПредставление," ИНН "," "+СокрЛП(Шапка.Грузополучатель.НаименованиеИННэкспорт)+" ");
		Иначе
			сообщить("В сведениях о грузополучателе вместо ИНН должно быть УНП, БИН или др. Необходимо заполнить справочник контрагенты.");
		КонецЕсли;
	КонецЕсли;	
	//конец ОЛ

	Если Шапка.Грузополучатель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ЮрЛицо Тогда
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = ГрузополучательПредставление;
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = "";
	Иначе 
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = "";
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = ГрузополучательПредставление;
	КонецЕсли;
	
	//  Если НЕ Шапка.ОтгрузкаЧерезЧП Тогда
	Кладовщик = ПолучитьКладовщика();
	ОбластьМакета.Параметры.ФИООтпускПроизвел = Кладовщик;
	//Орлов++
	//+Лукьяненков 29.08.2017
	Если  СсылкаНаОбъект.Дата>='20170330' и СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00106") Тогда 
		ОбластьМакета.Параметры.ФИООтпускПроизвел = СокрЛП(СсылкаНаОбъект.Ответственный.Код);
		//ОбластьМакета.Параметры.ФИООтпускПроизвел = "Радченко И. Я.";
	//-Лукьяненков 29.08.2017
	//Миронычев АЕ 30,04,17
	ИначеЕсли СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00106") Тогда
		//ОбластьМакета.Параметры.ФИООтпускПроизвел = "Иноземцева Н.И.";  //07.09.17
		ОбластьМакета.Параметры.ФИООтпускПроизвел = СокрЛП(СсылкаНаОбъект.Ответственный.Код);

	//Конец Миронычев АЕ 03,04,17
	ИначеЕсли СсылкаНаОбъект.Дата>='20131031' и СсылкаНаОбъект.Ответственный = Справочники.Пользователи.НайтиПоКоду("Михалева Е. А.") Тогда
		ОбластьМакета.Параметры.ФИООтпускПроизвел = "Михалева Е.А.";			
	КонецЕсли;	
	//Орлов--
		ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика(Кладовщик);  //!!!
	
	//КонецЕсли; 
	ОбластьМакета.Параметры.ФИОГрузПолучил = "";
	ОбластьМакета.Параметры.ГрузПолучилДолжность = "";
	
	//2013.11.14 ФормулаАвто
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
		Если СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.НайтиПоКоду("Я0004") Тогда //ФормулаАвто
			ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = "";
			ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = "Общество с ограниченной ответственностью ""Формула Авто"", 150014, Ярославская обл, Ярославль г, Салтыкова-Щедрина ул, дом №21, оф.414, р/с 40702810877030004619, в банке СЕВЕРНЫЙ БАНК СБЕРБАНКА РОССИИ, БИК 047888670, к/с 30101810500000000670";
			
			Если СсылкаНаОбъект.НомерФормулаАвто = 0 Тогда 
				НомерДокументаФА = ЭтотОбъект.ПолучитьФорму("ВводНомераФормулаАвто").ОткрытьМодально();
			Иначе
				НомерДокументаФА = СтрЗаменить(Строка(СсылкаНаОбъект.НомерФормулаАвто),Символы.НПП,""); 
			КонецЕсли;
		
			ОбластьМакета.Параметры.НомерДокумента  = НомерДокументаФА;
			
			ОбластьМакета.Параметры.ФИООтпускПроизвел = "";
		ИначеЕсли СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.ФормулаАвтоПлюс Тогда //ФормулаАвто
			ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = "";
			
			Если СсылкаНаОбъект.Дата < '2018.01.12' Тогда
           		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = "Общество с ограниченной ответственностью ""Формула Авто Плюс"", 150003, Ярославская обл, Ярославль г, Полушкина Роща ул, дом №9,  р/с 40702810277030004620, в банке СЕВЕРНЫЙ БАНК СБЕРБАНКА РОССИИ, БИК 047888670, к/с 30101810500000000670";
			Иначе
				ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = "Общество с ограниченной ответственностью ""Формула Авто Плюс"", 150044, Ярославская обл, Ярославль г, Базовая ул, дом №3, оф.233,   р/с 40702810277030004620, в банке Калужское отделение № 8608 ПАО Сбербанк, БИК 042908612, к/с 30101810100000000612"; //Калужское отделение № 8608 ПАО Сбербанк, БИК 042908612, к/с 30101810100000000612
			КонецЕсли;
			
			Если СсылкаНаОбъект.НомерФормулаАвто = 0 Тогда 
				НомерДокументаФАП = ЭтотОбъект.ПолучитьФорму("ВводНомераФормулаАвтоПлюс").ОткрытьМодально();
			Иначе
				НомерДокументаФАП = СтрЗаменить(Строка(СсылкаНаОбъект.НомерФормулаАвто),Символы.НПП,""); 
			КонецЕсли;
		
			ОбластьМакета.Параметры.НомерДокумента  = НомерДокументаФАП;
			
			ОбластьМакета.Параметры.ФИООтпускПроизвел = "";
	
		ИначеЕсли СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.ШинтрейдЯрославль Тогда
			
			Если СсылкаНаОбъект.НомерФормулаАвто = 0 Тогда 
				НомерДокументаШТЯ = ЭтотОбъект.ПолучитьФорму("ВводНомераШинтрейдЯрославль").ОткрытьМодально();
			Иначе
				НомерДокументаШТЯ = СтрЗаменить(Строка(СсылкаНаОбъект.НомерФормулаАвто), Символы.НПП,""); 
			КонецЕсли;
			
			ОбластьМакета.Параметры.НомерДокумента  = НомерДокументаШТЯ;
		КонецЕсли;
	КонецЕсли;	
	
	//+++( 04.08.2011 - представление наименований в виде таблицы
	//==========================================================================================
	
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда 
		//РнД или Тл
		Если ( (СсылкаНаОбъект.СкладОтправитель.Подразделение.Код = "00106") или (СсылкаНаОбъект.СкладОтправитель.Подразделение.Код = "00172")) //10.09.2018
			и (СсылкаНаОбъект.СкладПолучатель.ТипСклада = перечисления.ТипыСкладов.ВПути)
			и ЗначениеЗаполнено(СсылкаНаОбъект.Ответственный) Тогда 
			РукФил = СсылкаНаОбъект.Ответственный.ФизЛицо;
			ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ПолучитьДолжность(СсылкаНаОбъект.СкладОтправитель.Подразделение,РукФил);
			ОбластьМакета.Параметры.ФИООтпускПроизвел = РукФил;
			
		//СПб, ЕКБ, МСК, Тольятти
		ИначеЕсли (СсылкаНаОбъект.СкладОтправитель.Подразделение.ОбособленноеПодразделение) и (СсылкаНаОбъект.СкладПолучатель.ТипСклада = перечисления.ТипыСкладов.ВПути) Тогда 	
			РукФил = ПолучитьОтветственноеЛицоРуководителя(СсылкаНаОбъект.Подразделение, Перечисления.ОтветственныеЛицаОрганизации.Руководитель);
			ОбластьМакета.Параметры.ФИООтпускПроизвел = РукФил;
			ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ПолучитьДолжность(СсылкаНаОбъект.СкладОтправитель.Подразделение, РукФил);
		конецЕсли; //<<
		
	КонецЕсли;
	
	ТабДокумент.Вывести(ОбластьМакета);
	
	//КолСтолб = 2; // 0, 1, 2, 3, 4, 6.
	Если КолСтолб>0 Тогда
		Если КолСтолб=1 Тогда
			ОбластьМакета = Макет.ПолучитьОбласть("Назв");
			ОбластьМакета.Параметры.Пункт3_1 = стрЗаменить(Пункт3_1, "; ",";"+Символы.ПС);
			ТабДокумент.Вывести(ОбластьМакета);
			
		ИначеЕсли (КолСтолб>6) Тогда
			Предупреждение("Невозможно отобразить названия в "+строка(КолСтолб)+" столбцах!
			|Будет использован стандарный вывод названия (п. 3.1)",10);
			ОбластьМакета = Макет.ПолучитьОбласть("Назв");
			ОбластьМакета.Параметры.Пункт3_1 = Пункт3_1;
			ТабДокумент.Вывести(ОбластьМакета);
		Иначе
			КолСтолб= ?(КолСтолб=5, 6, КолСтолб);
			ОбластьМакета = Макет.ПолучитьОбласть("Назв_стр"+Строка(КолСтолб));
			
			N = СтрЧислоВхождений(Пункт3_1,";");//строки
			Nстр = Цел(N/КолСтолб) + ?(N%КолСтолб=0, 0, 1); // целое + 1 стр. на нецелое
			//-------основной цикл без таблицы значений-----------------------------
			Назв0 = Пункт3_1; // ограничимся циклом
			Для k=0 по Nстр - 1 цикл
				//СтрЗнач = табЗнач[k];
				для j=1 по КолСтолб цикл
					i= найти(Назв0,";");		L=стрДлина(Назв0);
					стрЗнач12 = СокрЛП(лев(Назв0, i-1)); Назв0 = Прав(Назв0, L-i);
					ОбластьМакета.Параметры["назв"+строка(j)] = стрЗнач12; // СтрЗнач[j-1]);
				конецЦикла;
				ТабДокумент.Вывести(ОбластьМакета);
			КонецЦикла;
			//------------------основной цикл -----------------------------
			
		КонецЕсли;
	Иначе  // как было - сплошным текстом!
		ОбластьМакета = Макет.ПолучитьОбласть("Назв");
		//Адиянов<<< 20161102 текст Пункт3_1 - пустая строка
		//{{{ОбластьМакета.Параметры.Пункт3_1 = "Список грузов см. Приложение"; //+++ 12.08.2011 Гаричев
		ОбластьМакета.Параметры.Пункт3_1 = ""; 
		//Адиянов>>> 20161102
		ТабДокумент.Вывести(ОбластьМакета);
	КонецЕсли;	//конец КолСтолб>0
	
	ОбластьМакета = Макет.ПолучитьОбласть("Лицевая2");
	//==========================================================================================
	//+++)
	
	//+++ Нетто, Брутто //, ОбъемШтук, ОбъемМест
	выборка2 = ПолучитьВесОбъем();
	Если Выборка2.Количество()>0 Тогда
		Выборка2.Следующий();
		ОбластьМакета.Параметры.МассаГрузаНетто  = ?(Выборка2.Нетто<>0,Формат(Выборка2.Нетто,"ЧН= ")+"кг; ", "");
		ОбластьМакета.Параметры.МассаГрузаБрутто = ?(Выборка2.Брутто<>0, "("+Формат(Выборка2.Брутто,"ЧН= ")+"кг); ", "");
		кол = Выборка2.Количество;
		колМест = Выборка2.КоличествоМест;
		ОбластьМакета.Параметры.ВсегоМестПрописью = ?(колМест=0, ?(кол=0,"",Строка(кол)+" шт."), строка(колМест)+" мест");
		
	Иначе 
		ОбластьМакета.Параметры.МассаГрузаНетто  = "";
		ОбластьМакета.Параметры.МассаГрузаБрутто = "";
		ОбластьМакета.Параметры.ВсегоМестПрописью = "";
	конецЕсли;
	
	
	//3.2 КолМест, маркировка-------------------------------------------
	ОбластьМакета.Параметры.Пункт3_2 = Пункт3_2;
	
	// [МассаГрузаНетто]; [МассаГрузаБрутто]; [Размеры]; [ОбъемМест]
	ОбластьМакета.Параметры.Пункт3_3 = Пункт3_3;
	
	
	//4
	///////////////////////Плотников 11.02.2016 ОперацияПоОтветственномуХранению.Перемещение
	Если СсылкаНаОбъект.Метаданные().Реквизиты.Найти("ВидОперации") <> Неопределено Тогда 
		Если СсылкаНаОбъект.ВидОперации = Перечисления.ВидыОперацийПоОтветственномуХранению.ПеремещениеМеждуСкладами Тогда
			ОбластьМакета.Параметры.ПереченьДопДокументов = ПереченьДопДокументов + " (ОТХ)";
		Иначе
			ОбластьМакета.Параметры.ПереченьДопДокументов = ПереченьДопДокументов;
		КонецЕсли;
	Иначе
		ОбластьМакета.Параметры.ПереченьДопДокументов = ПереченьДопДокументов;
	КонецЕсли;
	///////////////////////Плотников 11.02.2016 ОперацияПоОтветственномуХранению.Перемещение
	ОбластьМакета.Параметры.ПереченьСертификатов  = ПереченьСертификатов;
	
	//5
	ОбластьМакета.Параметры.Пункт5_1 = Пункт5_1;
	ОбластьМакета.Параметры.Пункт5_2 = Пункт5_2;
	ОбластьМакета.Параметры.Пункт5_3 = Пункт5_3;
	
	//6,7
		
	///////////////////////Плотников 11.02.2016 ОперацияПоОтветственномуХранению.Перемещение
	
	//Адиянов.Проверим Есть ли реквизит "ВидОперации" 
	Если СсылкаНаОбъект.Метаданные().Реквизиты.Найти("ВидОперации") <> Неопределено Тогда 
		
		Если СсылкаНаОбъект.ВидОперации = Перечисления.ВидыОперацийПоОтветственномуХранению.ПеремещениеМеждуСкладами Тогда
			//Если СведенияОГрузоотправителе.Представление<>Неопределено Тогда 
			ОбластьМакета.Параметры.ПунктПогрузки  = ОписаниеОрганизации(СведенияОЮрФизЛице(?(ЗначениеНеЗаполнено(СсылкаНаОбъект.Подразделение) или СсылкаНаОбъект.Подразделение = Справочники.Подразделения.ПустаяСсылка(),Шапка.ЮрФизЛицо,СсылкаНаОбъект.Подразделение.Контрагент), ТекущаяДата()),"ФактическийАдрес,Телефоны");
			//КонецЕсли;
			
			Если СсылкаНаОбъект.СкладПолучатель.ТипСклада = Перечисления.ТипыСкладов.ВПути и СсылкаНаОбъект.Подразделение <> Справочники.Подразделения.НайтиПоКоду("00005") Тогда
				ОбластьМакета.Параметры.ПунктРазгрузки = ОписаниеОрганизации(СведенияОЮрФизЛице(Шапка.ЮрФизЛицо, ТекущаяДата()),"ФактическийАдрес,Телефоны");
			Иначе
				ОбластьМакета.Параметры.ПунктРазгрузки = ОписаниеОрганизации(СведенияОЮрФизЛице(?(ЗначениеНеЗаполнено(СсылкаНаОбъект.СкладПолучатель.Подразделение.Контрагент) или СсылкаНаОбъект.Складполучатель.Подразделение.Контрагент = Справочники.Подразделения.ПустаяСсылка(),Шапка.ЮрФизЛицо,СсылкаНаОбъект.Складполучатель.Подразделение.Контрагент), ТекущаяДата()),"ФактическийАдрес,Телефоны");
			КонецЕсли;
		Иначе
			Если СведенияОГрузоотправителе.Представление<>Неопределено Тогда 
				ОбластьМакета.Параметры.ПунктПогрузки  = ?(ПунктПогрузки="", ?(СведенияОГрузоотправителе.ФактическийАдрес="", СведенияОГрузоотправителе.ЮридическийАдрес, СведенияОГрузоотправителе.ФактическийАдрес), ПунктПогрузки);
			КонецЕсли;
			Если СведенияОГрузоПолучателе.Представление<>Неопределено Тогда 
				ОбластьМакета.Параметры.ПунктРазгрузки = ?(ПунктРазгрузки="", ?(СведенияОГрузоПолучателе.ФактическийАдрес="",СведенияОГрузоПолучателе.ЮридическийАдрес,СведенияОГрузоПолучателе.ФактическийАдрес) , ПунктРазгрузки);
			КонецЕсли;
		КонецЕсли;
		
	Иначе
		Если СведенияОГрузоотправителе.Представление<>Неопределено Тогда 
			ОбластьМакета.Параметры.ПунктПогрузки  = ?(ПунктПогрузки="", ?(СведенияОГрузоотправителе.ФактическийАдрес="", СведенияОГрузоотправителе.ЮридическийАдрес, СведенияОГрузоотправителе.ФактическийАдрес), ПунктПогрузки);
		КонецЕсли;
		Если СведенияОГрузоПолучателе.Представление<>Неопределено Тогда 
			ОбластьМакета.Параметры.ПунктРазгрузки = ?(ПунктРазгрузки="", ?(СведенияОГрузоПолучателе.ФактическийАдрес="",СведенияОГрузоПолучателе.ЮридическийАдрес,СведенияОГрузоПолучателе.ФактическийАдрес) , ПунктРазгрузки);
		КонецЕсли;
	КонецЕсли;
  	
	Если ВариантОформления = 2 Тогда
		ОбластьМакета.Параметры.ПунктРазгрузки = "86 км МКАДа";	
	КонецЕсли;
	
	
	Если СсылкаНаОбъект.Дата<ДатаНачалаТТН_13032012 Тогда
		ОбластьМакета.Параметры.Пункт6_6 = Пункт6_6;
		ОбластьМакета.Параметры.Пункт7_6 = Пункт7_6;
	Иначе
		ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика(Пункт6_6);//+++
		ОбластьМакета.Параметры.Пункт6_6 = Пункт6_6;
		ОбластьМакета.Параметры.Пункт7_6 = Пункт7_6;
		ОбластьМакета.Параметры.Пункт6_7 = Пункт6_7;
		ОбластьМакета.Параметры.Пункт7_7 = Пункт7_7;
	КонецЕсли;
	
	Если СсылкаНаОбъект.Дата >= ДатаНачалаТТН_13032012 И ВариантОформления = 1 Тогда
		ОбластьМакета.Параметры.ОтпускПроизвелДолжность2 = ?(ЗначениеЗаполнено(Водитель), "водитель", "");
		ОбластьМакета.Параметры.Пункт7_6 = "Глухов А.С."; //Водитель;
		ОбластьМакета.Параметры.Пункт6_62 = Водитель;
		ОбластьМакета.Параметры.Пункт6_72 = "Глухов А.С."; //Водитель;
		ОбластьМакета.Параметры.Пункт7_72 = "Глухов А.С."; //Водитель2;
	ИначеЕсли СсылкаНаОбъект.Дата >= ДатаНачалаТТН_13032012 И ВариантОформления = 2 Тогда
		ОбластьМакета.Параметры.Пункт7_6 = "Глухов А.С."; //Водитель2;	
	КонецЕсли;
	
	//РнД или Тл
	Если СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00106")
		или СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00172") Тогда //10.09.2018
		//ОбластьМакета.Параметры.Пункт6_6 = "Радченко И.Я.";
		ОбластьМакета.Параметры.Пункт6_6 = СокрЛП(СсылкаНаОбъект.Ответственный.Код); //+++ 16.08.2018 Иноземцена так просила!
		
	//СПб, Москва, Тольятти  +++ 23.08.2018
	ИначеЕсли СсылкаНаОбъект.Подразделение.ОбособленноеПодразделение тогда
	     ФизЛицо66 = СсылкаНаОбъект.Ответственный.ФизЛицо;
	     должностьЛица = ПолучитьДолжность(СсылкаНаОбъект.Подразделение, ФизЛицо66);  
		ОбластьМакета.Параметры.ОтпускПроизвелДолжность = должностьЛица;		 
		ОбластьМакета.Параметры.Пункт6_6 = СокрЛП( СсылкаНаОбъект.Ответственный ) ;		
	КонецЕсли;
		
	
	ОбластьМакета.Параметры.ДатаВремяПогрузки = ДатаВремяПогрузки;// ?(ДатаВремяПогрузки<>Дата(1,1,1), ДатаВремяПогрузки, СсылкаНаОбъект.Дата );
	ОбластьМакета.Параметры.ДатаВремяВыгрузки = ДатаВремяВыгрузки;// ?(ДатаВремяВыгрузки<>Дата(1,1,1), ДатаВремяВыгрузки, СрокДоставки );
	
	ОбластьМакета.Параметры.СостояниеГрузаОтправителя  = СостояниеГрузаОтправителя;
	ОбластьМакета.Параметры.СостояниеГрузаПолучателя  = СостояниеГрузаПолучателя;
	
	ОбластьМакета.Параметры.ВсегоМестПрописью = Пункт3_2;
	//ОбластьМакета.Параметры.ВсегоНаименований = Формат(СсылкаНаОбъект.Товары.Количество(),"ЧН=-")+" тов.";
	//8
	//+++по задаче 48645  - всегда прочерк
	//ОбластьМакета.Параметры.СрокДоставки1 = Формат(СрокДоставки1,"ДФ=dd.MM.yyyy; ДП=---");
	ОбластьМакета.Параметры.СрокДоставки1 = "---";
	//---по задаче 48645  - всегда прочерк
	//+++ ОбластьМакета.Параметры.ВидПеревозки = ?(ЗначениеЗаполнено(ВидПеревозки), ВидПеревозки, "Автомобильным транспортом");
	//9
	//++Орлов
	Если СсылкаНаОбъект.Дата >= ДатаНачалаТТН_13032012 Тогда
		ОбластьМакета.Параметры.ФИОВодителя	              = Водитель;
		ОбластьМакета.Параметры.ВодительскоеУдостоверение = ВодительскоеУдостоверение;
		ОбластьМакета.Параметры.ДолжнВодитель             = ?(ЗначениеЗаполнено(Водитель), "водитель", "");
		
		Если ВариантОформления = 1 Тогда
			ОбластьМакета.Параметры.ФИОВодителя2	           = "Глухов А.С."; //Водитель2;
			ОбластьМакета.Параметры.ВодительскоеУдостоверение2 = ""; //не заполняется
			ОбластьМакета.Параметры.ДолжнВодитель2             = "водитель"; //?(ЗначениеЗаполнено(Водитель2), "водитель", "");	
		КонецЕсли;
	КонецЕсли;
	//--Орлов
	
	//2013.11.14 ФормулаАвто
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
		Если СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.НайтиПоКоду("Я0004") Тогда //ФормулаАвто
			ОбластьМакета.Параметры.ПунктПогрузки = "150014, Ярославская обл, Ярославль г, Салтыкова-Щедрина ул, дом №21, оф.414";
			ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "Зайцева Н.С.";
			ОбластьМакета.Параметры.Пункт6_6 = "";
	 ИначеЕсли СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.ФормулаАвтоПлюс Тогда //ФормулаАвтоПлюс
		 Если СсылкаНаОбъект.Дата < '2018.01.12' Тогда
			 ОбластьМакета.Параметры.ПунктПогрузки = "150003, Ярославская обл, Ярославль г, Полушкина Роща ул, дом №9";
		 Иначе
			ОбластьМакета.Параметры.ПунктПогрузки = "150044, Ярославская обл, Ярославль г, Базовая ул, дом №3, оф.233,";
		КонецЕсли;
			//ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "Курапова Е.А.";
			ОбластьМакета.Параметры.ОтпускПроизвелДолжность = СсылкаНаОбъект.Ответственный;
			ОбластьМакета.Параметры.Пункт6_6 = "";
		КонецЕсли;
	КонецЕсли;	
	
	//АЧ - ответственные лица. Бакута. 25.08.15
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда 
		//РНД или Тл - по СкладОтправитель.Подразделение и Ответственному
		Если ( (СсылкаНаОбъект.СкладОтправитель.Подразделение.Код = "00106") или (СсылкаНаОбъект.СкладОтправитель.Подразделение.Код = "00172") )
			и (СсылкаНаОбъект.СкладПолучатель.ТипСклада = перечисления.ТипыСкладов.ВПути) 
			и ЗначениеЗаполнено(СсылкаНаОбъект.Ответственный) Тогда 
			   РукФил = СсылкаНаОбъект.Ответственный.ФизЛицо; 
			ОбластьМакета.Параметры.Пункт6_6 = РукФил;
			ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ПолучитьДолжность(СсылкаНаОбъект.СкладОтправитель.Подразделение, РукФил);
			
		//ЕКБ, МСК, СПБ, Тольятти  - по Подразделению и Руководителю 
		ИначеЕсли (СсылкаНаОбъект.Подразделение.ОбособленноеПодразделение) и (СсылкаНаОбъект.СкладПолучатель.ТипСклада = перечисления.ТипыСкладов.ВПути) Тогда 
			РукФил = ПолучитьОтветственноеЛицоРуководителя(СсылкаНаОбъект.Подразделение, Перечисления.ОтветственныеЛицаОрганизации.Руководитель);
			ОбластьМакета.Параметры.Пункт6_6 = РукФил;
			ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ПолучитьДолжность(СсылкаНаОбъект.Подразделение, РукФил);
			
		конецЕсли; //<<
	КонецЕсли;
	
	ТабДокумент.Вывести(ОбластьМакета);
	
	ТабДокумент.ВывестиГоризонтальныйРазделительСтраниц();
	
	//========================параметры оборотной стороны==========================================
	ОбластьМакета = Макет.ПолучитьОбласть("Оборотная");
	
	//10
	Если ТипЗнч(Перевозчик)<>Тип("Строка") Тогда
		Если ЗначениеЗаполнено(Перевозчик) Тогда
			СведенияОПеревозчике = СведенияОЮрФизЛице(Перевозчик,  Шапка.ДатаДокумента);
			
			ПеревозчикПредставление = ОписаниеОрганизации(СведенияОПеревозчике,  "ПолноеНаименование,ИНН,ЮридическийАдрес,Телефоны"); //,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
			
			Если Перевозчик.ЮрФизЛицо = перечисления.ЮрФизЛицо.ФизЛицо Тогда 
				ОбластьМакета.Параметры.ОрганизацияПеревозчикФ = ПеревозчикПредставление;
				ОбластьМакета.Параметры.ОрганизацияПеревозчикЮ = "";
			Иначе	
				ОбластьМакета.Параметры.ОрганизацияПеревозчикФ ="";
				ОбластьМакета.Параметры.ОрганизацияПеревозчикЮ = ПеревозчикПредставление;
			КонецЕсли;
		КонецЕсли;
	Иначе //строка!
		ОбластьМакета.Параметры.ОрганизацияПеревозчикЮ = Перевозчик;
	КонецЕсли;
	
	//+++ 29.07.2011 Кладовщик = ПолучитьКладовщика();
	ОбластьМакета.Параметры.ФИОруководителя = ""; //Кладовщик
	
	ОбластьМакета.Параметры.ФИОВодителя               = Водитель;
	ОбластьМакета.Параметры.ВодительскоеУдостоверение = ВодительскоеУдостоверение;
	//Орлов++
	Если СсылкаНаОбъект.Дата >= ДатаНачалаТТН_13032012 И ВариантОформления = 1 Тогда
		ОбластьМакета.Параметры.ФИОВодителя2               = "Глухов А.С."; //Водитель2;
		ОбластьМакета.Параметры.ВодительскоеУдостоверение2 = ""; //не заполняется
	КонецЕсли;
	//Орлов--
	
	
	//11
	ОбластьМакета.Параметры.МаркаАвтомобиля           = СокрЛП(МаркаАвтомобиля);
	ОбластьМакета.Параметры.Прицеп                    = ?(ЗначениеЗаполнено(МаркаПрицепа), "Прицеп: "+МаркаПрицепа, "");
	
	ОбластьМакета.Параметры.ГосНомерАвтомобиля        = ГосНомерАвтомобиля;
	ОбластьМакета.Параметры.ГосНомерПрицепа           = ?(ЗначениеЗаполнено(ГосНомерПрицепа), "Прицеп: "+ГосНомерПрицепа, "");
	
	//Орлов++
	Если СсылкаНаОбъект.Дата >= ДатаНачалаТТН_13032012 И ВариантОформления = 1 Тогда
		ОбластьМакета.Параметры.МаркаАвтомобиля2           = "Газель"; //СокрЛП(МаркаАвтомобиля2);
		ОбластьМакета.Параметры.Прицеп2                    = ""; //прицепа нет
		
		ОбластьМакета.Параметры.ГосНомерАвтомобиля2        = "А 635 ЕН 76"; //ГосНомерАвтомобиля2;
		ОбластьМакета.Параметры.ГосНомерПрицепа2           = ""; //прицепа нет
	КонецЕсли;
	//Орлов--
	
	//12
	ОбластьМакета.Параметры.СостояниеГрузаОтправителя  = СостояниеГрузаОтправителя;
	ОбластьМакета.Параметры.СостояниеГрузаПолучателя  = СостояниеГрузаПолучателя;
	
	//15
	ОбластьМакета.Параметры.ВсегоКОплате     = "";
	ОбластьМакета.Параметры.ПроцентНаценки   = ""; //"процент: ";
	ОбластьМакета.Параметры.СкладскиеРасходы = "";
	
	//+++ 07.06.2012
	Если СсылкаНаОбъект.Дата>ДатаНачалаТТН_13032012 Тогда 
		
		//Если ЗначениеЗаполнено(Перевозчик) Тогда //+++ 13.06.2012
		//+++ 10.04.2015
		ГрузоотправительПредставление = ОписаниеОрганизации(СведенияОГрузоотправителе, "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
		ОбластьМакета.Параметры.Пункт15_7 = ГрузоотправительПредставление;
		//Иначе
		//	ОбластьМакета.Параметры.Пункт15_7 = "";
		//КонецЕсли;	
		
		//16
		ОбластьМакета.Параметры.ФИООтпускПроизвел       = кладовщик;
		Если СсылкаНаОбъект.Дата>='20170330' и СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00106") Тогда
			//ОбластьМакета.Параметры.ФИООтпускПроизвел = "Радченко И.Я.";		
			//ОбластьМакета.Параметры.ФИООтпускПроизвел = "Иноземцева Н.И.";  //07.09.17
		//Миронычев АЕ 03,04,17
			//ОбластьМакета.Параметры.ФИООтпускПроизвел = СокрЛП(глТекущийПользователь.Код); 
		//конец Миронычев АЕ 03,04,17
		ОбластьМакета.Параметры.ФИООтпускПроизвел = СокрЛП(СсылкаНаОбъект.Ответственный.Код);//16.08.2018 - так надо для Ростова!
		
		ИначеЕсли СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00106") Тогда 
		//+Лукьяненков 29.08.2017
			//ОбластьМакета.Параметры.ФИООтпускПроизвел = "Радченко И.Я.";		
			ОбластьМакета.Параметры.ФИООтпускПроизвел = СокрЛП(глТекущийПользователь.Код);
		//-Лукьяненков 29.08.2017
		//Орлов++
		
		ИначеЕсли СсылкаНаОбъект.Дата>='20131031' и СсылкаНаОбъект.Ответственный = Справочники.Пользователи.НайтиПоКоду("Михалева Е. А.") Тогда
			ОбластьМакета.Параметры.ФИООтпускПроизвел = "Михалева Е.А.";			
			
		ИначеЕсли СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00112") тогда
			
			ОбластьМакета.Параметры.ФИООтпускПроизвел = СокрЛП(СсылкаНаОбъект.Ответственный.Код);			
		КонецЕсли;
		//Орлов--
				ОбластьМакета.Параметры.ДатаПогрузки = ЭтотОбъект.ДатаВремяПогрузки; //кладовщик
		
		//  ОбластьМакета.Параметры.Пункт10_1Ведомость = Пункт10_1;
		//++Орлов
		//было:
		//ОбластьМакета.Параметры.ФИОГрузПолучил = "";//осн.контактное лицо!
		//стало:
		ОбластьМакета.Параметры.ФИОГрузПолучил = Водитель;
		Если ВариантОформления = 1 Тогда
			ОбластьМакета.Параметры.ФИОГрузПолучил2 = "Глухов А.С."; //Водитель2;	
		КонецЕсли;
		//--Орлов
		ОбластьМакета.Параметры.ДатаРазгрузки = ЭтотОбъект.ДатаВремяВыгрузки; //кладовщик
		// ОбластьМакета.Параметры.Пункт10_1Ведомость = Пункт10_2;
	КонецЕсли;
	
	//2013.11.14 ФормулаАвто
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
		Если СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.НайтиПоКоду("Я0004") Тогда //ФормулаАвто
			ОбластьМакета.Параметры.Пункт15_7 = "Общество с ограниченной ответственностью ""Формула Авто"", 150014, Ярославская обл, Ярославль г, Салтыкова-Щедрина ул, дом №21, оф.414, р/с 40702810877030004619, в банке СЕВЕРНЫЙ БАНК СБЕРБАНКА РОССИИ, БИК 047888670, к/с 30101810500000000670";
			ОбластьМакета.Параметры.ФИООтпускПроизвел = "Зайцева Н.С.";
		ИначеЕсли СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.ФормулаАвтоПлюс Тогда //ФормулаАвто
			Если СсылкаНаОбъект.Дата < '2018.01.12' Тогда 
				ОбластьМакета.Параметры.Пункт15_7 = "Общество с ограниченной ответственностью ""Формула Авто Плюс"", 150003, Ярославская обл, Ярославль г, Полушкина Роща ул, дом №9,  р/с 40702810277030004620, в банке СЕВЕРНЫЙ БАНК СБЕРБАНКА РОССИИ, БИК 047888670, к/с 30101810500000000670";
			Иначе
				ОбластьМакета.Параметры.Пункт15_7 = "Общество с ограниченной ответственностью ""Формула Авто Плюс"", 150044, Ярославская обл, Ярославль г, Базовая ул, дом №3, оф.233,  р/с 40702810277030004620, в банке СЕВЕРНЫЙ БАНК СБЕРБАНКА РОССИИ, БИК 047888670, к/с 30101810500000000670";
			КонецЕсли;	
				//ОбластьМакета.Параметры.ФИООтпускПроизвел = "Курапова Е.А.";
			ОбластьМакета.Параметры.ФИООтпускПроизвел = СсылкаНаОбъект.Ответственный;
		КонецЕсли;
	КонецЕсли;	
	
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда 
		Если (СсылкаНаОбъект.СкладОтправитель.ПринадлежитЭлементу(Справочники.Склады.НайтиПоКоду("00643"))) и (СсылкаНаОбъект.СкладПолучатель = Справочники.склады.найтиПоКоду("00634")) 
			и ЗначениеЗаполнено(СсылкаНаОбъект.Ответственный) Тогда 
			ОбластьМакета.Параметры.ФИООтпускПроизвел = СсылкаНаОбъект.Ответственный.ФизЛицо;
		//ЕКБ, МСК, СПБ, Тольятти - Руководитель Филиала!
		ИначеЕсли (СсылкаНаОбъект.СкладОтправитель.Подразделение.ОбособленноеПодразделение) и (СсылкаНаОбъект.СкладПолучатель.ТипСклада = перечисления.ТипыСкладов.ВПути) Тогда 	
			РукФил = ПолучитьОтветственноеЛицоРуководителя(СсылкаНаОбъект.Подразделение,Перечисления.ОтветственныеЛицаОрганизации.Руководитель);
			ОбластьМакета.Параметры.ФИООтпускПроизвел = РукФил;
		конецЕсли; //<<
	КонецЕсли;
	
	
	ТабДокумент.Вывести(ОбластьМакета);
	
	//===================================================================
	//Приложение со списком товаров
	//+++ 12.04.2016 - выключено!
	Если ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.РеализацияТоваровУслуг") тогда
	Если КолСтолб<=1 и найти(СсылкаНаОбъект.ДоговорКонтрагента.Наименование, "*")>0 Тогда  //только не для табличной части 3.1
		ТабДокумент.ВывестиГоризонтальныйРазделительСтраниц();
		
		ОбластьМакета = Макет.ПолучитьОбласть("ШапкаПриложения");
		ОбластьМакета.Параметры.НомерДокумента  = ПолучитьНомерНаПечать(Шапка);
		
		//2013.11.14 ФормулаАвто
		Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
			Если СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.НайтиПоКоду("Я0004") Тогда //ФормулаАвто
				ОбластьМакета.Параметры.НомерДокумента = НомерДокументаФА;
			ИначеЕсли СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.ФормулаАвтоПлюс Тогда //ФормулаАвто
				ОбластьМакета.Параметры.НомерДокумента = НомерДокументаФАП;
			ИначеЕсли СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.ШинтрейдЯрославль Тогда //ФормулаАвто
				ОбластьМакета.Параметры.НомерДокумента = НомерДокументаШТЯ;
			КонецЕсли;
		КонецЕсли;	
		
		ОбластьМакета.Параметры.ДатаДокумента   = Формат(Шапка.ДатаДокумента, "Л=ru_RU; ДЛФ=DD; ДП=-");
		ТабДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("СтрокаПриложения");
		
		//---------------------------------
		//получение всех данных идет из Документа или СпискаДокументов
		Если ЭтотОбъект.Реализации.Количество()=0 Тогда
			Док1 = СсылкаНаОбъект;
			
			ДопКолонка = Константы.ДополнительнаяКолонкаПечатныхФормДокументов.Получить();
			
			//+++ 12.04.2018 --- цены B2B на дату документа!
			списТов = Док1.Товары.ВыгрузитьКолонку("Номенклатура");
			ЦеныB2B = получитьЦеныB2B(Док1.Дата, списТов);
			флB2B = (ЦеныB2B.Количество()>0);
		
			для каждого Стр1 из Док1.Товары цикл
				//++Смирнов для Лагерной и Радуга Питер убираем LegeArtis
				Если Шапка.Покупатель.Код="93136  " или  Шапка.Покупатель.Код="91777  " тогда
					ОбластьМакета.Параметры.ТоварНаименование = СтрЗаменить(стр1.Номенклатура.НаименованиеПолное,"LegeArtis","");
				иначе
					ОбластьМакета.Параметры.ТоварНаименование = стр1.Номенклатура.НаименованиеПолное;
				КонецЕсли;
				ОбластьМакета.Параметры.Количество = стр1.Количество;
				Если ТипЗнч(док1)=Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
					ОбластьМакета.Параметры.Склад	= ?(ЗначениеЗаполнено(стр1.Склад), стр1.Склад, док1.СкладОтправитель);
				Иначе
					ОбластьМакета.Параметры.Склад	= ?(ЗначениеЗаполнено(стр1.Склад), стр1.Склад, док1.Склад);
				КонецЕсли;
				
				ОбластьМакета.Параметры.БазоваяЕдиницаНаименование = стр1.Номенклатура.БазоваяЕдиницаИзмерения;
				Если ДопКолонка = Перечисления.ДополнительнаяКолонкаПечатныхФормДокументов.Артикул Тогда
					ОбластьМакета.Параметры.Артикул = стр1.Номенклатура.Артикул;
				Иначе
					ОбластьМакета.Параметры.Артикул = стр1.Номенклатура.Код;
				КонецЕсли;
				
				Цена1 = Стр1.Цена;
				
				//+++ 12.04.2018 ----------------------------
				Если флB2B тогда
					Цена2 = ЦеныB2B.Получить(стр1.Номенклатура);
					если Цена2<>неопределено тогда
						Если Цена2>Цена1 тогда
							сообщить(стр1.Номенклатура.Код+") "+строка(Цена1)+">>"+строка(Цена2) );
							Цена1 = Цена2;
						КонецЕсли;	
					КонецЕсли;	
				КонецЕсли;	
				//+++)
				
				ОбластьМакета.Параметры.Цена = Цена1;
				
				ТабДокумент.Вывести(ОбластьМакета);
			КонецЦикла;
			КолИтого = Док1.Товары.Итог("Количество");
			КолСтрок = Док1.Товары.Количество();
		Иначе//много реализаций или перемещений
			КолИтого = 0; КолСтрок = 0;
			ДопКолонка = Константы.ДополнительнаяКолонкаПечатныхФормДокументов.Получить();
			Док1 = СсылкаНаОбъект;
			
			//+++ 22.06.2015 - общая выборка по товарам
			//  для каждого Док1 из ЭтотОбъект.Реализации цикл
			//	для каждого Стр1 из Док1.реализация.Товары цикл
			списДок = ЭтотОбъект.Реализации.ВыгрузитьКолонку("Реализация");
			Запрос = Новый Запрос;
			Запрос.Текст = "ВЫБРАТЬ
						   |	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
						   |	СУММА(РеализацияТоваровУслугТовары.Количество) КАК Количество,
						   |	СУММА(РеализацияТоваровУслугТовары.Сумма) КАК Сумма,
						   |	ВЫБОР
						   |		КОГДА РеализацияТоваровУслугТовары.Склад = &Пустой
						   |			ТОГДА РеализацияТоваровУслугТовары.Ссылка.Склад
						   |		ИНАЧЕ РеализацияТоваровУслугТовары.Склад
						   |	КОНЕЦ КАК Склад
						   |ИЗ
						   |	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
						   |ГДЕ
						   |	РеализацияТоваровУслугТовары.Ссылка В(&списДок)
						   |
						   |СГРУППИРОВАТЬ ПО
						   |	РеализацияТоваровУслугТовары.Номенклатура,
						   |	ВЫБОР
						   |		КОГДА РеализацияТоваровУслугТовары.Склад = &Пустой
						   |			ТОГДА РеализацияТоваровУслугТовары.Ссылка.Склад
						   |		ИНАЧЕ РеализацияТоваровУслугТовары.Склад
						   |	КОНЕЦ
						   |
|"+?(ТипЗнч(Док1)=Тип("ДокументСсылка.ПеремещениеТоваров"), "
//--------------------------------------------------------------------------------------------------						   
						   |ОБЪЕДИНИТЬ ВСЕ
						   |
						   |ВЫБРАТЬ
						   |	ПеремещениеТоваровТовары.Номенклатура,
						   |	СУММА(ПеремещениеТоваровТовары.Количество),
						   |	СУММА(ПеремещениеТоваровТовары.Цена * ПеремещениеТоваровТовары.Количество),
						   |	ВЫБОР
						   |		КОГДА ПеремещениеТоваровТовары.Склад = &Пустой
						   |			ТОГДА ПеремещениеТоваровТовары.Ссылка.СкладОтправитель
						   |		ИНАЧЕ ПеремещениеТоваровТовары.Склад
						   |	КОНЕЦ
						   |ИЗ
						   |	Документ.ПеремещениеТоваров.Товары КАК ПеремещениеТоваровТовары
						   |ГДЕ
						   |	ПеремещениеТоваровТовары.Ссылка В(&списДок)
						   |
						   |СГРУППИРОВАТЬ ПО
						   |	ПеремещениеТоваровТовары.Номенклатура,
						   |	ВЫБОР
						   |		КОГДА ПеремещениеТоваровТовары.Склад = &Пустой
						   |			ТОГДА ПеремещениеТоваровТовары.Ссылка.СкладОтправитель
						   |		ИНАЧЕ ПеремещениеТоваровТовары.Склад
						   |	КОНЕЦ
						   |",
?(ТипЗнч(Док1)=Тип("ДокументСсылка.ВозвратТоваровПоставщику"),"						   
//-----------------------------------------------------------------------------------------						   
						   |ОБЪЕДИНИТЬ ВСЕ
						   |
						   |ВЫБРАТЬ
						   |	ПеремещениеТоваровТовары.Номенклатура,
						   |	СУММА(ПеремещениеТоваровТовары.Количество),
						   |	СУММА(ПеремещениеТоваровТовары.Цена * ПеремещениеТоваровТовары.Количество),
						   |	ВЫБОР
						   |		КОГДА ПеремещениеТоваровТовары.Склад = &Пустой
						   |			ТОГДА ПеремещениеТоваровТовары.Ссылка.Склад
						   |		ИНАЧЕ ПеремещениеТоваровТовары.Склад
						   |	КОНЕЦ
						   |ИЗ
						   |	Документ.ВозвратТоваровПоставщику.Товары КАК ПеремещениеТоваровТовары
						   |ГДЕ
						   |	ПеремещениеТоваровТовары.Ссылка В(&списДок)
						   |
						   |СГРУППИРОВАТЬ ПО
						   |	ПеремещениеТоваровТовары.Номенклатура,
						   |	ВЫБОР
						   |		КОГДА ПеремещениеТоваровТовары.Склад = &Пустой
						   |			ТОГДА ПеремещениеТоваровТовары.Ссылка.Склад
						   |		ИНАЧЕ ПеремещениеТоваровТовары.Склад
						   |	КОНЕЦ
						   |",
?(ТипЗнч(Док1)=Тип("ДокументСсылка.ОперацияПоОтветственномуХранению"),"	
  //-----------------------------------------------------------------------------------------------
						   |ОБЪЕДИНИТЬ ВСЕ
						   |
						   |ВЫБРАТЬ
						   |	ПеремещениеТоваровТовары.Номенклатура,
						   |	СУММА(ПеремещениеТоваровТовары.Количество),
						   |	СУММА(0),
						   |	ВЫБОР
						   |		КОГДА ПеремещениеТоваровТовары.Склад = &Пустой
						   |			ТОГДА ПеремещениеТоваровТовары.Ссылка.СкладПолучатель
						   |		ИНАЧЕ ПеремещениеТоваровТовары.Склад
						   |	КОНЕЦ
						   |ИЗ
						   |	Документ.ОперацияПоОтветственномуХранению.Товары КАК ПеремещениеТоваровТовары
						   |ГДЕ
						   |	ПеремещениеТоваровТовары.Ссылка В(&списДок)
						   |
						   |СГРУППИРОВАТЬ ПО
						   |	ПеремещениеТоваровТовары.Номенклатура,
						   |	ВЫБОР
						   |		КОГДА ПеремещениеТоваровТовары.Склад = &Пустой
						   |			ТОГДА ПеремещениеТоваровТовары.Ссылка.СкладПолучатель
						   |		ИНАЧЕ ПеремещениеТоваровТовары.Склад
						   |	КОНЕЦ
						   |"
,"") ) )+"
						   |
						   |УПОРЯДОЧИТЬ ПО
						   |	Номенклатура
						   |АВТОУПОРЯДОЧИВАНИЕ";
			
			Запрос.УстановитьПараметр("списДок", списДок);
			Запрос.УстановитьПараметр("Пустой", справочники.Склады.ПустаяСсылка() );
			
			Результат = Запрос.Выполнить();
			Стр1 = Результат.Выбрать();
			
			Пока Стр1.Следующий() Цикл
			//+++)
			
					//++Смирнов для Лагерной и Радуга Питер убираем LegeArtis
					Если Шапка.Покупатель.Код="93136  " или  Шапка.Покупатель.Код="91777  " тогда
						ОбластьМакета.Параметры.ТоварНаименование = СтрЗаменить(стр1.Номенклатура,"LegeArtis","");
					Иначе
						ОбластьМакета.Параметры.ТоварНаименование = стр1.Номенклатура;
					КонецЕсли;
					ОбластьМакета.Параметры.Количество = стр1.Количество;
					ОбластьМакета.Параметры.Склад	   = стр1.Склад;
					
					//+++ 05.04.2018 +++ средняя цена
					попытка
					ОбластьМакета.Параметры.Цена =?(стр1.Количество>0, Окр(стр1.Сумма / стр1.Количество,2), стр1.Сумма);
					Исключение
					КонецПопытки;
					
					ОбластьМакета.Параметры.БазоваяЕдиницаНаименование = стр1.Номенклатура.БазоваяЕдиницаИзмерения;
					
					Если ДопКолонка = Перечисления.ДополнительнаяКолонкаПечатныхФормДокументов.Артикул Тогда
						ОбластьМакета.Параметры.Артикул = стр1.Номенклатура.Артикул;
					Иначе
						ОбластьМакета.Параметры.Артикул = стр1.Номенклатура.Код;
					КонецЕсли;
					
					КолИтого = КолИтого + стр1.Количество;
					КолСтрок = КолСтрок + 1;
					ТабДокумент.Вывести(ОбластьМакета);
				//КонецЦикла;
				//КолИтого = КолИтого + Док1.реализация.Товары.Итог("Количество");
				//КолСтрок = КолСтрок + Док1.реализация.Товары.Количество();
			КонецЦикла;
		КонецЕсли;
		//---------------------------------
		
		
		ОбластьМакета = Макет.ПолучитьОбласть("ПодвалПриложения");
		ОбластьМакета.Параметры.ИтогоКоличество  	= КолИтого;
		ФормСтрока = "Л = ru_RU; ДП = Истина";
		ПарПредмета=",,,ж,,,,м,0";
		ОбластьМакета.Параметры.ВсегоНаименований	= ЧислоПрописью(КолСтрок, ФормСтрока, ПарПредмета);
		ОбластьМакета.Параметры.КоличествоСтрок	= КолСтрок;
		должВод = "";
		Если ЗначениеЗаполнено(Водитель) Тогда
			должВод = "водитель"; 
		КонецЕсли;
		ОбластьМакета.Параметры.ДолжнВодитель  = должВод;
		ОбластьМакета.Параметры.ФИОВодителя    = Водитель;
		
		ОбластьМакета.Параметры.ОтпускОтгрузилДолжность = "";
		
		//+++ 30.03.2012
		Если ТипЗнч(СсылкаНаОбъект) = тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
			Если СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00107") Тогда
				ОбластьМакета.Параметры.ФИОразрешил = "Войновская Н.Р.";
				ОбластьМакета.Параметры.ФИОотгрузил = "Войновская Н.Р.";
				ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "";
			ИначеЕсли СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00106") Тогда  //рнд
				ОбластьМакета.Параметры.ФИОразрешил = кладовщик;
				ОбластьМакета.Параметры.ФИОотгрузил = кладовщик;
				ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика(кладовщик);//+++;
				
				Если СсылкаНаОбъект.Дата>='20170829' Тогда //16.08.2018
				//+Лукьяненков 29.08.2017
					ОбластьМакета.Параметры.ФИОразрешил = СокрЛП(СсылкаНаОбъект.Ответственный.Код);
					ОбластьМакета.Параметры.ФИОотгрузил = СокрЛП(СсылкаНаОбъект.Ответственный.Код);
				//-Лукьяненков 29.08.2017
				
				//Миронычев А.Е 03,04,17
		        иначеЕсли СсылкаНаОбъект.Дата>='20170330'  Тогда
					ОбластьМакета.Параметры.ФИОразрешил = "Радченко И.А.";
					ОбластьМакета.Параметры.ФИОотгрузил = "Радченко И.А.";
					
					//ОбластьМакета.Параметры.ФИОразрешил = "Иноземцева Н.И.";  //07.09.17
					//ОбластьМакета.Параметры.ФИОотгрузил = "Иноземцева Н.И.";  //07.09.17
	
				//конец Миронычев А.Е 30,04,17

				ИначеЕсли СсылкаНаОбъект.Дата>='20131031' и СсылкаНаОбъект.Ответственный = Справочники.Пользователи.НайтиПоКоду("Михалева Е. А.") Тогда
					ОбластьМакета.Параметры.ФИОразрешил = "Михалева Е.А.";
					ОбластьМакета.Параметры.ФИОотгрузил = "Михалева Е.А.";			
				КонецЕсли;
				
			 ИначеЕсли ЗначениеЗаполнено(СсылкаНаОбъект.сделка) Тогда
				Если СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00107")Тогда
					ОбластьМакета.Параметры.ФИОразрешил = "Войновская Н.Р.";
					ОбластьМакета.Параметры.ФИОотгрузил = "Войновская Н.Р.";
					ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "";
				ИначеЕсли СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00106")Тогда
					ОбластьМакета.Параметры.ФИОразрешил = Кладовщик;
					ОбластьМакета.Параметры.ФИОотгрузил = Кладовщик;
					ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика(кладовщик);
					
				ИначеЕсли  СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00112")
	 				   или СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00112") тогда
					ОбластьМакета.Параметры.ФИОразрешил = Кладовщик;
					ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика(кладовщик);
					//++++++++++++++++++++++++ 05.08.2013
					регСв = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, новый Структура("Подразделение, ОтветственноеЛицо",
					справочники.Подразделения.НайтиПоКоду("00112"), Перечисления.ОтветственныеЛицаОрганизации.Кассир) );
					Если регСв<>неопределено тогда
						ОбластьМакета.Параметры.ФИОотгрузил = регСв.ФизическоеЛицо;
						ОбластьМакета.Параметры.ОтпускОтгрузилДолжность = регСв.Должность;
					иначе
						ОбластьМакета.Параметры.ФИОотгрузил = Кладовщик;
						ОбластьМакета.Параметры.ОтпускОтгрузилДолжность =  ДолжнКладовщика(кладовщик);
					КонецЕсли;
					
				ИначеЕсли  СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00122")
	 				   или СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00122") тогда
					ОбластьМакета.Параметры.ФИОразрешил = Кладовщик;
					ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика(кладовщик);
					
					регСв = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, новый Структура("Подразделение, ОтветственноеЛицо",
					справочники.Подразделения.НайтиПоКоду("00122"), Перечисления.ОтветственныеЛицаОрганизации.Кассир) );
					Если регСв<>неопределено тогда
						ОбластьМакета.Параметры.ФИОотгрузил = регСв.ФизическоеЛицо;
						ОбластьМакета.Параметры.ОтпускОтгрузилДолжность = регСв.Должность;
					иначе
						ОбластьМакета.Параметры.ФИОотгрузил = Кладовщик;
						ОбластьМакета.Параметры.ОтпускОтгрузилДолжность =  ДолжнКладовщика(кладовщик);
					КонецЕсли;
			ИначеЕсли  СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00138")
	 				   или СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00138") тогда
					ОбластьМакета.Параметры.ФИОразрешил = Кладовщик;
					ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика(кладовщик);
					
					регСв = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, новый Структура("Подразделение, ОтветственноеЛицо",
					справочники.Подразделения.НайтиПоКоду("00138"), Перечисления.ОтветственныеЛицаОрганизации.Кассир) );
					Если регСв<>неопределено тогда
						ОбластьМакета.Параметры.ФИОотгрузил = регСв.ФизическоеЛицо;
						ОбластьМакета.Параметры.ОтпускОтгрузилДолжность = регСв.Должность;
					иначе
						ОбластьМакета.Параметры.ФИОотгрузил = Кладовщик;
						ОбластьМакета.Параметры.ОтпускОтгрузилДолжность =  ДолжнКладовщика(кладовщик);
					КонецЕсли;
			ИначеЕсли  СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00133")
	 				   или СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00133") тогда
					ОбластьМакета.Параметры.ФИОразрешил = Кладовщик;
					ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика(кладовщик);
					
					регСв = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, новый Структура("Подразделение, ОтветственноеЛицо",
					справочники.Подразделения.НайтиПоКоду("00133"), Перечисления.ОтветственныеЛицаОрганизации.Кассир) );
					Если регСв<>неопределено тогда
						ОбластьМакета.Параметры.ФИОотгрузил = регСв.ФизическоеЛицо;
						ОбластьМакета.Параметры.ОтпускОтгрузилДолжность = регСв.Должность;
					иначе
						ОбластьМакета.Параметры.ФИОотгрузил = Кладовщик;
						ОбластьМакета.Параметры.ОтпускОтгрузилДолжность =  ДолжнКладовщика(кладовщик);
					КонецЕсли;
				Иначе	
					ОбластьМакета.Параметры.ФИОразрешил = "Фролов А.И.";
					ОбластьМакета.Параметры.ФИОотгрузил = "Фролов А.И.";
					ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "зав. складом";
				КонецЕсли;
			Иначе
					ОбластьМакета.Параметры.ФИОразрешил = "Фролов А.И.";
					ОбластьМакета.Параметры.ФИОотгрузил = "Фролов А.И.";
					ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "зав. складом";
			КонецЕсли;
			//2013.11.14 ФормулаАвто
			Если СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.НайтиПоКоду("Я0004") Тогда //ФормулаАвто
				ОбластьМакета.Параметры.ФИОразрешил = "Зайцева Н.С.";
				ОбластьМакета.Параметры.ФИОотгрузил = "Зайцева Н.С.";
				ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "Ген. директор";
			иначеЕсли СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.ФормулаАвтоПлюс Тогда //ФормулаАвто
				//ОбластьМакета.Параметры.ФИОразрешил = "Курапова Е.А.";
				//ОбластьМакета.Параметры.ФИОотгрузил = "Курапова Е.А.";
				ОбластьМакета.Параметры.ФИОразрешил = СсылкаНаОбъект.Ответственный;
				ОбластьМакета.Параметры.ФИОотгрузил = СсылкаНаОбъект.Ответственный;
				ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "Ген. директор";
				
			КонецЕсли;
			
		Иначе //----------------------------------------------------------------------------------------------
			   СсылкаНаОбъектПодразделение = СсылкаНаОбъект.Подразделение;
			   
			   //+++ 02.04.2015 перемещение 
			   Если типЗнч(СсылкаНаОбъект) = тип("ДокументСсылка.ПеремещениеТоваров") тогда
				   если СсылкаНаОбъект.СкладОтправитель.Подразделение.ОбособленноеПодразделение тогда
					   СсылкаНаОбъектПодразделение = СсылкаНаОбъект.СкладОтправитель.Подразделение;
				   КонецЕсли;	   
			   КонецЕсли;	   
			   
			Если  СсылкаНаОбъектПодразделение = справочники.Подразделения.НайтиПоКоду("00005") тогда
				ОбластьМакета.Параметры.ФИОразрешил = "Фролов А.И.";
				ОбластьМакета.Параметры.ФИОотгрузил = "Фролов А.И.";
				ОбластьМакета.Параметры.ОтпускПроизвелДолжность = "зав. складом";
			Иначе		
		 		Отбор1 = новый Структура;
				Отбор1.Вставить("Подразделение", СсылкаНаОбъектПодразделение);
				
				Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.Руководитель);
				регСведРук = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
				
				Кладовщик =строка(регСведРук.ФизическоеЛицо);
				ДолжнКладовщика =регСведРук.Должность;
					
				ОбластьМакета.Параметры.ФИОразрешил = Кладовщик;
				ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика;
				
				регСв = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, 
					новый Структура("Подразделение, ОтветственноеЛицо",
					СсылкаНаОбъектПодразделение, Перечисления.ОтветственныеЛицаОрганизации.Кассир) );
					
				Если регСв<>неопределено тогда
					ОбластьМакета.Параметры.ФИОотгрузил = регСв.ФизическоеЛицо;
					ОбластьМакета.Параметры.ОтпускОтгрузилДолжность = регСв.Должность;
				иначе
					ОбластьМакета.Параметры.ФИОотгрузил = Кладовщик;
					ОбластьМакета.Параметры.ОтпускОтгрузилДолжность =  ДолжнКладовщика(кладовщик);
				КонецЕсли;
				
			КонецЕсли;
		КонецЕсли;
		
		// обычно это одно и то же, кроме питера
		Если ОбластьМакета.Параметры.ОтпускОтгрузилДолжность = "" тогда
			ОбластьМакета.Параметры.ОтпускОтгрузилДолжность =  ОбластьМакета.Параметры.ОтпускПроизвелДолжность;
		КонецЕсли;	
		
		//Орлов++
		Если ВариантОформления = 1 Тогда
			ОбластьМакета.Параметры.ДолжнВодитель  = ?(ЗначениеЗаполнено(Водитель), "водитель 1", "");
			ОбластьМакета.Параметры.ФИОВодителя    = Водитель;
			
			ОбластьМакета.Параметры.ДолжнВодитель2  = "водитель"; //?(ЗначениеЗаполнено(Водитель2), "водитель 2", "");
			ОбластьМакета.Параметры.ФИОВодителя2    = "Глухов А.С."; //Водитель2;
		ИначеЕсли ВариантОформления = 2 Тогда
			ОбластьМакета.Параметры.ДолжнВодительПолучил = "водитель";
			ОбластьМакета.Параметры.ФИОВодительПолучил   = "Глухов А.С.";
		КонецЕсли;
		//Орлов--
		
		ОбластьМакета.Параметры.ДатаДокумента		= Формат(Шапка.ДатаДокумента, "Л=ru_RU; ДЛФ=DD; ДП=-");
		
		Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда 
			//РНД - ответственный
			Если (СсылкаНаОбъект.СкладОтправитель.Подразделение.Код = "00106") и (СсылкаНаОбъект.СкладПолучатель = Справочники.склады.найтиПоКоду("00634"))
				и ЗначениеЗаполнено(СсылкаНаОбъект.Ответственный) Тогда 
				
				РукФил = СсылкаНаОбъект.Ответственный.ФизЛицо;
				
				ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ПолучитьДолжность(СсылкаНаОбъект.СкладОтправитель.Подразделение,РукФил);
				ОбластьМакета.Параметры.ФИОразрешил = РукФил;
				ОбластьМакета.Параметры.ОтпускотгрузилДолжность = ПолучитьДолжность(СсылкаНаОбъект.СкладОтправитель.Подразделение,РукФил);
				ОбластьМакета.Параметры.ФИОотгрузил = РукФил;
				
			//все другие филиалы - Руководитель!	
			ИначеЕсли (СсылкаНаОбъект.СкладОтправитель.Подразделение.ОбособленноеПодразделение) и (СсылкаНаОбъект.СкладПолучатель.ТипСклада = перечисления.ТипыСкладов.ВПути) Тогда 	
				
				РукФил = ПолучитьОтветственноеЛицоРуководителя(СсылкаНаОбъект.Подразделение, Перечисления.ОтветственныеЛицаОрганизации.Руководитель);
				
				ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ПолучитьДолжность(СсылкаНаОбъект.Подразделение, РукФил);
				ОбластьМакета.Параметры.ФИОразрешил = РукФил;
				ОбластьМакета.Параметры.ОтпускОтгрузилДолжность = ПолучитьДолжность(СсылкаНаОбъект.Подразделение, РукФил);
				ОбластьМакета.Параметры.ФИОотгрузил = РукФил;
			конецЕсли; //<<
		КонецЕсли;
		
		ТабДокумент.Вывести(ОбластьМакета);
		
	КонецЕсли;//КолСтолб<=1
КонецЕсли; // договор *

//	//===================================================================
	Если Реализации.Количество()>1 Тогда
		ОбластьМакета = Макет.ПолучитьОбласть("ДопПробел");
		ТабДокумент.Вывести(ОбластьМакета);
		ОбластьМакета = Макет.ПолучитьОбласть("ДополнительныйШтрихКод");
		Для каждого стр из Реализации Цикл
			Если стр.Реализация <>	СсылкаНаОбъект и ТипЗнч(стр.Реализация) = Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
				ОбШтрихКод=ОбластьМакета.Рисунки.ШтрихкодД.Объект;
				ОбШтрихКод.ТипКода = 4; 
				ОбШтрихКод.Сообщение = СформироватьШКРеализации(стр.Реализация,"2");//XMLСтрока(ЭтотОбъект.Ссылка.УникальныйИдентификатор()); 
				ОбШтрихКод.ОтображатьТекст = Ложь;
				ТабДокумент.Вывести(ОбластьМакета);
			конецЕсли;
		КонецЦикла;
	конецЕсли;
	
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.РеализацияТоваровУслуг") тогда //22.03.2017
		если СсылкаНаОбъект.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.ФормулаАвтоПлюс Тогда //ФормулаАвтоПлюс
		Обл = Макет.ПолучитьОбласть("ПравПодп");
		ТабДокумент.Вывести(Обл);
		КонецЕсли;
	ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") тогда //23.03.2017 - по Заказу...
		если СсылкаНаОбъект.ВнутреннийЗаказ.ДокументОснование.ДоговорКонтрагента.ТипДоговора = Справочники.ТипыДоговоров.ФормулаАвтоПлюс Тогда //ФормулаАвтоПлюс
		Обл = Макет.ПолучитьОбласть("ПравПодп");
		ТабДокумент.Вывести(Обл);
		КонецЕсли;
	КонецЕсли;
	
	ПечатьШтрихКодыДопДокументы(ТабДокумент, Макет);
	
	возврат ТабДокумент;
	
КонецФункции // ПечатьТТН_250711()

//Орлов++
функция ПечатьТТН_250711_ЯШТ_2_экземпляр(КолСтолб = 0, КонтрагентМосква="", ВариантОформления = 0)
	
	#Если Клиент Тогда
		Если СсылкаНаОбъект.Дата<ДатаНачалаТТН_250711 Тогда
			Сигнал();
			Предупреждение("Транспортная Накладная (Приложение №4) - принята 15.04.2011 №272,
			| но вступает в силу только с "+Формат(ДатаНачалаТТН_250711,"ДФ=dd.MM.yyyy")+",
			| и на дату: "+Формат(СсылкаНаОбъект.Дата,"ДФ=dd.MM.yyyy")+" - еще не действует!",60,"Транспортная Накладная - не действительна!");
		КонецЕсли;  
	#КонецЕсли		  
	
	
	
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	
	Если СсылкаНаОбъект.Дата<ДатаНачалаТТН_13032012 Тогда 
		ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ТТН_Приложение4";
		Макет       = ПолучитьМакет("Приложение4_ЯШТ");
	Иначе
		ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ТТН_Приложение4_13032012";
		Макет       = ПолучитьМакет("Приложение4_ЯШТ_13032012");	
	КонецЕсли;
	ОбластьМакета = Макет.ПолучитьОбласть("Лицевая");
	
	//-------параметры лицевой стороны-----------------------
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ОперацияПоОтветственномуХранению") Тогда
		Шапка = ПолучитьШапку_отвХран();
	ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
		Шапка = ПолучитьШапку_Перемещение();
	Иначе
		Шапка = ПолучитьШапку();
	КонецЕсли;
	
	СведенияОПоставщике       = СведенияОЮрФизЛице(Шапка.ЮрФизЛицо,    Шапка.ДатаДокумента,, Шапка.БанковскийСчет);	
	//СведенияОПокупателе     = СведенияОЮрФизЛице(Шапка.Покупатель,      Шапка.ДатаДокумента);
	СведенияОГрузоотправителе = СведенияОЮрФизЛице(Шапка.Грузоотправитель,  Шапка.ДатаДокумента);
	
	Если КонтрагентМосква="" Тогда //+++ 10.05.2012
		СведенияОГрузополучателе  = СведенияОЮрФизЛице(Шапка.Грузополучатель,   Шапка.ДатаДокумента);
	Иначе
		СведенияОГрузополучателе  = СведенияОЮрФизЛице(КонтрагентМосква,   Шапка.ДатаДокумента);
	КонецЕсли;
	
	ГрузоотправительПредставление = ОписаниеОрганизации(СведенияОГрузоотправителе, "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны");//,НомерСчета,Банк,БИК,КоррСчет");
	Если Шапка.Грузоотправитель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ФизЛицо Тогда 
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = ГрузоотправительПредставление;
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = "";
	Иначе	
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = "";
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = ГрузоотправительПредставление;
	КонецЕсли;	
	
	ГрузополучательПредставление  = ОписаниеОрганизации(СведенияОГрузополучателе,  "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны"); //,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
	Если Шапка.Грузополучатель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ЮрЛицо Тогда
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = ГрузополучательПредставление;
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = "";
	Иначе 
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = "";
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = ГрузополучательПредставление;
	КонецЕсли;
	//ОбластьМакета.Параметры.ПлательщикПредставление       = ОписаниеОрганизации(СведенияОПокупателе);
	
	
	//---------------Заполнение значений макета ----------------------------
	ОбластьМакета.Параметры.НомерЭкземпляра = НомерЭкземпляра;
	ОбластьМакета.Параметры.НомерДокумента  = ПолучитьНомерНаПечать(Шапка);
	ОбластьМакета.Параметры.ДатаДокумента   = Формат(Шапка.ДатаДокумента, "Л=ru_RU; ДЛФ=DD; ДП=-");
	ГрузоотправительПредставление = ОписаниеОрганизации(СведенияОГрузоотправителе, "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны");//,НомерСчета,Банк,БИК,КоррСчет");
	
	Если Шапка.Грузоотправитель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ФизЛицо Тогда 
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = ГрузоотправительПредставление;
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = "";
	Иначе	
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеФ = "";
		ОбластьМакета.Параметры.ГрузоотправительПредставлениеЮ = ГрузоотправительПредставление;
	КонецЕсли;	
	
	ГрузополучательПредставление  = ОписаниеОрганизации(СведенияОГрузополучателе,  "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны"); //,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
	Если Шапка.Грузополучатель.ЮрФизЛицо = перечисления.ЮрФизЛицо.ЮрЛицо Тогда
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = ГрузополучательПредставление;
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = "";
	Иначе 
		ОбластьМакета.Параметры.ГрузополучательПредставлениеЮ  = "";
		ОбластьМакета.Параметры.ГрузополучательПредставлениеФ  = ГрузополучательПредставление;
	КонецЕсли;
	//ОбластьМакета.Параметры.ПлательщикПредставление       = ОписаниеОрганизации(СведенияОПокупателе);
	
	
	//1,2
	//ОтпускРазрешилДолжность					ФИООтпускРазрешил	ГрузПринялДолжность					ГрузПолучилДолжность
	
	//  Если НЕ Шапка.ОтгрузкаЧерезЧП Тогда
	Кладовщик = ПолучитьКладовщика();
	ОбластьМакета.Параметры.ФИООтпускПроизвел = Кладовщик;
	ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ДолжнКладовщика(Кладовщик);  //!!!
	//КонецЕсли; 
	ОбластьМакета.Параметры.ФИОГрузПолучил = "";
	ОбластьМакета.Параметры.ГрузПолучилДолжность = "";
	
	//+++( 04.08.2011 - представление наименований в виде таблицы
	//==========================================================================================
	ТабДокумент.Вывести(ОбластьМакета);
	
	//КолСтолб = 2; // 0, 1, 2, 3, 4, 6.
	Если КолСтолб>0 Тогда
		Если КолСтолб=1 Тогда
			ОбластьМакета = Макет.ПолучитьОбласть("Назв");
			ОбластьМакета.Параметры.Пункт3_1 = стрЗаменить(Пункт3_1, "; ",";"+Символы.ПС);
			ТабДокумент.Вывести(ОбластьМакета);
			
		ИначеЕсли (КолСтолб>6) Тогда
			Предупреждение("Невозможно отобразить названия в "+строка(КолСтолб)+" столбцах!
			|Будет использован стандарный вывод названия (п. 3.1)",10);
			ОбластьМакета = Макет.ПолучитьОбласть("Назв");
			ОбластьМакета.Параметры.Пункт3_1 = Пункт3_1;
			ТабДокумент.Вывести(ОбластьМакета);
		Иначе
			КолСтолб= ?(КолСтолб=5, 6, КолСтолб);
			ОбластьМакета = Макет.ПолучитьОбласть("Назв_стр"+Строка(КолСтолб));
			
			N = СтрЧислоВхождений(Пункт3_1,";");//строки
			Nстр = Цел(N/КолСтолб) + ?(N%КолСтолб=0, 0, 1); // целое + 1 стр. на нецелое
			//-------основной цикл без таблицы значений-----------------------------
			Назв0 = Пункт3_1; // ограничимся циклом
			Для k=0 по Nстр - 1 цикл
				//СтрЗнач = табЗнач[k];
				для j=1 по КолСтолб цикл
					i= найти(Назв0,";");		L=стрДлина(Назв0);
					стрЗнач12 = СокрЛП(лев(Назв0, i-1)); Назв0 = Прав(Назв0, L-i);
					ОбластьМакета.Параметры["назв"+строка(j)] = стрЗнач12; // СтрЗнач[j-1]);
				конецЦикла;
				ТабДокумент.Вывести(ОбластьМакета);
			КонецЦикла;
			//------------------основной цикл -----------------------------
			
		КонецЕсли;
	Иначе  // как было - сплошным текстом!
		ОбластьМакета = Макет.ПолучитьОбласть("Назв");
		//Адиянов<<< 20161102 текст Пункт3_1 - пустая строка
		//{{{ОбластьМакета.Параметры.Пункт3_1 = "Список грузов см. Приложение"; //+++ 12.08.2011 Гаричев
		ОбластьМакета.Параметры.Пункт3_1 = ""; //+++ 12.08.2011 Гаричев
		//Адиянов>>> 20161102
		ТабДокумент.Вывести(ОбластьМакета);
	КонецЕсли;	//конец КолСтолб>0
	
	ОбластьМакета = Макет.ПолучитьОбласть("Лицевая2");
	//==========================================================================================
	//+++)
	
	//+++ Нетто, Брутто //, ОбъемШтук, ОбъемМест
	выборка2 = ПолучитьВесОбъем();
	Если Выборка2.Количество()>0 Тогда
		Выборка2.Следующий();
		ОбластьМакета.Параметры.МассаГрузаНетто  = ?(Выборка2.Нетто<>0,Формат(Выборка2.Нетто,"ЧН= ")+"кг; ", "");
		ОбластьМакета.Параметры.МассаГрузаБрутто = ?(Выборка2.Брутто<>0, "("+Формат(Выборка2.Брутто,"ЧН= ")+"кг); ", "");
		кол = Выборка2.Количество;
		колМест = Выборка2.КоличествоМест;
		ОбластьМакета.Параметры.ВсегоМестПрописью = ?(колМест=0, ?(кол=0,"",Строка(кол)+" шт."), строка(колМест)+" мест");
		
	Иначе 
		ОбластьМакета.Параметры.МассаГрузаНетто  = "";
		ОбластьМакета.Параметры.МассаГрузаБрутто = "";
		ОбластьМакета.Параметры.ВсегоМестПрописью = "";
	конецЕсли;
	
	
	//3.2 КолМест, маркировка-------------------------------------------
	ОбластьМакета.Параметры.Пункт3_2 = Пункт3_2;
	
	// [МассаГрузаНетто]; [МассаГрузаБрутто]; [Размеры]; [ОбъемМест]
	ОбластьМакета.Параметры.Пункт3_3 = Пункт3_3;
	
	
	//4
	ОбластьМакета.Параметры.ПереченьДопДокументов = ПереченьДопДокументов;
	ОбластьМакета.Параметры.ПереченьСертификатов  = ПереченьСертификатов;
	//5
	ОбластьМакета.Параметры.Пункт5_1 = Пункт5_1;
	ОбластьМакета.Параметры.Пункт5_2 = Пункт5_2;
	ОбластьМакета.Параметры.Пункт5_3 = Пункт5_3;
	
	//6,7 
	ОбластьМакета.Параметры.ПунктПогрузки  = "86 км МКАДа";
	
	Если СведенияОГрузоПолучателе.Представление<>Неопределено Тогда 
		ОбластьМакета.Параметры.ПунктРазгрузки = ?(ПунктРазгрузки="", ?(СведенияОГрузоПолучателе.ФактическийАдрес="",СведенияОГрузоПолучателе.ЮридическийАдрес,СведенияОГрузоПолучателе.ФактическийАдрес) , ПунктРазгрузки);
	КонецЕсли;
	
	

	ОбластьМакета.Параметры.Пункт6_6 = Водитель;
	ОбластьМакета.Параметры.Пункт7_6 = Пункт7_6;
	ОбластьМакета.Параметры.Пункт6_7 = "Глухов А.С."; //Водитель2;
	ОбластьМакета.Параметры.Пункт7_7 = "Глухов А.С."; //Водитель2;
	
	ОбластьМакета.Параметры.ДатаВремяПогрузки = ""; // устанавливается вручную
	ОбластьМакета.Параметры.ДатаВремяВыгрузки = ""; // устанавливается вручную
	
	ОбластьМакета.Параметры.СостояниеГрузаОтправителя  = СостояниеГрузаОтправителя;
	ОбластьМакета.Параметры.СостояниеГрузаПолучателя  = СостояниеГрузаПолучателя;
	
	ОбластьМакета.Параметры.ВсегоМестПрописью = Пункт3_2;
	//ОбластьМакета.Параметры.ВсегоНаименований = Формат(СсылкаНаОбъект.Товары.Количество(),"ЧН=-")+" тов.";
	//8
	ОбластьМакета.Параметры.СрокДоставки1 = Формат(СрокДоставки1,"ДФ=dd.MM.yyyy; ДП=---");
	//+++ ОбластьМакета.Параметры.ВидПеревозки = ?(ЗначениеЗаполнено(ВидПеревозки), ВидПеревозки, "Автомобильным транспортом");
	//9
	ОбластьМакета.Параметры.ФИОВодителя	              = "Глухов А.С."; //Водитель2;
	ОбластьМакета.Параметры.ВодительскоеУдостоверение = ВодительскоеУдостоверение;
	ОбластьМакета.Параметры.ДолжнВодитель             = ?(ЗначениеЗаполнено(Водитель2), "водитель", "");
	
	ТабДокумент.Вывести(ОбластьМакета);
		
	ТабДокумент.ВывестиГоризонтальныйРазделительСтраниц();
	
	
	//========================параметры оборотной стороны==========================================
	ОбластьМакета = Макет.ПолучитьОбласть("Оборотная");
	
	//10
	Если ТипЗнч(Перевозчик2)<>Тип("Строка") Тогда
		Если ЗначениеЗаполнено(Перевозчик2) Тогда
			СведенияОПеревозчике = СведенияОЮрФизЛице(Перевозчик2,  Шапка.ДатаДокумента);
			ПеревозчикПредставление = ОписаниеОрганизации(СведенияОПеревозчике,  "ПолноеНаименование,ИНН,ФактическийАдрес,Телефоны"); //,Телефоны,НомерСчета,Банк,БИК,КоррСчет");
			
			Если Перевозчик2.ЮрФизЛицо = перечисления.ЮрФизЛицо.ФизЛицо Тогда 
				ОбластьМакета.Параметры.ОрганизацияПеревозчикФ = ПеревозчикПредставление;
				ОбластьМакета.Параметры.ОрганизацияПеревозчикЮ = "";
			Иначе	
				ОбластьМакета.Параметры.ОрганизацияПеревозчикФ ="";
				ОбластьМакета.Параметры.ОрганизацияПеревозчикЮ = ПеревозчикПредставление;
			КонецЕсли;
			
			//Иначе
			//Перевозчик = Шапка.Грузоотправитель;
			//СведенияОПеревозчике = СведенияОгрузоотправителе;
			//ПеревозчикПредставление = ГрузоотправительПредставление;
			//ФИОруководителя = Руководители.Руководитель;
		КонецЕсли;
	Иначе //строка!
		ОбластьМакета.Параметры.ОрганизацияПеревозчикЮ = Перевозчик2;
	КонецЕсли;
	
	//+++ 29.07.2011 Кладовщик = ПолучитьКладовщика();
	ОбластьМакета.Параметры.ФИОруководителя = ""; //Кладовщик
	
	ОбластьМакета.Параметры.ФИОВодителя               = "Глухов А.С."; //Водитель2;
	ОбластьМакета.Параметры.ВодительскоеУдостоверение = ВодительскоеУдостоверение;	
	
	//11
	ОбластьМакета.Параметры.МаркаАвтомобиля           = "Газель"; //СокрЛП(МаркаАвтомобиля2);
	ОбластьМакета.Параметры.Прицеп                    = ?(ЗначениеЗаполнено(МаркаПрицепа), "Прицеп: "+МаркаПрицепа, "");
	
	ОбластьМакета.Параметры.ГосНомерАвтомобиля        = "А 635 СН 76"; //ГосНомерАвтомобиля2;
	ОбластьМакета.Параметры.ГосНомерПрицепа           = ?(ЗначениеЗаполнено(ГосНомерПрицепа), "Прицеп: "+ГосНомерПрицепа, "");
	
	//12
	ОбластьМакета.Параметры.СостояниеГрузаОтправителя  = СостояниеГрузаОтправителя;
	ОбластьМакета.Параметры.СостояниеГрузаПолучателя  = СостояниеГрузаПолучателя;
	
	//15
	ОбластьМакета.Параметры.ВсегоКОплате     = "";
	ОбластьМакета.Параметры.ПроцентНаценки   = ""; //"процент: ";
	ОбластьМакета.Параметры.СкладскиеРасходы = "";
	
	//+++ 07.06.2012
	Если СсылкаНаОбъект.Дата>ДатаНачалаТТН_13032012 Тогда 
		
		Если ЗначениеЗаполнено(Перевозчик) Тогда //+++ 13.06.2012
			ОбластьМакета.Параметры.Пункт15_7 = ГрузоотправительПредставление;
		Иначе
			ОбластьМакета.Параметры.Пункт15_7 = "";
		КонецЕсли;	
		
		//16
		ОбластьМакета.Параметры.ФИООтпускПроизвел       = кладовщик;
		ОбластьМакета.Параметры.ДатаПогрузки = ЭтотОбъект.ДатаВремяПогрузки; //кладовщик
		
		ОбластьМакета.Параметры.ФИОГрузПолучил = "Глухов А.С."; //Водитель2;
		ОбластьМакета.Параметры.ДатаРазгрузки = ЭтотОбъект.ДатаВремяВыгрузки; //кладовщик
		// ОбластьМакета.Параметры.Пункт10_1Ведомость = Пункт10_2;
	КонецЕсли;
	
	ТабДокумент.Вывести(ОбластьМакета);
	
	//===================================================================
	//Приложение со списком товаров
	//+++ 12.04.2016 - выключено
Если ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.РеализацияТоваровУслуг")тогда // 13.04.2016	
	Если КолСтолб<=1 
		и найти(СсылкаНаОбъект.ДоговорКонтрагента.Наименование, "*")>0 Тогда  //только не для табличной части 3.1
		ТабДокумент.ВывестиГоризонтальныйРазделительСтраниц();
		
		ОбластьМакета = Макет.ПолучитьОбласть("ШапкаПриложения");
		ОбластьМакета.Параметры.НомерДокумента  = ПолучитьНомерНаПечать(Шапка);
		ОбластьМакета.Параметры.ДатаДокумента   = Формат(Шапка.ДатаДокумента, "Л=ru_RU; ДЛФ=DD; ДП=-");
		ТабДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("СтрокаПриложения");
		
		//---------------------------------
		//получение всех данных идет из Документа или СпискаДокументов
		Если ЭтотОбъект.Реализации.Количество()=0 Тогда
			Док1 = СсылкаНаОбъект;
			
			ДопКолонка = Константы.ДополнительнаяКолонкаПечатныхФормДокументов.Получить();
			для каждого Стр1 из Док1.Товары цикл
				//++Смирнов для Лагерной и Радуга Питер убираем LegeArtis
				Если Шапка.Покупатель.Код="93136  " или  Шапка.Покупатель.Код="91777  " тогда
					ОбластьМакета.Параметры.ТоварНаименование = СтрЗаменить(стр1.Номенклатура,"LegeArtis","");
				иначе
					ОбластьМакета.Параметры.ТоварНаименование = стр1.Номенклатура;
				КонецЕсли;
				ОбластьМакета.Параметры.Количество = стр1.Количество;
				Если ТипЗнч(док1)=Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
					ОбластьМакета.Параметры.Склад	= ?(ЗначениеЗаполнено(стр1.Склад), стр1.Склад, док1.СкладОтправитель);
				Иначе
					ОбластьМакета.Параметры.Склад	= ?(ЗначениеЗаполнено(стр1.Склад), стр1.Склад, док1.Склад);
				КонецЕсли;
				
				ОбластьМакета.Параметры.БазоваяЕдиницаНаименование = стр1.Номенклатура.БазоваяЕдиницаИзмерения;
				Если ДопКолонка = Перечисления.ДополнительнаяКолонкаПечатныхФормДокументов.Артикул Тогда
					ОбластьМакета.Параметры.Артикул = стр1.Номенклатура.Артикул;
				Иначе
					ОбластьМакета.Параметры.Артикул = стр1.Номенклатура.Код;
				КонецЕсли;
				
				ТабДокумент.Вывести(ОбластьМакета);
			КонецЦикла;
			КолИтого = Док1.Товары.Итог("Количество");
			КолСтрок = Док1.Товары.Количество();
		Иначе//много
			КолИтого = 0; КолСтрок = 0;
			ДопКолонка = Константы.ДополнительнаяКолонкаПечатныхФормДокументов.Получить();
			для каждого Док1 из ЭтотОбъект.Реализации цикл
				для каждого Стр1 из Док1.реализация.Товары цикл
					//++Смирнов для Лагерной и Радуга Питер убираем LegeArtis
					Если Шапка.Покупатель.Код="93136  " или  Шапка.Покупатель.Код="91777  " тогда
						ОбластьМакета.Параметры.ТоварНаименование = СтрЗаменить(стр1.Номенклатура,"LegeArtis","");
					иначе
						ОбластьМакета.Параметры.ТоварНаименование = стр1.Номенклатура;
					КонецЕсли;

					ОбластьМакета.Параметры.Количество = стр1.Количество;
					Если ТипЗнч(Док1.реализация)=Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
						ОбластьМакета.Параметры.Склад	= ?(ЗначениеЗаполнено(стр1.Склад), стр1.Склад, Док1.реализация.СкладОтправитель);
					Иначе
						ОбластьМакета.Параметры.Склад	= ?(ЗначениеЗаполнено(стр1.Склад), стр1.Склад, Док1.реализация.Склад);
					КонецЕсли;
					ОбластьМакета.Параметры.БазоваяЕдиницаНаименование = стр1.Номенклатура.БазоваяЕдиницаИзмерения;
					
					Если ДопКолонка = Перечисления.ДополнительнаяКолонкаПечатныхФормДокументов.Артикул Тогда
						ОбластьМакета.Параметры.Артикул = стр1.Номенклатура.Артикул;
					Иначе
						ОбластьМакета.Параметры.Артикул = стр1.Номенклатура.Код;
					КонецЕсли;
					
					
					ТабДокумент.Вывести(ОбластьМакета);
				КонецЦикла;
				КолИтого = КолИтого + Док1.реализация.Товары.Итог("Количество");
				КолСтрок = КолСтрок + Док1.реализация.Товары.Количество();
			КонецЦикла;
		КонецЕсли;
		//---------------------------------
		
		
		ОбластьМакета = Макет.ПолучитьОбласть("ПодвалПриложения");
		ОбластьМакета.Параметры.ИтогоКоличество  	= КолИтого;
		ФормСтрока = "Л = ru_RU; ДП = Истина";
		ПарПредмета=",,,ж,,,,м,0";
		ОбластьМакета.Параметры.ВсегоНаименований	= ЧислоПрописью(КолСтрок, ФормСтрока, ПарПредмета);
		ОбластьМакета.Параметры.КоличествоСтрок	= КолСтрок;
		должВод = "";
		Если ЗначениеЗаполнено(Водитель2) Тогда
			должВод = "водитель"; 
		КонецЕсли;
		ОбластьМакета.Параметры.ДолжнВодитель  = должВод;
		ОбластьМакета.Параметры.ФИОВодителя    = "Глухов А.С."; //Водитель2;
		
		
		ОбластьМакета.Параметры.ФИОразрешил = Водитель;
		ОбластьМакета.Параметры.ФИОотгрузил = Водитель;
		ОбластьМакета.Параметры.ОтпускПроизвелДолжность = ?(ЗначениеЗаполнено(Водитель), "водитель", "");
		
		
		ОбластьМакета.Параметры.ДатаДокумента		= Формат(Шапка.ДатаДокумента, "Л=ru_RU; ДЛФ=DD; ДП=-");
		ТабДокумент.Вывести(ОбластьМакета);
		
	КонецЕсли;//КолСтолб<=1
КонецЕсли; // Договор *	
	////===================================================================
	НапечататьДокумент(ТабДокумент, 1, Ложь, "Транспортная Накладная (Приложение №4) для второго перевозчика");
	
КонецФункции // ПечатьТТН_250711()
//Орлов--
//+++)

//+++ 12.04.2018
функция получитьЦеныB2B(Дата, списТов)
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ 
	|	ЦеныНоменклатурыСрезПоследних.Номенклатура,
	|	ЦеныНоменклатурыСрезПоследних.Цена
	|ИЗ
	|	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(&Дата,
	|			Номенклатура В (&списТов)
	|				И ТипЦен = &ТипЦенB2B) КАК ЦеныНоменклатурыСрезПоследних";
	Запрос.УстановитьПараметр("Дата", Дата);
	Запрос.УстановитьПараметр("списТов", списТов);
	Запрос.УстановитьПараметр("ТипЦенB2B", справочники.ТипыЦенНоменклатуры.НайтиПоКоду("00032") ); //B2B Базовая
	Результат = Запрос.Выполнить();
	Выборка = Результат.Выбрать();
	соотв = новый Соответствие;
	Пока Выборка.Следующий() Цикл
	    соотв.Вставить( выборка.Номенклатура, выборка.Цена);
	КонецЦикла;

	возврат соотв;
КонецФункции

функция ПолучитьКладовщика() Экспорт
	
	Если Кладовщик <> "" Тогда   //уже заполнен!
		Возврат Кладовщик;
	КонецЕсли;
	
	Отбор = Новый Структура("СтруктурнаяЕдиница");
	
	Если НЕ ЕстьРеквизитДокумента("Склад",СсылкаНаОбъект.Метаданные()) и не (ЕстьРеквизитДокумента("СкладОтправитель",СсылкаНаОбъект.Метаданные()) и ЕстьРеквизитДокумента("СкладПолучатель",СсылкаНаОбъект.Метаданные()) и ((СсылкаНаОбъект.СкладОтправитель.код = "00693" и СсылкаНаОбъект.СкладПолучатель.код = "00692") или (СсылкаНаОбъект.СкладПолучатель.код = "00962" и СсылкаНаОбъект.СкладОтправитель.ПринадлежитЭлементу(Справочники.Склады.НайтиПоКоду("00929"))) или (СсылкаНаОбъект.СкладПолучатель.код = "00634" и СсылкаНаОбъект.СкладОтправитель.ПринадлежитЭлементу(Справочники.Склады.НайтиПоКоду("00643"))) или (СсылкаНаОбъект.СкладПолучатель.код = "01366" и СсылкаНаОбъект.Подразделение = Справочники.Подразделения.НайтиПоКоду("00133")))) Тогда
		возврат Кладовщик;
	КонецЕсли;
	
//---------------Сначала проверим кладовщика склада-------------------------------------------	
	//Отбор.СтруктурнаяЕдиница = ЭтотОбъект.СсылкаНаОбъект.Склад;
	//СрезПоследних   = РегистрыСведений.ОтветственныеЛица.СрезПоследних(ЭтотОбъект.СсылкаНаОбъект.Дата, Отбор);
	// Если СрезПоследних <> неопределено и СрезПоследних.Количество()>0 Тогда
	//	Кладовщик = СрезПоследних[0].ФизическоеЛицо.Наименование;
	//	возврат Кладовщик;
	//КонецЕсли;	
		
	
//------------------только для наших организаций----------------------------------------------------------	
	Если (ЭтотОбъект.СсылкаНаОбъект.Организация.ИНН = "7604069216")          // ЗАО ТК Яршинторг (Ярославль)
		  или (ЭтотОбъект.СсылкаНаОбъект.Организация.ИНН = "760200230721") Тогда  // ИП Фролов
		  
		  
//+++ 30.03.2012 только для реализаций
//+++ 02.04.2015 - для всех док!
Если ТипЗнч(СсылкаНаОбъект) = тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
		
		// проверяем подразделение Реализации
		Если СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00107") Тогда
			Кладовщик ="Войновская Н.Р."
		ИначеЕсли СсылкаНаОбъект.Подразделение.ОбособленноеПодразделение
			//= справочники.Подразделения.НайтиПоКоду("00106")
			//или СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00112")
			//или СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00122") 
			//или СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00138") 
			//или СсылкаНаОбъект.Подразделение = справочники.Подразделения.НайтиПоКоду("00133") 
			Тогда
			Режим = РежимДиалогаВопрос.ДаНет;
			
		Отбор1 = новый Структура;
		Отбор1.Вставить("Подразделение", СсылкаНаОбъект.Подразделение);
		
		Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.Руководитель);
		регСведРук = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
		
		Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.ГлавныйБухгалтер);
		регСведГлБух = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
		
		Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.Кассир);
		регСведКассир = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
		
		Если СсылкаНаОбъект.Подразделение.Код = "00112" тогда //СПб - фиксировано - с вопросом, если Рук.<>Гл.Бух.!
			
			Если регСведРук.ФизическоеЛицо<>регСведГлБух.ФизическоеЛицо Тогда
				Ответ = КодВозвратаДиалога.Да;//18.02.2016 - ВСЕГДА НЕЯСКИНА
				//Вопрос("Использовать Основного ответственного?
				//| Если ответственный - "+строка(регСведРук.ФизическоеЛицо)+" (Да)
				//| Иначе - "+строка(регСведГлБух.ФизическоеЛицо)+" (Нет)?", РежимДиалогаВопрос.ДаНет, 0);
				Если Ответ = КодВозвратаДиалога.Да Тогда
					Кладовщик =строка(регСведРук.ФизическоеЛицо);
					ДолжнКладовщика =регСведРук.Должность;
				 Иначе
					Кладовщик =строка(регСведГлБух.ФизическоеЛицо);
					ДолжнКладовщика =регСведРук.Должность;
				 КонецЕсли;
			 Иначе		
				Кладовщик =строка(регСведРук.ФизическоеЛицо);
				 ДолжнКладовщика = регСведРук.Должность;
			 КонецЕсли;		
			 
			 
		 ИначеЕсли СсылкаНаОбъект.Подразделение.Код = "00133" тогда //Москва
			 Если регСведРук.ФизическоеЛицо = СсылкаНаОбъект.Ответственный.ФизЛицо тогда
				регСведМск = регСведРук;
			ИначеЕсли регСведГлБух.ФизическоеЛицо = СсылкаНаОбъект.Ответственный.ФизЛицо тогда
				регСведМск = регСведГлБух;
			ИначеЕсли регСведКассир.ФизическоеЛицо = СсылкаНаОбъект.Ответственный.ФизЛицо тогда
				регСведМск = регСведКассир;
			Иначе
				регСведМск = новый Структура("ФизическоеЛицо, Должность, Доверенность","","",""); 
			КонецЕсли;
		
			Кладовщик = регСведМск.ФизическоеЛицо;
			ДолжнКладовщика =регСведМск.Должность;
			
		ИначеЕсли СсылкаНаОбъект.Подразделение.Код = "00138" тогда //ЕКТ +++ 25.08.2015
			Кладовщик = регСведРук.ФизическоеЛицо;
			ДолжнКладовщика =регСведРук.Должность;
		
		Иначе//РнД	
			Если регСведРук.ФизическоеЛицо = СсылкаНаОбъект.Ответственный.ФизЛицо тогда
				регСведРнД = регСведРук;
			ИначеЕсли регСведГлБух.ФизическоеЛицо = СсылкаНаОбъект.Ответственный.ФизЛицо тогда
				регСведРнД = регСведГлБух;
			ИначеЕсли регСведКассир.ФизическоеЛицо = СсылкаНаОбъект.Ответственный.ФизЛицо тогда
				регСведРнД = регСведКассир;
			Иначе
				регСведРнД = новый Структура("ФизическоеЛицо, Должность, Доверенность","","",""); 
			КонецЕсли;
		
			Кладовщик = регСведРнД.ФизическоеЛицо;
			ДолжнКладовщика =регСведРнД.Должность;
			
		КонецЕсли;
		//+++)
	
		//-------------------- проверяем подразделение Заказа Покупателя ------------------------------------------
	ИначеЕсли ЗначениеЗаполнено(СсылкаНаОбъект.сделка) Тогда
		
			Если СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00107")Тогда
				Кладовщик = "Войновская Н.Р.";
				
			ИначеЕсли СсылкаНаОбъект.сделка.Подразделение.ОбособленноеПодразделение
				//= справочники.Подразделения.НайтиПоКоду("00106")
				// или  СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00112")
				//  или  СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00122")
				//  		  или  СсылкаНаОбъект.сделка.Подразделение = справочники.Подразделения.НайтиПоКоду("00138") 
				Тогда
				Режим = РежимДиалогаВопрос.ДаНет;
				
				Отбор1 = новый Структура;
				Отбор1.Вставить("Подразделение",СсылкаНаОбъект.сделка.Подразделение);
				Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.Руководитель);  //Жилин
				регСведРук = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
				
				Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.ГлавныйБухгалтер);
				регСведГлБух = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);

				Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.Кассир);
				регСведКассир = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
		
				Если СсылкаНаОбъект.Подразделение.Код = "00112" тогда //СПб - фиксировано - с вопросом, если Рук.<>Гл.Бух.!
					
					Если регСведРук.ФизическоеЛицо<>регСведГлБух.ФизическоеЛицо Тогда
						Ответ = Вопрос("Использовать Основного ответственного?
						| Если ответственный - "+строка(регСведРук.ФизическоеЛицо)+" (Да)
						| Иначе - "+строка(регСведГлБух.ФизическоеЛицо)+" (Нет)?", РежимДиалогаВопрос.ДаНет, 0);
						Если Ответ = КодВозвратаДиалога.Да Тогда
							Кладовщик =строка(регСведРук.ФизическоеЛицо);
							ДолжнКладовщика =регСведРук.Должность;
						 Иначе
							Кладовщик =строка(регСведГлБух.ФизическоеЛицо);
							ДолжнКладовщика =регСведРук.Должность;
						 КонецЕсли;
					 Иначе		
						Кладовщик =строка(регСведРук.ФизическоеЛицо);
						 ДолжнКладовщика = регСведРук.Должность;
					 КонецЕсли;		
				ИначеЕсли СсылкаНаОбъект.Подразделение.Код = "00112" тогда //+++ 02.04.2015  //РнД	
					Если регСведРук.ФизическоеЛицо = СсылкаНаОбъект.Ответственный.ФизЛицо тогда
						регСведРнД = регСведРук;
					ИначеЕсли регСведГлБух.ФизическоеЛицо = СсылкаНаОбъект.Ответственный.ФизЛицо тогда
						регСведРнД = регСведГлБух;
					ИначеЕсли регСведКассир.ФизическоеЛицо = СсылкаНаОбъект.Ответственный.ФизЛицо тогда
						регСведРнД = регСведКассир;
					Иначе
						регСведРнД = новый Структура("ФизическоеЛицо, Должность, Доверенность","","",""); 
					КонецЕсли;
				
					Кладовщик = регСведРнД.ФизическоеЛицо;
					ДолжнКладовщика =регСведРнД.Должность;
									
				Иначе  //+++ 02.04.2015
					Отбор1 = новый Структура;
					Отбор1.Вставить("Подразделение", СсылкаНаОбъект.Подразделение);
					Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.Кассир); //Кассир - руководителя!
					регСведКладовщик = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
                    Кладовщик =  регСведКладовщик.ФизическоеЛицо;
					ДолжнКладовщика =регСведКладовщик.Должность;
				КонецЕсли;
            //+++)
				
	    	Иначе	
				Кладовщик = "Фролов А.И.";
		    КонецЕсли;
		Иначе	
			Кладовщик = "Фролов А.И.";
		КонецЕсли;	
	Иначе //как было
			Кладовщик = "Фролов А.И.";
	КонецЕсли;

		  
		  
	Иначе //не наша организация....
		Если значениеЗаполнено(ЭтотОбъект.СсылкаНаОбъект.Ответственный.ФизЛицо) Тогда
			Кладовщик = ЭтотОбъект.СсылкаНаОбъект.Ответственный.ФизЛицо.Наименование;
		Иначе	
			Кладовщик = ЭтотОбъект.СсылкаНаОбъект.Ответственный;
		КонецЕсли;
	КонецЕсли;
	
	//+++ 02.04.2015
	Если типЗнч(ЭтотОбъект.СсылкаНаОбъект) = тип("ДокументСсылка.ПеремещениеТоваров")
		И ЭтотОбъект.СсылкаНаОбъект.СкладОтправитель.Подразделение.ОбособленноеПодразделение ТОГДА
		Отбор1 = новый Структура;
		Отбор1.Вставить("Подразделение", ЭтотОбъект.СсылкаНаОбъект.СкладОтправитель.Подразделение);
		Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.Кассир);
		регСведКладовщик = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
        Кладовщик =  регСведКладовщик.ФизическоеЛицо;
		ДолжнКладовщика =регСведКладовщик.Должность;
     КонецЕсли;

	возврат Кладовщик;

КонецФункции 

функция ДолжнКладовщика(Пункт66) экспорт
	Если ДолжнКладовщика="" Тогда
		возврат ДолжнКладовщика;
	КонецЕсли;		
		
		// ПредставлениеПодразделения
		Отбор1 = новый Структура;
		Отбор1.Вставить("Подразделение",    СсылкаНаОбъект.Подразделение);
		Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.Руководитель); //Жилин
		регСведРук   = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
		
		Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.ГлавныйБухгалтер);
		регСведГлБух = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);

		Отбор1.Вставить("ОтветственноеЛицо",Перечисления.ОтветственныеЛицаОрганизации.Кассир);    //+++ 26.11.2013
		регСведКассир = РегистрыСведений.ОтветственныеЛицаПодразделений.ПолучитьПоследнее(СсылкаНаОбъект.Дата, Отбор1);
		
		ДолжнКладовщика =?(Пункт66="Фролов А.И.", "Зав.складом", 
		?(Пункт66="Войновская Н.Р.","",
			?(Пункт66=строка(регСведРук.ФизическоеЛицо),регСведРук.Должность,
			  ?(Пункт66=строка(регСведГлБух.ФизическоеЛицо),регСведГлБух.Должность,
				?(Пункт66=строка(регСведКассир.ФизическоеЛицо),регСведКассир.Должность,""))))  );
		
	возврат ДолжнКладовщика;
	
КонецФункции
 

//----реализация ВозвратТоваровПоставщику ОперацияПоОтветственномуХранению-------------------------------
Функция ПолучитьШапку() экспорт
	
	Если ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
		типДок = "РеализацияТоваровУслуг";
	ИначеЕсли ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.ВозвратТоваровПоставщику") Тогда
		типДок = "ВозвратТоваровПоставщику";
	ИначеЕсли ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.ОперацияПоОтветственномуХранению") Тогда
	   возврат ПолучитьШапку_ОтвХран();
    ИначеЕсли ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
	   возврат ПолучитьШапку_Перемещение();   
	КонецЕсли;   
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ТекущийДокумент",  СсылкаНаОбъект);
	Запрос.УстановитьПараметр("ПустойКонтрагент", Справочники.Контрагенты.ПустаяСсылка());

	Запрос.Текст ="ВЫБРАТЬ
	|	Номер,
	|	Дата         КАК ДатаДокумента,
	|	Организация,
	|	Организация  КАК ЮрФизЛицо,
	|	Организация  КАК Поставщик,
	|	Организация  КАК Контрагент,
	|	Организация  КАК Руководители,
	|	ВЫБОР КОГДА Грузополучатель = &ПустойКонтрагент
	//|	      ТОГДА ВЫБОР КОГДА КонтрагентДляПечати = &ПустойКонтрагент
	|					  ТОГДА Контрагент
	//|					  ИНАЧЕ КонтрагентДляПечати КОНЕЦ
	|	      ИНАЧЕ Грузополучатель КОНЕЦ КАК Грузополучатель,
	|
	|	ВЫБОР КОГДА Грузоотправитель = &ПустойКонтрагент
	|	      ТОГДА Организация
	|	      ИНАЧЕ Грузоотправитель КОНЕЦ КАК Грузоотправитель,
	|
	|	БанковскийСчетОрганизации КАК БанковскийСчет,
//	|	ВЫБОР КОГДА КонтрагентДляПечати = &ПустойКонтрагент
//	|		  ТОГДА Контрагент
//	|   	  ИНАЧЕ КонтрагентДляПечати КОНЕЦ КАК Покупатель,

|	ВЫБОР КОГДА Грузополучатель = &ПустойКонтрагент
	//|	      ТОГДА ВЫБОР КОГДА КонтрагентДляПечати = &ПустойКонтрагент
	|					  ТОГДА Контрагент
	//|					  ИНАЧЕ КонтрагентДляПечати КОНЕЦ
	|	      ИНАЧЕ Грузополучатель КОНЕЦ как Покупатель,
	
//	|	ВЫБОР КОГДА КонтрагентДляПечати = &ПустойКонтрагент
//	|		  ТОГДА Контрагент
//	|   	  ИНАЧЕ КонтрагентДляПечати КОНЕЦ КАК Плательщик, 
	|   Контрагент как Плательщик,
	|	"+?(типДок = "ВозвратТоваровПоставщику", " Значение(Справочник.Подразделения.ПустаяСсылка)"
	                                           , типДок+".Подразделение")+" как Подразделение,
	|	ВалютаДокумента,
	|	КурсВзаиморасчетов       КАК Курс,
	|	КратностьВзаиморасчетов  КАК Кратность,
//	|   ОтгрузкаЧерезЧП,
	|	УчитыватьНДС,
	|	ЕСТЬNULL(ОтветственныеЛицаПодразделенийСрезПоследних.Должность, """") КАК Должность,
	|	Ответственный.ФизЛицо КАК ФизЛицо,
	|	СуммаВключаетНДС"+?(типДок = "РеализацияТоваровУслуг", ", НомерДоверенности, ДатаДоверенности, ФизЛицоДоверенности", "")+
	"
	|ИЗ
	|	Документ."+ТипДок+" КАК РеализацияТоваровУслуг
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ОтветственныеЛицаПодразделений.СрезПоследних КАК ОтветственныеЛицаПодразделенийСрезПоследних
	|	ПО РеализацияТоваровУслуг.Ответственный.ФизЛицо = ОтветственныеЛицаПодразделенийСрезПоследних.ФизическоеЛицо
	|
	|ГДЕ
	|	РеализацияТоваровУслуг.Ссылка = &ТекущийДокумент";

	Шапка = Запрос.Выполнить().Выбрать();
	Шапка.Следующий();

    Возврат Шапка;
конецФункции

функция ПолучитьШапку_ОтвХран() Экспорт

	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ТекущийДокумент",  СсылкаНаОбъект.Ссылка);
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Номер,
	|	Дата         КАК ДатаДокумента,
	|	Организация,
	|	Организация  КАК ЮрФизЛицо,
	|	Организация  КАК Поставщик,
	|	Организация  КАК Контрагент,
	|	Организация  КАК Руководители,
	//|	Организация КАК Грузоотправитель,
	//|	Контрагент  КАК Грузополучатель,
	|	Контрагент КАК Покупатель,
	|	Организация.ОсновнойБанковскийСчет КАК БанковскийСчет,
	|	Контрагент КАК Плательщик,
	|	Подразделение,
	|	1       КАК Курс,
	|	1  КАК Кратность
	
	|ИЗ
	|	Документ.ОперацияПоОтветственномуХранению 
	|
	|ГДЕ
	|	Ссылка = &ТекущийДокумент";
	табл = Запрос.Выполнить().Выгрузить();
	табл.Колонки.Добавить("Грузоотправитель");
	табл.Колонки.Добавить("Грузополучатель");
	рез = табл[0];
	
	//+++ 23.08.2018 принудительно меняем!
		Если СсылкаНаОбъект.ВидОперации = перечисления.ВидыОперацийПоОтветственномуХранению.ПеремещениеМеждуСкладами тогда 
			Яр = справочники.Подразделения.НайтиПоКоду("00005");
			ПодразделениеОтпр = СсылкаНаОбъект.Товары[0].Склад.Подразделение;
			Если ПодразделениеОтпр.Пустая() тогда
				ПодразделениеОтпр = Яр;
			КонецЕсли;	
			ПодразделениеПолуч = СсылкаНаОбъект.СкладПолучатель.Подразделение;
			Если ПодразделениеПолуч.Пустая() тогда
				ПодразделениеПолуч = Яр;
			КонецЕсли;	
			
			рез.Грузоотправитель = ПодразделениеОтпр.Контрагент;// С ФИЛИАЛА НА яР... иначе с Яр на Товары в пути...
			рез.Грузополучатель  = ?(ПодразделениеОтпр=ПодразделениеПолуч, яР.Контрагент, ПодразделениеПолуч.Контрагент); 
		иначе
			рез.Грузоотправитель = СсылкаНаОбъект.Организация;
			рез.Грузополучатель  = СсылкаНаОбъект.Контрагент;
		КонецЕсли;

	возврат рез;
КонецФункции	

функция ПолучитьШапку_Перемещение() Экспорт
		ДопКолонка = Константы.ДополнительнаяКолонкаПечатныхФормДокументов.Получить();
	Если ДопКолонка = Перечисления.ДополнительнаяКолонкаПечатныхФормДокументов.Артикул Тогда
		ТоварКод = "Артикул";
	Иначе
		ТоварКод = "Код";
	КонецЕсли;

	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ТекущийДокумент",  СсылкаНаОбъект.Ссылка);
	
	//+++ Контргаент из Заказа который во внутреннем заказе является основанием
	Если ЗначениеЗаполнено(СсылкаНаОбъект.ВнутреннийЗаказ)Тогда 
    	Если ЗначениеЗаполнено(СсылкаНаОбъект.ВнутреннийЗаказ.ДокументОснование) Тогда
			Контрагент = СсылкаНаОбъект.ВнутреннийЗаказ.ДокументОснование.Контрагент;
			Грузоотправитель = СсылкаНаОбъект.ВнутреннийЗаказ.ДокументОснование.Грузоотправитель;
			Грузополучатель = СсылкаНаОбъект.ВнутреннийЗаказ.ДокументОснование.Грузополучатель;
			//проверим 
			Грузоотправитель = ?(ЗначениеЗаполнено(Грузоотправитель), Грузоотправитель, СсылкаНаОбъект.Организация);
			Грузополучатель =  ?(ЗначениеЗаполнено(Грузополучатель), Грузополучатель,   Контрагент);
		Иначе 
			Контрагент = Справочники.Контрагенты.ПустаяСсылка();
			Грузоотправитель = СсылкаНаОбъект.Организация;
			Грузополучатель  = Контрагент;
		КонецЕсли;
	Иначе 
		Контрагент = Справочники.Контрагенты.ПустаяСсылка();
		Грузоотправитель = СсылкаНаОбъект.Организация;
		Грузополучатель  = Контрагент;
	КонецЕсли;
	
	//+++ 02.04.2015 - внутренние перемещения со сторонним поставщиком!
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") тогда
	
		//+++ 10.09.2018 принудительно меняем!
		Яр = справочники.Подразделения.НайтиПоКоду("00005");
		Если СсылкаНаОбъект.СкладПолучатель.Подразделение.ОбособленноеПодразделение 
			или СсылкаНаОбъект.СкладОтправитель.Подразделение.ОбособленноеПодразделение тогда
			
			ПодразделениеОтпр =  СсылкаНаОбъект.СкладОтправитель.Подразделение;
			ПодразделениеОтпр = ?(ПодразделениеОтпр.Пустая(), яр, ПодразделениеОтпр);
			
			ПодразделениеПолуч = СсылкаНаОбъект.СкладПолучатель.Подразделение;
			ПодразделениеПолуч = ?(ПодразделениеПолуч.Пустая(), яр, ПодразделениеПолуч);
			
			Если ПодразделениеПолуч<>Яр и СсылкаНаОбъект.СкладОтправитель.ТипСклада=перечисления.ТипыСкладов.ВПути тогда
				ПодразделениеОтпр = Яр;
			КонецЕсли;	
			
			Если ПодразделениеОтпр<>Яр и СсылкаНаОбъект.СкладПолучатель.ТипСклада=перечисления.ТипыСкладов.ВПути тогда
				ПодразделениеПолуч = Яр;
			КонецЕсли;	
			
			// С ФИЛИАЛА НА яР... иначе с Яр на Товары в пути...
			
			Грузоотправитель = ПодразделениеОтпр.Контрагент; 
			Грузополучатель  = ПодразделениеПолуч.Контрагент;
		сообщить("Перемещение Из "+строка(Грузоотправитель)+" >> "+строка(Грузополучатель));
		//Контрагент = Грузополучатель;

		иначе
			Грузоотправитель = СсылкаНаОбъект.СкладОтправитель.Подразделение.Контрагент;
			Грузополучатель  = СсылкаНаОбъект.СкладПолучатель.Подразделение.Контрагент;
		КонецЕсли;
		
	КонецЕсли;	
	
	Запрос.УстановитьПараметр("Контрагент", Контрагент);
    Запрос.УстановитьПараметр("Грузоотправитель", Грузоотправитель);
    Запрос.УстановитьПараметр("Грузополучатель", Грузополучатель);
  //+++)
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Номер,
	|	Дата КАК ДатаДокумента,
	|	Организация,
	|	Организация.ЮрФизЛицо КАК ЮрФизЛицо,
	|	Организация.ОсновнойБанковскийСчет КАК БанковскийСчет,
	|	Организация  КАК Поставщик,
	|	&Контрагент  КАК Контрагент,
	|	Организация  КАК Руководители,
	|	&Контрагент КАК Покупатель,
	|	&Грузоотправитель КАК Грузоотправитель,
	|   &Грузополучатель КАК Грузополучатель,
	|	&Контрагент КАК Плательщик,
	|	Подразделение,
	|	1       КАК Курс,
	|	1  КАК Кратность
	|ИЗ
	|	Документ.ПеремещениеТоваров 
	|
	|ГДЕ
	|	Ссылка = &ТекущийДокумент";

	Шапка = Запрос.Выполнить().Выбрать();
	Шапка.Следующий();

возврат Шапка;
КонецФункции	


функция ПолучитьВесОбъем() экспорт 
	
	Если ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
		типДок = "РеализацияТоваровУслуг";
	ИначеЕсли ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.ВозвратТоваровПоставщику") Тогда
		типДок = "ВозвратТоваровПоставщику";
	ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ОперацияПоОтветственномуХранению") Тогда
		типДок = "ОперацияПоОтветственномуХранению";
	ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
		типДок = "ПеремещениеТоваров";
	Иначе
		ТабЗнач = новый ТаблицаЗначений;	
		Возврат ТабЗнач;		
	КонецЕсли;   
	
	//[МассаГрузаНетто] ([МассаГрузаБрутто] [Размеры] [ОбъемМест])
	Запрос2 = Новый Запрос;      //"+ТипДок+"
	Запрос2.Текст = "ВЫБРАТЬ
	                |";
		Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ОперацияПоОтветственномуХранению") 
			или ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
		Запрос2.Текст = Запрос2.Текст +"ВЫБОР
	                |		КОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.Вес, 0) = 0
	                |			ТОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.Количество, 0) * ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Вес, 0)
	                |		ИНАЧЕ ЕСТЬNULL(РеализацияТоваровУслугТовары.Вес, 0)
	                |	КОНЕЦ КАК Нетто,
	          		| 0 как ОбъемШтук,
	                |	ЕСТЬNULL(РеализацияТоваровУслугТовары.Количество, 0) * ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Вес, 0) КАК Брутто,
	         		| 0 как ОбъемМест,
	                |	Выбор Когда ЕстьNull(РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент,1)=0
					|	Тогда РеализацияТоваровУслугТовары.Количество
					|	Иначе РеализацияТоваровУслугТовары.Количество/ЕстьNull(РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент,1) 
					|	Конец КАК КоличествоМест,
	                |"; 
		Иначе 
		Запрос2.Текст = Запрос2.Текст +"ВЫБОР 
					|	Когда ЕстьNull(РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент,0)=0
						|Тогда (РеализацияТоваровУслугТовары.Количество * РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Вес)
						|Иначе (РеализацияТоваровУслугТовары.Количество/РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент * РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Вес)
					|Конец как Брутто,
				    | 0 как ОбъемШтук,
					| 0 как Нетто,
					| 0 как ОбъемМест,
					| выбор Когда ЕстьNull(РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент,0)=0
					|Тогда (РеализацияТоваровУслугТовары.Количество)
					|Иначе (РеализацияТоваровУслугТовары.Количество/РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент) 
					|Конец  как КоличествоМест,
					|"; 
		КонецЕсли;
	Запрос2.Текст = Запрос2.Текст +"РеализацияТоваровУслугТовары.Количество КАК Количество
	                |ИЗ
	                |	Документ."+ТипДок+".Товары КАК РеализацияТоваровУслугТовары
	                |ГДЕ
	                |	РеализацияТоваровУслугТовары.Ссылка В(&Ссылка)
	                |ИТОГИ
	                |	СУММА(Нетто),
	                |	СУММА(ОбъемШтук),
	                |	СУММА(Брутто),
	                |	СУММА(ОбъемМест),
	                |	СУММА(Количество),
	                |	СУММА(КоличествоМест)
	                |ПО
	                |	ОБЩИЕ";
				   
				   
//"+ТипДок+"	
Если ЭтотОбъект.Реализации.Количество()>0 Тогда
	СписокДок = ЭтотОбъект.Реализации.ВыгрузитьКолонку("Реализация");
Иначе 
	СписокДок = новый массив();
	СписокДок.Добавить(СсылкаНаОбъект); 
КонецЕсли;	
	Запрос2.УстановитьПараметр("Ссылка", СписокДок);
	
	Результат2 = Запрос2.Выполнить();
	Выборка2 = Результат2.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	возврат Выборка2;
	
КонецФункции


//Пункт5_2
функция ПолучитьСуммуДокументов() экспорт
	Сумма = 0;
	//Если ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
	//	типДок = "РеализацияТоваровУслуг";
	//ИначеЕсли ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.ВозвратТоваровПоставщику") Тогда
	//	типДок = "ВозвратТоваровПоставщику";
	//ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ОперацияПоОтветственномуХранению") Тогда
	//	типДок = "ОперацияПоОтветственномуХранению";
	//ИначеЕсли ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
	//	типДок = "ПеремещениеТоваров";
	//Иначе
	//	ТабЗнач = новый ТаблицаЗначений;	
	//	Возврат ТабЗнач;		
	//КонецЕсли;   
	
	списокДок = новый массив;
	Если Реализации.Количество()>0 Тогда
		списокДок = реализации.ВыгрузитьКолонку("Реализация");	
	КонецЕсли;	
	списокДок.Добавить(СсылкаНаОбъект);
	
	//===================================================================
	Если ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.РеализацияТоваровУслуг") 
		или ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.ВозвратТоваровПоставщику")  Тогда
		
		Если ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
			типДок = "РеализацияТоваровУслуг";
		ИначеЕсли ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.ВозвратТоваровПоставщику") Тогда
			типДок = "ВозвратТоваровПоставщику";
		КонецЕсли;
		
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	РеализацияТоваровУслуг.СуммаДокумента КАК СуммаДокумента
	               |ИЗ
	               |	Документ."+ТипДок+" КАК РеализацияТоваровУслуг
	               |ГДЕ
	               |	РеализацияТоваровУслуг.Ссылка В(&списокДок)
	               |ИТОГИ
	               |	СУММА(СуммаДокумента)
	               |ПО
	               |	ОБЩИЕ";
	Запрос.УстановитьПараметр("списокДок", списокДок);
	Результат = Запрос.Выполнить();
	Выборка = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	Выборка.Следующий();
	Сумма = выборка.СуммаДокумента;
	КонецЕсли;

	
	//===================================================================
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
		
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	ЗаказПокупателяТовары.Цена * ПеремещениеТоваровТовары.Количество КАК СуммаДокумента,
	               |	ПеремещениеТоваровТовары.Номенклатура КАК Номенклатура
	               |ИЗ
	               |	Документ.ПеремещениеТоваров.Товары КАК ПеремещениеТоваровТовары
	               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
	               |		ПО ПеремещениеТоваровТовары.Номенклатура = ЗаказПокупателяТовары.Номенклатура
	               |			И ПеремещениеТоваровТовары.ХарактеристикаНоменклатуры = ЗаказПокупателяТовары.ХарактеристикаНоменклатуры
	               |ГДЕ
	               |	ЗаказПокупателяТовары.Ссылка В
	               |			(ВЫБРАТЬ
	               |				ЕСТЬNULL(ПеремещениеТоваров.ВнутреннийЗаказ.ДокументОснование, ""нет"") КАК Заказ
	               |			ИЗ
	               |				Документ.ПеремещениеТоваров КАК ПеремещениеТоваров
	               |			ГДЕ
	               |				ПеремещениеТоваров.Ссылка В (&списокДок))
	               |	И ПеремещениеТоваровТовары.Ссылка В(&СписокДок)
	               |ИТОГИ
	               |	СУММА(СуммаДокумента)
	               |ПО
	               |	ОБЩИЕ";
	Запрос.УстановитьПараметр("списокДок", списокДок);
	попытка
		Результат = Запрос.Выполнить();
		Выборка = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	исключение
		сообщить("Неправильно заполнено поле ""Внутренний заказ"" или ""Документ Основание"" - расчет суммы документов невозможен!", СтатусСообщения.Внимание);
		возврат 0;
	КонецПопытки;;
	
	Выборка.Следующий();
	Сумма = ?(выборка.СуммаДокумента=неопределено, 0, выборка.СуммаДокумента);
	КонецЕсли;
	
	//===================================================================
	Если ТипЗнч(СсылкаНаОбъект) = Тип("ДокументСсылка.ОперацияПоОтветственномуХранению") Тогда
				
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ РАЗЛИЧНЫЕ
	               |	ТоварыНаОтветственномХранении.Стоимость КАК СуммаДокумента,
	               |	ТоварыНаОтветственномХранении.Номенклатура
	               |ИЗ
	               |	РегистрНакопления.ТоварыНаОтветственномХранении КАК ТоварыНаОтветственномХранении
	               |ГДЕ
	               |	ТоварыНаОтветственномХранении.Регистратор В(&списокДок)
	               |ИТОГИ
	               |	СУММА(Стоимость)
	               |ПО
	               |	ОБЩИЕ";
	Запрос.УстановитьПараметр("списокДок", списокДок);
	Результат = Запрос.Выполнить();
	Выборка = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	Выборка.Следующий();
	Сумма = выборка.СуммаДокумента;

	КонецЕсли;
	
	возврат Сумма;
	
КонецФункции


Функция ПолучитьАдресИзКонтактнойИнформации_Лок(Объект, ТипАдреса = "")

	Если ЗначениеНеЗаполнено(ТипАдреса) Тогда
		Возврат "";
	КонецЕсли;

	Если ТипАдреса="Фактический" Тогда
		Начало = "Факт";
		
	ИначеЕсли ТипАдреса="Складской" Тогда
		Начало = "Складской";

	ИначеЕсли ТипАдреса="Регистрации"
		  ИЛИ ТипАдреса="Юридический" Тогда
		Начало = "Юр";
	Иначе
		Возврат "";
	КонецЕсли;
	
	Если ТипЗнч(Объект) = Тип("СправочникСсылка.Организации") Тогда
		Окончание = "организации";
	ИначеЕсли ТипЗнч(Объект) = Тип("СправочникСсылка.Контрагенты") Тогда
		Окончание = "Контрагента";
	КонецЕсли;
	

	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("Объект", Объект);
	Запрос.УстановитьПараметр("Тип"   , Перечисления.ТипыКонтактнойИнформации.Адрес);
	
	Запрос.Текст = "
	|ВЫБРАТЬ
	|	КонтактнаяИнформация.Представление,
	|	КонтактнаяИнформация.Вид
	|ИЗ
	|	РегистрСведений.КонтактнаяИнформация КАК КонтактнаяИнформация
	|ГДЕ
	|	КонтактнаяИнформация.Объект = &Объект И
	|	КонтактнаяИнформация.Тип = &Тип
	|";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если РезультатЗапроса.Пустой() Тогда
		Возврат "";
	Иначе
		Выборка = РезультатЗапроса.Выбрать();
		Пока Выборка.Следующий() Цикл 
			
			Если Выборка.Вид.Наименование = "Складской адрес организации" Тогда 
				Возврат Выборка.Представление;
			КонецЕсли;
			
		КонецЦикла;
	КонецЕсли;

КонецФункции // ПолучитьАдресИзКонтактнойИнформации()


Функция ПолучитьДолжность(Подразделение,ФизЛицо)
рез = "";	
	Запрос = Новый ЗАпрос("Выбрать Период,Должность из РегистрСведений.ОтветственныеЛицаподразделений.Срезпоследних(&Дата,Подразделение=&подразделение и ФизическоеЛицо=&ФЛ) Упорядочить по Период убыв");
	ЗАпрос.УстановитьПараметр("Подразделение",подразделение);
	ЗАпрос.УстановитьПараметр("ФЛ",ФизЛицо);
	ЗАпрос.УстановитьПараметр("Дата",СсылкаНаОбъект.Дата);
	
	Выб = Запрос.Выполнить().Выбрать();
	
	Если Выб.Количество()>0 Тогда 
		Выб.Следующий();
		рез = Выб.должность;
	КонецЕсли;
возврат рез;
КонецФункции

Функция ПолучитьОтветственноеЛицоРуководителя(Подразделение, ОтветственноеЛицоОрг)
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	                      |	ОтветственныеЛицаподразделенийСрезпоследних.ФизическоеЛицо
	                      |ИЗ
	                      |	РегистрСведений.ОтветственныеЛицаПодразделений.СрезПоследних( &Дата,
	                      |			Подразделение = &подразделение
	                      |			И ОтветственноеЛицо = &ОтветственноеЛицоОрг) КАК ОтветственныеЛицаподразделенийСрезпоследних";
	ЗАпрос.УстановитьПараметр("Подразделение",подразделение);
	ЗАпрос.УстановитьПараметр("ОтветственноеЛицоОрг",ОтветственноеЛицоОрг);
	ЗАпрос.УстановитьПараметр("Дата",СсылкаНаОбъект.Дата);
	
	Выб = Запрос.Выполнить().Выбрать();
	
	Если Выб.Количество()>0 Тогда 
		Выб.Следующий();
		Возврат Выб.ФизическоеЛицо;
	КонецЕсли;	
КонецФункции

Процедура ПечатьШтрихКодыДопДокументы(ТабДокумент, Макет)
	
	Обл = Макет.Области.Найти("ДополнительныйШтрихКод");
	
	Если НЕ Обл = Неопределено Тогда
		
		Для Каждого ТекДок Из Реализации Цикл
			Если ЗначениеЗаполнено(ТекДок.Реализация) И ТипЗнч(ТекДок.Реализация) = Тип("ДокументСсылка.ПеремещениеТоваров") И ТекДок.Реализация <> СсылкаНаОбъект Тогда
				ОблШКод = Макет.ПолучитьОбласть("ДополнительныйШтрихКод");
				
				ОбШтрихКод = ОблШКод.Рисунки.ШтрихКодД.Объект;
				ОбШтрихКод.ТипКода         = 4; 
				ОбШтрихКод.Сообщение       = СформироватьШКРеализации(ТекДок.Реализация, "T");  // "T" - английское
				ОбШтрихКод.ОтображатьТекст = Ложь;
				
				ТабДокумент.Вывести(ОблШКод);
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
	
КонецПроцедуры // ПечатьШтрихКодыДопДокументы()


мВалютаРегламентированногоУчета = Константы.ВалютаРегламентированногоУчета.Получить();
//+++ 26.01.2015 - для бухгалтерии - разрешена печать текущей формы ТТН с 01.01.2011 г
//ДатаНачалаТТН_250711 = Дата(2011,07,25);
//ДатаНачалаТТН_13032012 = Дата(2012,03,13);
ДатаНачалаТТН_250711 = Дата(2011,01,01);
ДатаНачалаТТН_13032012 = Дата(2011,01,01);