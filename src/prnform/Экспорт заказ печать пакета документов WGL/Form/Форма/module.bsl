
Процедура КнопкаВыполнитьНажатие(Кнопка)
		
	Если ФлСпецификация И КолСпецификация > 0 Тогда
		//СсылкаСпецификация=НайтиПодчиненныйДокумент(СсылкаНаОбъект, "Спецификация");
		//Если ЗначениеНеЗаполнено(СсылкаСпецификация) Тогда
		//	сообщить("По документу "+СсылкаНаОбъект+" не выписана спецификация");
		//Иначе
			ПечатьДокумента("Экспорт заказ печать спецификации WGL", СсылкаНаОбъект, КолСпецификация, СокрЛП(НомерДокументаШинтрейд));
		//КонецЕсли;
	КонецЕсли;
	
	Если ФлТорг12 И КолТОРГ12 > 0 Тогда
		ПечатьДокумента("ТОРГ-12 (Яршинторг).", СсылкаНаОбъект,КолТОРГ12);
	КонецЕсли;
	
	Если ФлИнвойс И КолИнвойс > 0 Тогда
		 ПечатьДокумента("Экспорт заказ печать коммерческий инвойс WGL", СсылкаНаОбъект,КолИнвойс, СокрЛП(НомерДокументаШинтрейд));
	 КонецЕсли;
	 
	 Если ФлУпаковочныйЛист И КолУпаковочныйЛист > 0 Тогда
		 ПечатьДокумента("Экспорт заказ печать упаковочный лист WGL", СсылкаНаОбъект,КолУпаковочныйЛист, СокрЛП(НомерДокументаШинтрейд));
	 КонецЕсли;
	 
	 Если ФлЦМР И КолЦМР > 0 Тогда
		 
		 ОбработкаПечатьЦМР = Справочники.ДополнительныеПечатныеФормы.НайтиПоНаименованию("Экспорт Печать CMR");
		 Если ОбработкаПечатьЦМР.Пустая() Тогда
			 сообщить("Не найдена внешняя печатная форма Экспорт Печать CMR");
		 Иначе
			 ИмяФайла = КаталогВременныхФайлов()+"PrnForm.tmp";
			 ОбъектВнешнейФормы = ОбработкаПечатьЦМР.ПолучитьОбъект();
			 ДвоичныеДанные = ОбъектВнешнейФормы.ХранилищеВнешнейОбработки.Получить();
			 ДвоичныеДанные.Записать(ИмяФайла);
			 ТекОбработка = ВнешниеОбработки.Создать(ИмяФайла,Ложь);
			 ТекОбработка.СсылкаНаОбъект = СсылкаНаОбъект;
			 ФормаОбработки = ТекОбработка.ПолучитьФорму("Форма");
			 ФормаОбработки.Открыть();
		 КонецЕсли;
		 
	 КонецЕсли;
	
	 Если ФлТТН И КолТТН > 0 Тогда
		 ИмяОбработкиПечатьТТН = "ТТН-2012 (ТН прил.№4, СВ прил.№8)"; 
		 ОбработкаПечатьТТН = Справочники.ДополнительныеПечатныеФормы.НайтиПоНаименованию(ИмяОбработкиПечатьТТН);
		 Если ОбработкаПечатьТТН.Пустая() Тогда
			 сообщить("Не найдена внешняя печатная форма "+ИмяОбработкиПечатьТТН);
		 Иначе
			 ИмяФайла = КаталогВременныхФайлов()+"PrnForm.tmp";
			 ОбъектВнешнейФормы = ОбработкаПечатьТТН.ПолучитьОбъект();
			 ДвоичныеДанные = ОбъектВнешнейФормы.ХранилищеВнешнейОбработки.Получить();
			 ДвоичныеДанные.Записать(ИмяФайла);
			 ТекОбработка = ВнешниеОбработки.Создать(ИмяФайла,Ложь);
			 ТекОбработка.СсылкаНаОбъект = СсылкаНаОбъект;
			 формаОбработкиТТН = ТекОбработка.получитьФорму();
			 формаОбработкиТТН.ЗаполнитьДанныеПоДокументу();
			 Если НаПринтер Тогда
				 ТабДокумент = ТекОбработка.Печать(ложь,"");
				 НапечататьДокумент(ТабДокумент, КолТТН, НаПринтер,  "ТТН(прил.№4) по накладной № "+строка(СсылкаНаОбъект.Номер) );
				 Если ТипЗнч(СсылкаНаОбъект)=Тип("ДокументСсылка.РеализацияТоваровУслуг")
					 И Не ПолучитьЗначениеПоУмолчанию(ПараметрыСеанса.ТекущийПользователь, "УчетТолькоПоПодразделениюПользователя") Тогда
					 формаОбработкиТТН.НапечататьРаспискуИДискиПоКрышкам();
				 КонецЕсли;
			 Иначе
				ТабДокумент = ТекОбработка.Печать(истина,""); 
			 КонецЕсли;
		 КонецЕсли;
	 КонецЕсли;
	
	 Если ФлЗаявкаНаЭкспертизу И КолЗаявкаНаЭкспертизу > 0 Тогда
		 ПечатьДокумента("Экспорт Печать Заявка на экспертизу", СсылкаНаОбъект,КолЗаявкаНаЭкспертизу, СокрЛП(НомерДокументаШинтрейд));
	 КонецЕсли;
	
	Если ФлСертификаты Тогда
		ПечатьДокумента("Сертификаты (для дисков)", СсылкаНаОбъект,1);
	КонецЕсли;
 	
КонецПроцедуры

Процедура ПечатьДокумента(НаименованиеФормы, Ссылка, КоличествоЭкземпляров, НомерНаПечать="")
	
	ОбработкаПечати = Справочники.ДополнительныеПечатныеФормы.НайтиПоНаименованию(НаименованиеФормы);
	Если ОбработкаПечати.Пустая() Тогда
		сообщить("Не найдена внешняя печатная форма "+НаименованиеФормы);
	Иначе
		ИмяФайла = КаталогВременныхФайлов()+"PrnForm.tmp";
		ОбъектВнешнейФормы = ОбработкаПечати.ПолучитьОбъект();
		ДвоичныеДанные = ОбъектВнешнейФормы.ХранилищеВнешнейОбработки.Получить();
		ДвоичныеДанные.Записать(ИмяФайла);
		Обработка = ВнешниеОбработки.Создать(ИмяФайла);
		Обработка.СсылкаНаОбъект = Ссылка;
		Если НомерНаПечать = "" Тогда
			ТабДокумент = Обработка.Печать();
		Иначе
			ТабДокумент = Обработка.Печать(НомерНаПечать);
		КонецЕсли;
		НапечататьДокумент(ТабДокумент, КоличествоЭкземпляров, НаПринтер, СформироватьЗаголовокДокумента(СсылкаНаОбъект));
	КонецЕсли;
	
КонецПроцедуры	

Процедура ПриОткрытии()
	
	Если КолЦМР = 0 Тогда
		КолЦМР = 1;
	Конецесли;
	Если КолТорг12 = 0 Тогда
		КолТорг12 = 1;
	Конецесли;
	Если КолСпецификация = 0 Тогда
		КолСпецификация = 1;
	Конецесли;
	Если КолИнвойс = 0 Тогда
		КолИнвойс = 1;
	Конецесли;
	Если КолУпаковочныйЛист = 0 Тогда
		КолУпаковочныйЛист = 1;
	Конецесли;
	Если КолТТН = 0 Тогда
		КолТТН = 1;
	Конецесли;
	Если КолЗаявкаНаЭкспертизу = 0 Тогда
		КолЗаявкаНаЭкспертизу = 1;
	Конецесли;
    ЗаполнитьНомерДокумента();
	
КонецПроцедуры

Процедура ЗаполнитьНомерДокумента()
	//НомерДокументаШинтрейд = СтрЗаменить(Строка(СсылкаНаОбъект.НомерФормулаАвто), Символы.НПП,"");	
КонецПроцедуры	


Процедура СсылкаНаОбъектПриИзменении(Элемент)
	ЗаполнитьНомерДокумента();
КонецПроцедуры

