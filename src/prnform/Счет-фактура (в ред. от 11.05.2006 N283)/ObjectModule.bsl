ФУНКЦИЯ Печать() ЭКСПОРТ
	ОчиститьСообщения();
	
	Если СсылкаНаОбъект.Товары.Количество()=0 Тогда
		Сообщить(нстр("ru=""Нет товаров для печати!"";
					  |en=""No goods for printing!""") );
		Возврат неопределено;
	КонецЕсли;	
	
	Если СсылкаНаОбъект.Ссылка.Пустая() Тогда
		Сообщить(нстр("ru=""Для печати необходимо предварительно записать Документ!"";
					  |en=""For the printing it is necessary to write down the Document previously!""") );
		Возврат неопределено;
	КонецЕсли;		
	
	ТабДок = ПечатьСпецификации();
	
	возврат ТабДок;
   
КонецФункции



Функция ПечатьСпецификации(МассивЗаказов=неопределено)
	
//	СсылкаНаОбъект = Объект.ссылка;
	
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ЗаказПоставщику_Спецификация";
	
	Макет = ПолучитьМакет("Спецификация_печать");
	
	ОбластьЗаголовок    = Макет.ПолучитьОбласть("Заголовок");
	ОбластьШапка        = Макет.ПолучитьОбласть("Шапка");
	ОбластьСтрокаМодели = Макет.ПолучитьОбласть("СтрокаМодели");
	ОбластьСтрока       = Макет.ПолучитьОбласть("Строка");
	ОбластьИтог         = Макет.ПолучитьОбласть("Итог");
	ОбластьПодвал       = Макет.ПолучитьОбласть("Подвал");
	
	//Заголовок
	ОбластьЗаголовок.Параметры.Контрагент        = СсылкаНаОбъект.Контрагент.НаименованиеПолное;
	ОбластьЗаголовок.Параметры.НомерСпецификации = "2014-1-"+Строка(Число(Прав(СсылкаНаОбъект.Номер,6)));
	
	//СокрЛП(Объект.ДополнительныеПоля[13].ЗначениеПоля);
	ОбластьЗаголовок.Параметры.НомерКонтракта    = СсылкаНаОбъект.ДоговорКонтрагента.номер+" от "+формат(СсылкаНаОбъект.ДоговорКонтрагента.Дата);
	ОбластьЗаголовок.Параметры.Дата              = Формат( ДобавитьМесяц(СсылкаНаОбъект.Дата,-2), "ДФ=dd.MM.yyyy");   // -2 месяца!!!
	
	ТабДокумент.Вывести(ОбластьЗаголовок);
	
	
	//Шапка
	ТабДокумент.Вывести(ОбластьШапка);
	//СтрокаМодели
	
	//Строка	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	ЗаказПоставщикуТовары.Номенклатура.Наименование КАК Наименование,
	               |	ЗаказПоставщикуТовары.Количество,
	               |	ЗаказПоставщикуТовары.Цена,
	               |	ЗаказПоставщикуТовары.Сумма,
	               |	ЗаказПоставщикуТовары.Номенклатура.Производитель КАК Производитель
	               |ИЗ
	               |	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
	               |ГДЕ
	               |	ЗаказПоставщикуТовары.Ссылка В(&СписокЗаказов)
	               |
	               |УПОРЯДОЧИТЬ ПО
	               |	Производитель";
	Если МассивЗаказов=неопределено тогда
		МассивЗаказов2 = новый Массив;
		МассивЗаказов2.Добавить(СсылкаНаОбъект);
		Запрос.УстановитьПараметр("СписокЗаказов", МассивЗаказов2);
	иначе
		Запрос.УстановитьПараметр("СписокЗаказов", МассивЗаказов);
	КонецЕсли;

	ТЗТоваров = Запрос.Выполнить().Выгрузить();
	ТЗТоваров.Свернуть("Наименование, Производитель, Цена", "Количество, Сумма");
	
	ы = 0;
	
	СтрокаСостава = "";
	
	Для Каждого Строка Из ТЗТоваров Цикл
		
		Если ы <> 0 Тогда
			Если ТЗТоваров[ы].Производитель <> ТЗТоваров[ы-1].Производитель Тогда
				Если Строка.Производитель = Справочники.Производители.НайтиПоКоду("65") Тогда //LEGEARTIS
					ОбластьСтрокаМодели.Параметры.Модель = "LEGEARTIS";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("517") Тогда //NZ
		        	ОбластьСтрокаМодели.Параметры.Модель = "NZ";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("100") Тогда //ALCASTA
					ОбластьСтрокаМодели.Параметры.Модель = "ALCASTA";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("597") Тогда //TREBL
					ОбластьСтрокаМодели.Параметры.Модель = "TREBL";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("732") Тогда //ALEKS
					ОбластьСтрокаМодели.Параметры.Модель = "ALEKS";
				КонецЕсли;
				ТабДокумент.Вывести(ОбластьСтрокаМодели);
			
				СтрокаСостава = СтрокаСостава + ", " + ОбластьСтрокаМодели.Параметры.Модель;
			КонецЕсли;
		Иначе
			Если Строка.Производитель = Справочники.Производители.НайтиПоКоду("65") Тогда //LEGEARTIS
				ОбластьСтрокаМодели.Параметры.Модель = "LEGEARTIS";
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("517") Тогда //NZ
				ОбластьСтрокаМодели.Параметры.Модель = "NZ";
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("100") Тогда //ALCASTA
				ОбластьСтрокаМодели.Параметры.Модель = "ALCASTA";
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("597") Тогда //TREBL
				ОбластьСтрокаМодели.Параметры.Модель = "TREBL";
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("732") Тогда //ALEKS
					ОбластьСтрокаМодели.Параметры.Модель = "ALEKS";
			КонецЕсли;	
			
			ТабДокумент.Вывести(ОбластьСтрокаМодели);
			
			СтрокаСостава = ОбластьСтрокаМодели.Параметры.Модель;
		КонецЕсли;
		
		ы = ы + 1;
			
		ОбластьСтрока.Параметры.Модель     = Строка.Наименование;
		ОбластьСтрока.Параметры.Количество = Строка.Количество;
		ОбластьСтрока.Параметры.ШтКомп     = ?(Строка.Производитель = Справочники.Производители.НайтиПоКоду("65"), "Set/комплект", "Piece/Штуки");
	//	ОбластьСтрока.Параметры.Состав     = ?(Строка.Производитель = Справочники.Производители.НайтиПоКоду("65"), "", "1 wheel/диск");
		ОбластьСтрока.Параметры.Цена       = Строка.Цена;
		ОбластьСтрока.Параметры.Стоимость  = Строка.Сумма;
		
		ТабДокумент.Вывести(ОбластьСтрока);
		
	КонецЦикла;
	
	//Итог
	ОбластьИтог.Параметры.ИтогКоличество = ТЗТоваров.Итог("Количество");
	ОбластьИтог.Параметры.ИтогСтоимость = ТЗТоваров.Итог("Сумма");
	ТабДокумент.Вывести(ОбластьИтог);
	
	//Подвал
	ОбластьПодвал.Параметры.СуммаРус = ЧислоПрописью(ТЗТоваров.Итог("Сумма"), "L=ru_RU", "доллар США, доллара США, долларов США, м, цент, цента, центов, м");
	ОбластьПодвал.Параметры.СуммаАнг = ЧислоПрописью(ТЗТоваров.Итог("Сумма"), "L=en_US", "USD, USD, USD, cents, cents, cents, 0");
	Если СсылкаНаОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду("92540") Тогда
		ОбластьПодвал.Параметры.Производитель = "ZHANGZHOU SHUANGSHENG WHEELS CO.,LTD.";
	ИначеЕсли СсылкаНаОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду("91535") Тогда
		ОбластьПодвал.Параметры.Производитель = "Jiangsu Sanhe Aluminium Wheel Manufacturing Co. LTD.";
	Иначе
		ОбластьПодвал.Параметры.Производитель = ?(СокрЛП(СсылкаНаОбъект.Контрагент.ДополнительноеОписание)="", СокрЛП(СсылкаНаОбъект.Контрагент.НаименованиеПолное), СокрЛП(СсылкаНаОбъект.Контрагент.ДополнительноеОписание));	
	КонецЕсли;
	ОбластьПодвал.Параметры.ТорговыеМарки = СтрокаСостава;
	
	КомплектПоставки = "";
	КомплектПоставкиАнг = "";
	
	Если Найти(СтрокаСостава, "LEGEARTIS") Тогда
		КомплектПоставки = КомплектПоставки + "Legeartis: коробка, диск, заглушка со стикером, болты или гайки, количество болтов или гаек указано в упаковочном листе."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "Legeartis: box, cap and sticker, bolts or nuts, quantity of bolts or nuts are indicated in packing list."+Символы.ПС;
	КонецЕсли;
		
	Если Найти(СтрокаСостава, "NZ") Тогда	
		КомплектПоставки = КомплектПоставки + "NZ: коробка, диск, заглушка со стикером."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "NZ: box, cap and sticker."+Символы.ПС;	
	КонецЕсли;
		
	Если Найти(СтрокаСостава, "ALCASTA") Тогда
		КомплектПоставки = КомплектПоставки + "ALCASTA: коробка, диск, заглушка со стикером."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "ALCASTA: box, cap and sticker."+Символы.ПС;
	КонецЕсли;
		
	Если Найти(СтрокаСостава, "TREBL") Тогда
		КомплектПоставки = КомплектПоставки + "TREBL: коробка, диск."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "TREBL: wheel, carton box."+Символы.ПС;
	КонецЕсли;
		
	Если Найти(СтрокаСостава, "ALEKS") Тогда
		КомплектПоставки = КомплектПоставки + "ALEKS: коробка, диск, заглушка со стикером."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "ALEKS: box, cap and sticker."+Символы.ПС;
	КонецЕсли;
	ОбластьПодвал.Параметры.Перенос = Символы.ПС;
	ОбластьПодвал.Параметры.КомплектПоставки    = КомплектПоставки;
	ОбластьПодвал.Параметры.КомплектПоставкиАнг = КомплектПоставкиАнг;
	
	ОбластьПодвал.Параметры.Дата = Формат(СсылкаНаОбъект.Дата, "ДФ=dd.MM.yyyy");
	
	ТабДокумент.Вывести(ОбластьПодвал);
	
//-------------------печати и подписи---------------------------------------
	ОбластьСтрока1 = Макет.ПолучитьОбласть("ПодвалШапка");
	ТабДокумент.Вывести(ОбластьСтрока1);

	Если СокрЛП(СсылкаНаОбъект.Контрагент.Код)="91735" тогда
		ОбластьСтрока1 = Макет.ПолучитьОбласть("ПодвалFREEMAN");
	ИначеЕсли СокрЛП(СсылкаНаОбъект.Контрагент.Код)="91535" тогда
		ОбластьСтрока1 = Макет.ПолучитьОбласть("ПодвалJIANGSU");
	ИначеЕсли СокрЛП(СсылкаНаОбъект.Контрагент.Код) = "92540" Тогда
		ОбластьСтрока1 = Макет.ПолучитьОбласть("ПодвалJIANGSU");
	Иначе
		ОбластьСтрока = Макет.ПолучитьОбласть("Подвал1");
	КонецЕсли;	
	ТабДокумент.Вывести(ОбластьСтрока1);

	
	ТабДокумент.АвтоМасштаб = Истина;
	ТабДокумент.ОтображатьСетку = Ложь;
	
	Возврат ТабДокумент;
	
КонецФункции // ПечатьСпецификации()

