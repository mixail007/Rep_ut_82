<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДисконтнаяКарта</dataPath>
				<field>ДисконтнаяКарта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДоговорКонтрагента</dataPath>
				<field>ДоговорКонтрагента</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДокументОприходования</dataPath>
				<field>ДокументОприходования</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДокументПродажи</dataPath>
				<field>ДокументПродажи</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДоставкаВозмещаемая</dataPath>
				<field>ДоставкаВозмещаемая</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДоставкаВЦене</dataPath>
				<field>ДоставкаВЦене</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Задание</dataPath>
				<field>Задание</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗаказПокупателя</dataPath>
				<field>ЗаказПокупателя</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Направление</dataPath>
				<field>Направление</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Перевозчик</dataPath>
				<field>Перевозчик</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Подразделение</dataPath>
				<field>Подразделение</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Проект</dataPath>
				<field>Проект</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Стоимость</dataPath>
				<field>Стоимость</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Контрагент</dataPath>
				<field>Контрагент</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Менеджер</dataPath>
				<field>Менеджер</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наценка</dataPath>
				<field>Наценка</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	ПродажиОбороты.Номенклатура,
	ПродажиОбороты.ЗаказПокупателя,
	ПродажиОбороты.ДоговорКонтрагента,
	ПродажиОбороты.Подразделение,
	СУММА(ПродажиОбороты.КоличествоОборот) КАК Количество,
	СУММА(ПродажиОбороты.СтоимостьОборот) КАК Стоимость,
	СУММА(ПродажиСебестоимостьОбороты.СтоимостьОборот) КАК Себестоимость
ПОМЕСТИТЬ ВаловаяПрибыль
ИЗ
	РегистрНакопления.Продажи.Обороты(, , Регистратор, ДоговорКонтрагента.ВедениеВзаиморасчетов = ЗНАЧЕНИЕ(Перечисление.ВедениеВзаиморасчетовПоДоговорам.ПоЗаказам)) КАК ПродажиОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПродажиСебестоимость.Обороты(, , Регистратор, ) КАК ПродажиСебестоимостьОбороты
		ПО ПродажиОбороты.Номенклатура = ПродажиСебестоимостьОбороты.Номенклатура
			И ПродажиОбороты.ХарактеристикаНоменклатуры = ПродажиСебестоимостьОбороты.ХарактеристикаНоменклатуры
			И ПродажиОбороты.ЗаказПокупателя = ПродажиСебестоимостьОбороты.ЗаказПокупателя
			И ПродажиОбороты.Подразделение = ПродажиСебестоимостьОбороты.Подразделение
			И ПродажиОбороты.Регистратор = ПродажиСебестоимостьОбороты.Регистратор

СГРУППИРОВАТЬ ПО
	ПродажиОбороты.ДоговорКонтрагента,
	ПродажиОбороты.Подразделение,
	ПродажиОбороты.Номенклатура,
	ПродажиОбороты.ЗаказПокупателя
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СУММА(ЕСТЬNULL(ИнформацияПоПроезду.ДоставкаНал, 0) + ЕСТЬNULL(ИнформацияПоПроезду.ДоставкаБНал, 0)) КАК ДоставкаВозмещаемая,
	СУММА(ЕСТЬNULL(ИнформацияПоПроезду.ДоставкаВЦене, 0)) КАК ДоставкаВЦене,
	ИнформацияПоПроезду.Задание,
	ИнформацияПоПроезду.Задание.Направление,
	ИнформацияПоПроезду.Задание.Перевозчик,
	ИнформацияПоПроезду.Заказ
ПОМЕСТИТЬ ИнфоПоПроезду
ИЗ
	РегистрСведений.ИнформацияПоПроезду КАК ИнформацияПоПроезду
ГДЕ
	ИнформацияПоПроезду.Задание.Дата МЕЖДУ &amp;ДатаН И &amp;ДатаК

СГРУППИРОВАТЬ ПО
	ИнформацияПоПроезду.Задание,
	ИнформацияПоПроезду.Задание.Направление,
	ИнформацияПоПроезду.Задание.Перевозчик,
	ИнформацияПоПроезду.Заказ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВаловаяПрибыль.Номенклатура,
	ЕСТЬNULL(ВаловаяПрибыль.ЗаказПокупателя, ИнфоПоПроезду.Заказ) КАК ЗаказПокупателя,
	ВаловаяПрибыль.ДоговорКонтрагента,
	ВаловаяПрибыль.Подразделение,
	ВаловаяПрибыль.Количество,
	ВаловаяПрибыль.Стоимость,
	ЕСТЬNULL(ВаловаяПрибыль.Стоимость, 0) - ЕСТЬNULL(ВаловаяПрибыль.Себестоимость, 0) КАК Наценка,
	ИнфоПоПроезду.ДоставкаВозмещаемая,
	ИнфоПоПроезду.ДоставкаВЦене,
	ИнфоПоПроезду.Задание,
	ИнфоПоПроезду.ЗаданиеНаправление КАК Направление,
	ИнфоПоПроезду.ЗаданиеПеревозчик КАК Перевозчик,
	ВаловаяПрибыль.ДоговорКонтрагента.Владелец КАК Контрагент,
	ВаловаяПрибыль.ДоговорКонтрагента.ОтветственноеЛицо КАК Менеджер
ИЗ
	ИнфоПоПроезду КАК ИнфоПоПроезду
		ЛЕВОЕ СОЕДИНЕНИЕ ВаловаяПрибыль КАК ВаловаяПрибыль
		ПО (ВаловаяПрибыль.ЗаказПокупателя = ИнфоПоПроезду.Заказ)</query>
		</dataSet>
		<calculatedField>
			<dataPath>Итого</dataPath>
			<expression>0</expression>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Наценка-Транспорт</d4p1:content>
				</d4p1:item>
			</title>
			<appearance>
				<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
					<parameter>Формат</parameter>
					<value xsi:type="xs:string">ЧДЦ=0</value>
				</item>
			</appearance>
		</calculatedField>
		<totalField>
			<dataPath>ДоставкаВозмещаемая</dataPath>
			<expression>Сумма(ДоставкаВозмещаемая)</expression>
		</totalField>
		<totalField>
			<dataPath>ДоставкаВЦене</dataPath>
			<expression>Максимум(ДоставкаВЦене)</expression>
			<group>ЗаказПокупателя</group>
			<group>Контрагент</group>
			<group>Менеджер</group>
		</totalField>
		<totalField>
			<dataPath>Количество</dataPath>
			<expression>Сумма(Количество)</expression>
		</totalField>
		<totalField>
			<dataPath>Стоимость</dataPath>
			<expression>Сумма(Стоимость)</expression>
		</totalField>
		<totalField>
			<dataPath>Наценка</dataPath>
			<expression>Сумма(Наценка)</expression>
		</totalField>
		<totalField>
			<dataPath>ДоставкаВЦене</dataPath>
			<expression>0</expression>
			<group>Номенклатура</group>
		</totalField>
		<totalField>
			<dataPath>ДоставкаВЦене</dataPath>
			<expression>Сумма(ВычислитьВыражениеСГруппировкойМассив("Максимум(ДоставкаВЦене)","ЗаказПокупателя, Контрагент, Менеджер"))</expression>
			<group>Задание</group>
			<group>Направление</group>
			<group>Перевозчик</group>
			<group>ОбщийИтог</group>
		</totalField>
		<totalField>
			<dataPath>Итого</dataPath>
			<expression>Сумма(Наценка)-Максимум(ДоставкаВЦене)</expression>
			<group>ЗаказПокупателя</group>
			<group>Контрагент</group>
			<group>Менеджер</group>
		</totalField>
		<totalField>
			<dataPath>Итого</dataPath>
			<expression>Сумма(ВычислитьВыражениеСГруппировкойМассив("Сумма(Наценка)-Максимум(ДоставкаВЦене)","ЗаказПокупателя, Контрагент, Менеджер"))</expression>
			<group>Задание</group>
			<group>Направление</group>
			<group>Перевозчик</group>
			<group>ОбщийИтог</group>
		</totalField>
		<totalField>
			<dataPath>Итого</dataPath>
			<expression>0</expression>
			<group>Номенклатура</group>
		</totalField>
		<parameter>
			<name>НачалоПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>КонецПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Конец периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>ДатаК</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Дата К</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>ДатаН</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Дата Н</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<selection>
		<item xsi:type="SelectedItemField">
			<field>ДоставкаВЦене</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Количество</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Стоимость</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Наценка</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Итого</field>
		</item>
	</selection>
	<dataParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>НачалоПериода</dcscor:parameter>
			<dcscor:value xsi:type="v8:StandardBeginningDate">
				<v8:variant xsi:type="v8:StandardBeginningDateVariant">Custom</v8:variant>
				<v8:date>2018-06-01T00:00:00</v8:date>
			</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>КонецПериода</dcscor:parameter>
			<dcscor:value xsi:type="v8:StandardBeginningDate">
				<v8:variant xsi:type="v8:StandardBeginningDateVariant">Custom</v8:variant>
				<v8:date>2018-07-31T00:00:00</v8:date>
			</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>ДатаК</dcscor:parameter>
			<dcscor:value xsi:type="v8:StandardBeginningDate">
				<v8:variant xsi:type="v8:StandardBeginningDateVariant">Custom</v8:variant>
				<v8:date>2018-08-31T00:00:00</v8:date>
			</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>ДатаН</dcscor:parameter>
			<dcscor:value xsi:type="v8:StandardBeginningDate">
				<v8:variant xsi:type="v8:StandardBeginningDateVariant">Custom</v8:variant>
				<v8:date>2018-07-01T00:00:00</v8:date>
			</dcscor:value>
		</dcscor:item>
	</dataParameters>
	<outputParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>ВыводитьПараметрыДанных</dcscor:parameter>
			<dcscor:value xsi:type="DataCompositionTextOutputType">DontOutput</dcscor:value>
		</dcscor:item>
	</outputParameters>
	<item xsi:type="StructureItemGroup">
		<groupItems>
			<item xsi:type="GroupItemField">
				<field>Перевозчик</field>
				<groupType>Items</groupType>
				<periodAdditionType>None</periodAdditionType>
				<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
				<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
			</item>
		</groupItems>
		<order>
			<item xsi:type="OrderItemAuto"/>
		</order>
		<selection>
			<item xsi:type="SelectedItemAuto"/>
		</selection>
		<conditionalAppearance>
			<item>
				<selection/>
				<filter>
					<item xsi:type="FilterItemComparison">
						<left xsi:type="dcscor:Field">Итого</left>
						<comparisonType>Less</comparisonType>
						<right xsi:type="xs:decimal">0</right>
					</item>
				</filter>
				<appearance>
					<dcscor:item xsi:type="SettingsParameterValue">
						<dcscor:parameter>ЦветТекста</dcscor:parameter>
						<dcscor:value xsi:type="v8ui:Color">style:SpecialTextColor</dcscor:value>
					</dcscor:item>
				</appearance>
			</item>
		</conditionalAppearance>
		<item xsi:type="StructureItemGroup">
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Задание</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
				<item xsi:type="GroupItemField">
					<field>Направление</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
			<conditionalAppearance>
				<item>
					<selection>
						<item>
							<field>Итого</field>
						</item>
					</selection>
					<filter>
						<item xsi:type="FilterItemComparison">
							<left xsi:type="dcscor:Field">Итого</left>
							<comparisonType>Less</comparisonType>
							<right xsi:type="xs:decimal">0</right>
						</item>
					</filter>
					<appearance>
						<dcscor:item xsi:type="SettingsParameterValue">
							<dcscor:parameter>ЦветТекста</dcscor:parameter>
							<dcscor:value xsi:type="v8ui:Color">style:SpecialTextColor</dcscor:value>
						</dcscor:item>
					</appearance>
				</item>
			</conditionalAppearance>
			<item xsi:type="StructureItemGroup">
				<groupItems>
					<item xsi:type="GroupItemField">
						<field>Менеджер</field>
						<groupType>Items</groupType>
						<periodAdditionType>None</periodAdditionType>
						<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
						<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
					</item>
					<item xsi:type="GroupItemField">
						<field>Контрагент</field>
						<groupType>Items</groupType>
						<periodAdditionType>None</periodAdditionType>
						<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
						<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
					</item>
					<item xsi:type="GroupItemField">
						<field>ЗаказПокупателя</field>
						<groupType>Items</groupType>
						<periodAdditionType>None</periodAdditionType>
						<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
						<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
					</item>
				</groupItems>
				<order>
					<item xsi:type="OrderItemAuto"/>
				</order>
				<selection>
					<item xsi:type="SelectedItemAuto"/>
				</selection>
				<conditionalAppearance>
					<item>
						<selection>
							<item>
								<field>Итого</field>
							</item>
						</selection>
						<filter>
							<item xsi:type="FilterItemComparison">
								<left xsi:type="dcscor:Field">Итого</left>
								<comparisonType>Less</comparisonType>
								<right xsi:type="xs:decimal">0</right>
							</item>
						</filter>
						<appearance>
							<dcscor:item xsi:type="SettingsParameterValue">
								<dcscor:parameter>ЦветТекста</dcscor:parameter>
								<dcscor:value xsi:type="v8ui:Color">style:SpecialTextColor</dcscor:value>
							</dcscor:item>
						</appearance>
					</item>
				</conditionalAppearance>
				<item xsi:type="StructureItemGroup">
					<groupItems>
						<item xsi:type="GroupItemField">
							<field>Номенклатура</field>
							<groupType>Items</groupType>
							<periodAdditionType>None</periodAdditionType>
							<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
							<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
						</item>
					</groupItems>
					<order>
						<item xsi:type="OrderItemAuto"/>
					</order>
					<selection>
						<item xsi:type="SelectedItemAuto"/>
					</selection>
				</item>
			</item>
		</item>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>