<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДоговорКонтрагента</dataPath>
				<field>ДоговорКонтрагента</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗаказПокупателя</dataPath>
				<field>ЗаказПокупателя</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗначениеУсловияАвтоматическойСкидки</dataPath>
				<field>ЗначениеУсловияАвтоматическойСкидки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Качество</dataPath>
				<field>Качество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Свободный остаток</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Подразделение</dataPath>
				<field>Подразделение</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПроцентАвтоматическихСкидок</dataPath>
				<field>ПроцентАвтоматическихСкидок</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПроцентСкидкиНаценки</dataPath>
				<field>ПроцентСкидкиНаценки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Склад</dataPath>
				<field>Склад</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтатусПартии</dataPath>
				<field>СтатусПартии</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>УсловиеАвтоматическойСкидки</dataPath>
				<field>УсловиеАвтоматическойСкидки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Код</dataPath>
				<field>Код</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВПроизводстве</dataPath>
				<field>ВПроизводстве</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВПути</dataPath>
				<field>ВПути</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВЭД</dataPath>
				<field>ВЭД</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗаказПоставщику</dataPath>
				<field>ЗаказПоставщику</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗаказПоставщикуСезонный</dataPath>
				<field>ЗаказПоставщикуСезонный</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЧерныйЛист</dataPath>
				<field>ЧерныйЛист</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоФакт</dataPath>
				<field>КоличествоФакт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цвет</dataPath>
				<field>Цвет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Модель</dataPath>
				<field>Модель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СсылкаНаФото</dataPath>
				<field>СсылкаНаФото</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>PCD</dataPath>
				<field>PCD</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Диаметр</dataPath>
				<field>Диаметр</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДиаметрСтупицы</dataPath>
				<field>ДиаметрСтупицы</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоОтверстий</dataPath>
				<field>КоличествоОтверстий</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Ширина</dataPath>
				<field>Ширина</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Вылет</dataPath>
				<field>Вылет</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	ЗаказыПокупателейОстатки.ЗаказПокупателя.Подразделение КАК Подразделение,
	ЗаказыПокупателейОстатки.Номенклатура,
	СУММА(ЗаказыПокупателейОстатки.КоличествоОстаток) КАК КоличествоОстаток
ПОМЕСТИТЬ заказы
ИЗ
	РегистрНакопления.ЗаказыПокупателей.Остатки(
			,
			ЗаказПокупателя.Проверен
				И Номенклатура В
					(ВЫБРАТЬ
						тз.Номенклатура
					ИЗ
						Регистрсведений.Номенклатураимпорт КАК тз)) КАК ЗаказыПокупателейОстатки

СГРУППИРОВАТЬ ПО
	ЗаказыПокупателейОстатки.Номенклатура,
	ЗаказыПокупателейОстатки.ЗаказПокупателя.Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТоварыНаСкладахОстатки.Номенклатура,
	ВЫБОР
		КОГДА ТоварыНаСкладахОстатки.Склад.Подразделение = ЗНАЧЕНИЕ(Справочник.Подразделения.ПустаяСсылка)
			ТОГДА &amp;Ярославль
		ИНАЧЕ ТоварыНаСкладахОстатки.Склад.Подразделение
	КОНЕЦ КАК Подразделение,
	СУММА(ТоварыНаСкладахОстатки.КоличествоОстаток) КАК КоличествоОстаток
ПОМЕСТИТЬ Склад
ИЗ
	РегистрНакопления.ТоварыНаСкладах.Остатки(
			,
			НЕ Склад.ЗапретитьИспользование
				И Номенклатура В
					(ВЫБРАТЬ
						тз.Номенклатура
					ИЗ
						Регистрсведений.Номенклатураимпорт КАК тз)) КАК ТоварыНаСкладахОстатки

СГРУППИРОВАТЬ ПО
	ТоварыНаСкладахОстатки.Номенклатура,
	ВЫБОР
		КОГДА ТоварыНаСкладахОстатки.Склад.Подразделение = ЗНАЧЕНИЕ(Справочник.Подразделения.ПустаяСсылка)
			ТОГДА &amp;Ярославль
		ИНАЧЕ ТоварыНаСкладахОстатки.Склад.Подразделение
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА А.Подразделение = ЗНАЧЕНИЕ(Справочник.Подразделения.ПустаяСсылка)
			ТОГДА &amp;Ярославль
		ИНАЧЕ А.Подразделение
	КОНЕЦ КАК Подразделение,
	А.Номенклатура,
	А.КоличествоОстаток КАК КоличествоВПути
ПОМЕСТИТЬ втВПути
ИЗ
	(ВЫБРАТЬ
		ЗаказыПоставщикамОстатки.Подразделение КАК Подразделение,
		ЗаказыПоставщикамОстатки.Номенклатура КАК Номенклатура,
		ЗаказыПоставщикамОстатки.КоличествоОстаток КАК КоличествоОстаток
	ИЗ
		РегистрНакопления.ЗаказыПоставщикам.Остатки(
				,
				ВЭД = ЛОЖЬ
					И Номенклатура В
						(ВЫБРАТЬ
							тз.Номенклатура
						ИЗ
							Регистрсведений.Номенклатураимпорт КАК тз)
					И ЗаказПоставщику.ДатаПоступления &gt; &amp;ТекущаяДата) КАК ЗаказыПоставщикамОстатки) КАК А
ГДЕ
	А.КоличествоОстаток &gt; 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА А.Подразделение = ЗНАЧЕНИЕ(Справочник.Подразделения.ПустаяСсылка)
			ТОГДА &amp;Ярославль
		ИНАЧЕ А.Подразделение
	КОНЕЦ КАК Подразделение,
	А.Номенклатура,
	А.КоличествоВПроизводстве
ПОМЕСТИТЬ втВПроизводстве
ИЗ
	(ВЫБРАТЬ
		ЗаказыПоставщикамСезонныеОстатки.Подразделение КАК Подразделение,
		ЗаказыПоставщикамСезонныеОстатки.Номенклатура КАК Номенклатура,
		ЗаказыПоставщикамСезонныеОстатки.КоличествоОстаток КАК КоличествоВПроизводстве
	ИЗ
		РегистрНакопления.ЗаказыПоставщикамСезонные.Остатки(
				,
				ВЭД = ЛОЖЬ
					И Номенклатура В
						(ВЫБРАТЬ
							тз.Номенклатура
						ИЗ
							Регистрсведений.Номенклатураимпорт КАК тз)
					И ЗаказПоставщикуСезонный.ДатаДействияПо &gt; &amp;ТекущаяДата) КАК ЗаказыПоставщикамСезонныеОстатки) КАК А
ГДЕ
	А.КоличествоВПроизводстве &gt; 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Склад.Номенклатура КАК Номенклатура,
	Склад.КоличествоОстаток - ЕСТЬNULL(заказы.КоличествоОстаток, 0) КАК Количество,
	Склад.Подразделение КАК Подразделение,
	0 КАК ВПути,
	0 КАК ВПроизводстве,
	Склад.КоличествоОстаток КАК КоличествоФакт
ПОМЕСТИТЬ вт
ИЗ
	Склад КАК Склад
		ЛЕВОЕ СОЕДИНЕНИЕ заказы КАК заказы
		ПО Склад.Номенклатура = заказы.Номенклатура
			И Склад.Подразделение = заказы.Подразделение

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	втВПути.Номенклатура,
	0,
	втВПути.Подразделение,
	втВПути.КоличествоВПути,
	0,
	0
ИЗ
	втВПути КАК втВПути

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	втВПроизводстве.Номенклатура,
	0,
	втВПроизводстве.Подразделение,
	0,
	втВПроизводстве.КоличествоВПроизводстве,
	0
ИЗ
	втВПроизводстве КАК втВПроизводстве
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	вт.Номенклатура,
	СУММА(вт.Количество) КАК Количество,
	вт.Подразделение,
	СУММА(вт.ВПути) КАК ВПути,
	СУММА(вт.ВПроизводстве) КАК ВПроизводстве,
	вт.Номенклатура.Код КАК Код,
	МАКСИМУМ(ЦеныНоменклатурыСрезПоследних.Цена) КАК Цена,
	НоменклатураИмпорт.ЧерныйЛист,
	СУММА(вт.КоличествоФакт) КАК КоличествоФакт,
	ЗначенияСвойствОбъектов.Значение КАК Цвет,
	вт.Номенклатура.Модель КАК Модель,
	"" КАК СсылкаНаФото,
	вт.Номенклатура.Типоразмер.PCD КАК PCD,
	вт.Номенклатура.Типоразмер.Диаметр КАК Диаметр,
	вт.Номенклатура.Типоразмер.Ширина КАК Ширина,
	вт.Номенклатура.Типоразмер.ДиаметрСтупицы КАК ДиаметрСтупицы,
	вт.Номенклатура.Типоразмер.КоличествоОтверстий КАК КоличествоОтверстий,
	вт.Номенклатура.Типоразмер.Вылет КАК Вылет
ИЗ
	вт КАК вт
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(, ТипЦен.Код = "00008") КАК ЦеныНоменклатурыСрезПоследних
		ПО вт.Номенклатура = ЦеныНоменклатурыСрезПоследних.Номенклатура
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.НоменклатураИмпорт КАК НоменклатураИмпорт
		ПО вт.Номенклатура = НоменклатураИмпорт.Номенклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
		ПО вт.Номенклатура = ЗначенияСвойствОбъектов.Объект
			И (ЗначенияСвойствОбъектов.Свойство.Код = "90166")
ГДЕ
	вт.Номенклатура.ВидТовара = ЗНАЧЕНИЕ(Перечисление.ВидыТоваров.Диски)

СГРУППИРОВАТЬ ПО
	вт.Номенклатура,
	вт.Подразделение,
	вт.Номенклатура.Код,
	НоменклатураИмпорт.ЧерныйЛист,
	ЗначенияСвойствОбъектов.Значение,
	вт.Номенклатура.Модель,
	вт.Номенклатура.Типоразмер.PCD,
	вт.Номенклатура.Типоразмер.Диаметр,
	вт.Номенклатура.Типоразмер.Ширина,
	вт.Номенклатура.Типоразмер.ДиаметрСтупицы,
	вт.Номенклатура.Типоразмер.КоличествоОтверстий,
	вт.Номенклатура.Типоразмер.Вылет
</query>
		</dataSet>
		<calculatedField>
			<dataPath>СсылкаНаФото</dataPath>
			<expression>СоединитьСтроки(ТаблицаЗначений("http://photo.yst.ru/allwheels/",Модель,"_",Цвет,".png"),,"")</expression>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Ссылка на фото</d4p1:content>
				</d4p1:item>
			</title>
		</calculatedField>
		<totalField>
			<dataPath>Количество</dataPath>
			<expression>Сумма(Количество)</expression>
		</totalField>
		<totalField>
			<dataPath>ВПроизводстве</dataPath>
			<expression>Сумма(ВПроизводстве)</expression>
		</totalField>
		<totalField>
			<dataPath>ВПути</dataPath>
			<expression>Сумма(ВПути)</expression>
		</totalField>
		<totalField>
			<dataPath>КоличествоФакт</dataPath>
			<expression>Сумма(КоличествоФакт)</expression>
		</totalField>
		<parameter>
			<name>Период</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Период</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>Ярославль</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Ярославль</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core" xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:CatalogRef.Подразделения</Type>
			</valueType>
			<value xsi:nil="true"/>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>ТекущаяДата</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Текущая дата</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>Date</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
			<expression>ТекущаяДата()</expression>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<selection>
		<item xsi:type="SelectedItemField">
			<field>Подразделение</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Код</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Ширина</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Диаметр</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>КоличествоОтверстий</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>PCD</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Вылет</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>ДиаметрСтупицы</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Номенклатура</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Цена</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>СсылкаНаФото</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>ЧерныйЛист</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>КоличествоФакт</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Количество</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>ВПроизводстве</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>ВПути</field>
		</item>
	</selection>
	<filter>
		<item xsi:type="FilterItemComparison">
			<use>false</use>
			<left xsi:type="dcscor:Field">ЧерныйЛист</left>
			<comparisonType>Equal</comparisonType>
			<right xsi:type="xs:boolean">true</right>
		</item>
	</filter>
	<order>
		<item xsi:type="OrderItemField">
			<field>Подразделение</field>
			<orderType>Asc</orderType>
		</item>
		<item xsi:type="OrderItemField">
			<field>Номенклатура</field>
			<orderType>Asc</orderType>
		</item>
	</order>
	<item xsi:type="StructureItemGroup">
		<groupItems>
			<item xsi:type="GroupItemField">
				<field>Подразделение</field>
				<groupType>Items</groupType>
				<periodAdditionType>None</periodAdditionType>
				<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
				<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
			</item>
		</groupItems>
		<order>
			<item xsi:type="OrderItemAuto"/>
		</order>
		<selection>
			<item xsi:type="SelectedItemAuto"/>
		</selection>
		<item xsi:type="StructureItemGroup">
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
		</item>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>