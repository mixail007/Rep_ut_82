
Процедура КнопкаВыполнитьНажатие(Кнопка)
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Пустая", Справочники.Подразделения.ПустаяСсылка());
	Запрос.Текст = "ВЫБРАТЬ
	               |	А.Номенклатура
	               |ИЗ
	               |	(ВЫБРАТЬ
	               |		НоменклатураИмпорт.Номенклатура КАК Номенклатура,
	               |		ЕСТЬNULL(ТоварыНаСкладахОстатки.КоличествоОстаток, 0) КАК Остаток
	               |	ИЗ
	               |		РегистрСведений.НоменклатураИмпорт КАК НоменклатураИмпорт
	               |			ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(
	               |					,
	               |					НЕ Склад.ЗапретитьИспользование
	               |						И (Склад.Подразделение = &Пустая
	               |							ИЛИ НЕ Склад.Подразделение.ОбособленноеПодразделение)) КАК ТоварыНаСкладахОстатки
	               |			ПО НоменклатураИмпорт.Номенклатура = ТоварыНаСкладахОстатки.Номенклатура) КАК А
	               |ГДЕ
	               |	А.Остаток < 4";
	Результат = Запрос.Выполнить().Выбрать();
	Пока Результат.Следующий() Цикл
		НаборЗаписей = РегистрыСведений.НоменклатураИмпорт.СоздатьНаборЗаписей();
		НаборЗаписей.Отбор.Номенклатура.Установить(Результат.Номенклатура);
		НаборЗаписей.Записать();
		Сообщить(Результат.Номенклатура);
	КонецЦикла;
	
КонецПроцедуры
