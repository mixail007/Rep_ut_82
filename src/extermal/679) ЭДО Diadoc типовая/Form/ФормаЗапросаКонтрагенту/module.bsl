Функция ОтправитьЗапросКонтрагенту(ЯщикОрганизации, выбранныйКонтрагент = "", представлениеВыбранногоКонтрагента="", выбКонтрагентID = "") Экспорт
	ящикДиадокОрганизации = ЯщикОрганизации;
	Контрагент = ВыбранныйКонтрагент;
	КонтрагентID = выбКонтрагентID;
	//КомментарийПоОтправителю = "Запрос будет отправлен от организации:
	//|" + ЯщикДиадокОрганизации.Name;
	КонтрагентВДиадокеПредставление = представлениеВыбранногоКонтрагента;
	//комментарий = восстановитьЗначение("КомментарийПриглашенияКонтрагентаДиадок");
	
	Возврат ОткрытьМодально();
КонецФункции

Процедура КнопкаВыполнитьНажатие(Кнопка)
	Если ПустаяСтрока(Контрагент) Тогда
		Предупреждение("Выберите контрагента.",, НаименованиеСистемы);
		Возврат;
	КонецЕсли;
	
	//Если ПустаяСтрока(Комментарий) Тогда
	//	Предупреждение("Заполните комментарий",, НаименованиеСистемы);
	//	Возврат;
	//КонецЕсли;
	
	попытка 
		контрагентДД = ящикДиадокОрганизации.GetCounteragentById(КонтрагентID);
		контрагентДД.AcquireCounteragent("");
	Исключение 
		ПолучитьМодульПрог("Модуль_Логика_ПоведениеФорм").СообщениеОбОшибкеДиадок(ОписаниеОшибки());
		Возврат;
	КонецПопытки;	
	ПолучитьМодульПрог("Модуль_Данные1С_СвязиОбъектов").Установить_CounteragentBoxID_для_Контрагент(Контрагент, КонтрагентID, ящикДиадокОрганизации.Id);
	ОдинСАдаптер_СвойстваОбъектов_УстановитьЗначениеСвойства(Контрагент, "ДиадокИдентификаторЭДО", ящикДиадокОрганизации.FnsParticipantId);
	//СохранитьЗначение("КомментарийПриглашенияКонтрагентаДиадок", Комментарий);
	Закрыть(Истина);
КонецПроцедуры

Процедура КонтрагентНачалоВыбора(Элемент, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	Контрагент = ПолучитьФорму("ФормаВыбораКонтрагента").ВыбратьКонтрагента(ящикДиадокОрганизации);
	КонтрагентВДиадокеНаименование = "";
	КонтрагентID = "";
	НаименованиеКонтрагента = "";
	Если НЕ Контрагент.Пустая() Тогда
		стКонтрагентДиадок = ПолучитьФорму("ФормаПолученияЯщикаКонтрагентаПоИНН").ВыбратьЯщик(ЯщикДиадокОрганизации, Контрагент);
		Если стКонтрагентДиадок <> Неопределено Тогда
			КонтрагентВДиадокеНаименование = стКонтрагентДиадок.Представление;
			КонтрагентID = стКонтрагентДиадок.ID;
			НаименованиеКонтрагента = стКонтрагентДиадок.Наименование;
		КонецЕсли;
		
		Если КонтрагентID = "" Тогда
			Предупреждение("Не выбран ящик контрагента.",, НаименованиеСистемы);
			Контрагент = Справочники.Контрагенты.ПустаяСсылка();
		КонецЕсли;
	Иначе
		ЯщикаКонтрагента = "";
	КонецЕсли;
	
	КонтрагентВДиадокеПредставление = КонтрагентВДиадокеНаименование;
КонецПроцедуры

Процедура ПриОткрытии()
	КартинкаЗаголовка= ЭДО_БиблиотекаКартинок().КартинкаЗаголовка;
	ЭлементыФормы.КонтрагентВДиадокеНадпись.Заголовок = "Контрагент в "+КраткоеНаименованиеСистемы;
	Если значениеЗаполнено(контрагент) Тогда
		//Этаформа.ТекущийЭлемент = элементыформы.Комментарий;
		Элементыформы.Контрагент.Доступность = Ложь;
	КонецЕсли; 	
КонецПроцедуры
