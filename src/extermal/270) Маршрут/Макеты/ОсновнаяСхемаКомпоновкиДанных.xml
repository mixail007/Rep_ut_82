<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДисконтнаяКарта</dataPath>
				<field>ДисконтнаяКарта</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Дисконтная карта</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДоговорКонтрагента</dataPath>
				<field>ДоговорКонтрагента</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Договор контрагента</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДокументПродажи</dataPath>
				<field>ДокументПродажи</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Документ продажи</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗаказПокупателя</dataPath>
				<field>ЗаказПокупателя</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Заказ покупателя</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоПлан</dataPath>
				<field>КоличествоПлан</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>План</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоФакт</dataPath>
				<field>КоличествоФакт</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Факт</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Контрагент</dataPath>
				<field>Контрагент</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Контрагент</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Номенклатура</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Подразделение</dataPath>
				<field>Подразделение</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Подразделение</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Проект</dataPath>
				<field>Проект</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Проект</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Производитель</dataPath>
				<field>Производитель</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Производитель</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Характеристика номенклатуры</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВыполнениеПлана</dataPath>
				<field>ВыполнениеПлана</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Выполнение плана</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоФактПрошлыйГод</dataPath>
				<field>КоличествоФактПрошлыйГод</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Факт прошлый год</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	ПланПродажДисковПоПроизводителямКонтрагенты.Контрагент,
	СУММА(ПланПродажДисковПоПроизводителямКонтрагенты.Количество) КАК Количество,
	ПланПродажДисковПоПроизводителямКонтрагенты.Производитель
ПОМЕСТИТЬ втПлан
ИЗ
	Документ.ПланПродажДисковПоПроизводителям.Контрагенты КАК ПланПродажДисковПоПроизводителямКонтрагенты
ГДЕ
	ПланПродажДисковПоПроизводителямКонтрагенты.Ссылка.Проведен = ИСТИНА
	И ПланПродажДисковПоПроизводителямКонтрагенты.Ссылка.ДатаНачалаПланирования &lt;= &amp;ДатаКон
	И ПланПродажДисковПоПроизводителямКонтрагенты.Ссылка.ДатаОкончанияПланирования &gt;= &amp;ДатаНач

СГРУППИРОВАТЬ ПО
	ПланПродажДисковПоПроизводителямКонтрагенты.Производитель,
	ПланПродажДисковПоПроизводителямКонтрагенты.Контрагент
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ПродажиОбороты1.Производитель, ПродажиОборотыПрошлыйГод1.Производитель) КАК Производитель,
	ЕСТЬNULL(ПродажиОбороты1.Контрагент, ПродажиОборотыПрошлыйГод1.Контрагент) КАК Контрагент,
	СУММА(ЕСТЬNULL(ПродажиОбороты1.КоличествоФакт, 0)) КАК ПродажиОборот,
	СУММА(ЕСТЬNULL(ПродажиОборотыПрошлыйГод1.КоличествоПрошлыйГод, 0)) КАК ПродажиОборотПрошлыйГод
ПОМЕСТИТЬ втПродажи
ИЗ
	(ВЫБРАТЬ
		ПродажиОбороты.Номенклатура.Производитель КАК Производитель,
		ПродажиОбороты.ДоговорКонтрагента.Владелец КАК Контрагент,
		СУММА(ПродажиОбороты.КоличествоОборот) КАК КоличествоФакт
	ИЗ
		РегистрНакопления.Продажи.Обороты(&amp;ДатаНач, &amp;ДатаКон, , Номенклатура.ВидТовара = ЗНАЧЕНИЕ(Перечисление.ВидыТоваров.Диски)) КАК ПродажиОбороты
	
	СГРУППИРОВАТЬ ПО
		ПродажиОбороты.ДоговорКонтрагента.Владелец,
		ПродажиОбороты.Номенклатура.Производитель) КАК ПродажиОбороты1
		ПОЛНОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ПродажиОбороты.Номенклатура.Производитель КАК Производитель,
			ПродажиОбороты.ДоговорКонтрагента.Владелец КАК Контрагент,
			СУММА(ПродажиОбороты.КоличествоОборот) КАК КоличествоПрошлыйГод
		ИЗ
			РегистрНакопления.Продажи.Обороты(ДОБАВИТЬКДАТЕ(&amp;ДатаНач, ГОД, -1), ДОБАВИТЬКДАТЕ(&amp;ДатаКон, ГОД, -1), , Номенклатура.ВидТовара = ЗНАЧЕНИЕ(Перечисление.ВидыТоваров.Диски)) КАК ПродажиОбороты
		
		СГРУППИРОВАТЬ ПО
			ПродажиОбороты.ДоговорКонтрагента.Владелец,
			ПродажиОбороты.Номенклатура.Производитель) КАК ПродажиОборотыПрошлыйГод1
		ПО ПродажиОбороты1.Производитель = ПродажиОборотыПрошлыйГод1.Производитель
			И ПродажиОбороты1.Контрагент = ПродажиОборотыПрошлыйГод1.Контрагент

СГРУППИРОВАТЬ ПО
	ЕСТЬNULL(ПродажиОбороты1.Производитель, ПродажиОборотыПрошлыйГод1.Производитель),
	ЕСТЬNULL(ПродажиОбороты1.Контрагент, ПродажиОборотыПрошлыйГод1.Контрагент)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	А.КоличествоПлан КАК КоличествоПлан,
	А.КоличествоФакт КАК КоличествоФакт,
	А.КоличествоФактПрошлыйГод КАК КоличествоФактПрошлыйГод,
	А.ВыполнениеПлана КАК ВыполнениеПлана,
	А.Контрагент,
	А.Производитель
ИЗ
	(ВЫБРАТЬ
		ЕСТЬNULL(втПлан.Количество, 0) КАК КоличествоПлан,
		ЕСТЬNULL(втПродажи.ПродажиОборот, 0) КАК КоличествоФакт,
		ЕСТЬNULL(втПродажи.ПродажиОборотПрошлыйГод, 0) КАК КоличествоФактПрошлыйГод,
		ВЫБОР
			КОГДА ЕСТЬNULL(втПлан.Количество, 0) &lt;&gt; 0
				ТОГДА ЕСТЬNULL(втПродажи.ПродажиОборот, 0) / ЕСТЬNULL(втПлан.Количество, 0) * 100
			ИНАЧЕ 0
		КОНЕЦ КАК ВыполнениеПлана,
		ЕСТЬNULL(втПлан.Контрагент, втПродажи.Контрагент) КАК Контрагент,
		ЕСТЬNULL(втПлан.Производитель, втПродажи.Производитель) КАК Производитель
	ИЗ
		втПлан КАК втПлан
			ПОЛНОЕ СОЕДИНЕНИЕ втПродажи КАК втПродажи
			ПО втПлан.Контрагент = втПродажи.Контрагент
				И втПлан.Производитель = втПродажи.Производитель) КАК А</query>
		</dataSet>
		<totalField>
			<dataPath>КоличествоПлан</dataPath>
			<expression>Сумма(КоличествоПлан)</expression>
		</totalField>
		<totalField>
			<dataPath>КоличествоФакт</dataPath>
			<expression>Сумма(КоличествоФакт)</expression>
		</totalField>
		<totalField>
			<dataPath>ВыполнениеПлана</dataPath>
			<expression>ВЫБОР
	КОГДА КоличествоПлан &lt;&gt; 0
		ТОГДА КоличествоФакт / КоличествоПлан * 100
	ИНАЧЕ 0
КОНЕЦ</expression>
		</totalField>
		<totalField>
			<dataPath>КоличествоФактПрошлыйГод</dataPath>
			<expression>Сумма(КоличествоФактПрошлыйГод)</expression>
		</totalField>
		<parameter>
			<name>НачалоПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>КонецПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Конец периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>ДатаНач</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Дата нач</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>Date</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
			<expression>&amp;СтандартныйПериод.ДатаНачала</expression>
		</parameter>
		<parameter>
			<name>ДатаКон</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Дата кон</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>Date</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
			<expression>&amp;СтандартныйПериод.ДатаОкончания</expression>
		</parameter>
		<parameter>
			<name>СтандартныйПериод</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Стандартный период</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">StandardPeriod</Type>
			</valueType>
			<value xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:StandardPeriod">
				<d4p1:variant xsi:type="d4p1:StandardPeriodVariant">Custom</d4p1:variant>
				<d4p1:startDate>2014-02-01T00:00:00</d4p1:startDate>
				<d4p1:endDate>2014-02-28T23:59:59</d4p1:endDate>
			</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<selection>
		<item xsi:type="SelectedItemField">
			<field>Контрагент</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Производитель</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>КоличествоПлан</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>КоличествоФакт</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>ВыполнениеПлана</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>КоличествоФактПрошлыйГод</field>
		</item>
	</selection>
	<dataParameters>
		<dcscor:item>
			<dcscor:parameter>СтандартныйПериод</dcscor:parameter>
			<dcscor:value xsi:type="v8:StandardPeriod">
				<v8:variant xsi:type="v8:StandardPeriodVariant">ThisMonth</v8:variant>
			</dcscor:value>
		</dcscor:item>
	</dataParameters>
	<order>
		<item xsi:type="OrderItemField">
			<field>Контрагент</field>
			<orderType>Asc</orderType>
		</item>
		<item xsi:type="OrderItemField">
			<field>Производитель</field>
			<orderType>Asc</orderType>
		</item>
	</order>
	<conditionalAppearance>
		<item>
			<selection>
				<item>
					<field>КоличествоФакт</field>
				</item>
				<item>
					<field>КоличествоФактПрошлыйГод</field>
				</item>
			</selection>
			<filter>
				<item xsi:type="FilterItemComparison">
					<left xsi:type="dcscor:Field">КоличествоФакт</left>
					<comparisonType>LessOrEqual</comparisonType>
					<right xsi:type="dcscor:Field">КоличествоФактПрошлыйГод</right>
				</item>
			</filter>
			<appearance>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>ЦветФона</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:Color">#FFFF00</dcscor:value>
				</dcscor:item>
			</appearance>
		</item>
	</conditionalAppearance>
	<item xsi:type="StructureItemGroup">
		<groupItems>
			<item xsi:type="GroupItemField">
				<field>Контрагент</field>
				<groupType>Items</groupType>
				<periodAdditionType>None</periodAdditionType>
				<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
				<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
			</item>
		</groupItems>
		<order>
			<item xsi:type="OrderItemAuto"/>
		</order>
		<selection>
			<item xsi:type="SelectedItemAuto"/>
		</selection>
		<item xsi:type="StructureItemGroup">
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Производитель</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
			<conditionalAppearance>
				<item>
					<selection>
						<item>
							<field>Производитель</field>
						</item>
						<item>
							<field>КоличествоФакт</field>
						</item>
						<item>
							<field>КоличествоФактПрошлыйГод</field>
						</item>
					</selection>
					<filter>
						<item xsi:type="FilterItemComparison">
							<left xsi:type="dcscor:Field">КоличествоФакт</left>
							<comparisonType>Less</comparisonType>
							<right xsi:type="dcscor:Field">КоличествоФактПрошлыйГод</right>
						</item>
					</filter>
					<appearance>
						<dcscor:item xsi:type="SettingsParameterValue">
							<dcscor:parameter>ЦветФона</dcscor:parameter>
							<dcscor:value xsi:type="v8ui:Color">#FFFF00</dcscor:value>
						</dcscor:item>
					</appearance>
				</item>
			</conditionalAppearance>
		</item>
	</item>
	<item xsi:type="StructureItemTable">
		<use>false</use>
		<column>
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Производитель</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
		</column>
		<row>
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Контрагент</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
		</row>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>