
Функция ПечатьСпецификации(МассивЗаказов)
	
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ЗаказПоставщику_Спецификация";
	
	Если СсылкаНаОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду("91735") Тогда
		Макет = ПолучитьМакет("Спецификация_FREEMAN");	
	ИначеЕсли СсылкаНаОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду("91535") Тогда
		Макет = ПолучитьМакет("Спецификация_JIANGSU");	
	ИначеЕсли СсылкаНаОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду("93694") Тогда
		Макет = ПолучитьМакет("Спецификация_Zhangzhou");
	ИначеЕсли СсылкаНаОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду("92540") Тогда
		Макет = ПолучитьМакет("Спецификация_FUJIAN");	
	Иначе
		#Если Клиент тогда
			Предупреждение("Нет Печати для "+строка(СсылкаНаОбъект.Контрагент) );	
		#КонецЕсли	
		Макет = ПолучитьМакет("Спецификация_Пустая");	
	КонецЕсли;
	
	ОбластьЗаголовок    = Макет.ПолучитьОбласть("Заголовок");
	ОбластьШапка        = Макет.ПолучитьОбласть("Шапка");
	ОбластьСтрокаМодели = Макет.ПолучитьОбласть("СтрокаМодели");
	ОбластьСтрока       = Макет.ПолучитьОбласть("Строка");
	ОбластьИтог         = Макет.ПолучитьОбласть("Итог");
	ОбластьПодвал       = Макет.ПолучитьОбласть("Подвал");
	
	//Заголовок
	ОбластьЗаголовок.Параметры.Контрагент        = СсылкаНаОбъект.Контрагент.НаименованиеПолное;
	ОбластьЗаголовок.Параметры.НомерСпецификации = "";
	ОбластьЗаголовок.Параметры.НомерКонтракта    = СсылкаНаОбъект.ДоговорКонтрагента.Номер;
	ОбластьЗаголовок.Параметры.ДатаКонтракта     = Формат(СсылкаНаОбъект.ДоговорКонтрагента.Дата, "ДФ=dd.MM.yyyy");
	ОбластьЗаголовок.Параметры.Дата              = Формат(СсылкаНаОбъект.Дата, "ДФ=dd.MM.yyyy");
	
	ТабДокумент.Вывести(ОбластьЗаголовок);
	//Шапка
	ТабДокумент.Вывести(ОбластьШапка);
	//СтрокаМодели
	
	//Строка	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	ЗаказПоставщикуТовары.Номенклатура.Наименование КАК Наименование,
	               |	ЗаказПоставщикуТовары.Количество,
	               |	ЗаказПоставщикуТовары.Цена,
	               |	ЗаказПоставщикуТовары.Сумма,
	               |	ЗаказПоставщикуТовары.Номенклатура.Производитель КАК Производитель
	               |ИЗ
	               |	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
	               |ГДЕ
	               |	ЗаказПоставщикуТовары.Ссылка В(&СписокЗаказов)
	               |
	               |УПОРЯДОЧИТЬ ПО
	               |	Производитель";
				 
	Запрос.УстановитьПараметр("СписокЗаказов", МассивЗаказов);
	
	ТЗТоваров = Запрос.Выполнить().Выгрузить();
	ТЗТоваров.Свернуть("Наименование, Производитель, Цена", "Количество, Сумма");
	
	ы = 0;
	
	СтрокаСостава = "";
	
	Для Каждого Строка Из ТЗТоваров Цикл
		
		Если ы <> 0 Тогда
			Если ТЗТоваров[ы].Производитель <> ТЗТоваров[ы-1].Производитель Тогда
				Если Строка.Производитель = Справочники.Производители.НайтиПоКоду("65") Тогда //LEGEARTIS
					ОбластьСтрокаМодели.Параметры.Модель = "LEGEARTIS";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("517") Тогда //NZ
		        	ОбластьСтрокаМодели.Параметры.Модель = "NZ";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("100") Тогда //ALCASTA
					ОбластьСтрокаМодели.Параметры.Модель = "ALCASTA";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("597") Тогда //TREBL
					ОбластьСтрокаМодели.Параметры.Модель = "TREBL";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("732") Тогда //ALEKS
					ОбластьСтрокаМодели.Параметры.Модель = "ALEKS";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("3293") Тогда //YST
					ОбластьСтрокаМодели.Параметры.Модель = "YST";
				ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("3291") Тогда //YST
					ОбластьСтрокаМодели.Параметры.Модель = "CROSS STREET";
				КонецЕсли;
				ТабДокумент.Вывести(ОбластьСтрокаМодели);
			
				СтрокаСостава = СтрокаСостава + ", " + ОбластьСтрокаМодели.Параметры.Модель;
			КонецЕсли;
		Иначе
			Если Строка.Производитель = Справочники.Производители.НайтиПоКоду("65") Тогда //LEGEARTIS
				ОбластьСтрокаМодели.Параметры.Модель = "LEGEARTIS";
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("517") Тогда //NZ
				ОбластьСтрокаМодели.Параметры.Модель = "NZ";
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("100") Тогда //ALCASTA
				ОбластьСтрокаМодели.Параметры.Модель = "ALCASTA";
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("597") Тогда //TREBL
				ОбластьСтрокаМодели.Параметры.Модель = "TREBL";
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("732") Тогда //ALEKS
				ОбластьСтрокаМодели.Параметры.Модель = "ALEKS";
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("3293") Тогда //YST
				ОбластьСтрокаМодели.Параметры.Модель = "YST";		
			ИначеЕсли Строка.Производитель = Справочники.Производители.НайтиПоКоду("3291") Тогда //YST
				ОбластьСтрокаМодели.Параметры.Модель = "CROSS STREET";
			КонецЕсли;	
			
			ТабДокумент.Вывести(ОбластьСтрокаМодели);
			
			СтрокаСостава = ?(ЗначениеЗаполнено(ОбластьСтрокаМодели.Параметры.Модель), ОбластьСтрокаМодели.Параметры.Модель, "");
		КонецЕсли;
		
		ы = ы + 1;
			
		//МассивНаименования = РазложитьСтрокуВМассивПодстрок(Строка.НаименованиеПолное, " ");
		//МассивPCD = РазложитьСтрокуВМассивПодстрок(МассивНаименования[4], "/");
		//
		//ОбластьСтрока.Параметры.Модель     = МассивНаименования[2];
		//
		//Размер = СтрЗаменить(МассивНаименования[3]+"*"+МассивPCD[0], "R", "");
		//Размер = СтрЗаменить(Размер, ".0", "");
		//
		//ОбластьСтрока.Параметры.Размер     = Размер;
		//ОбластьСтрока.Параметры.Вылет      = СтрЗаменить(МассивНаименования[5], "ET", "");
		//ОбластьСтрока.Параметры.PCD        = МассивPCD[1];
		//ОбластьСтрока.Параметры.CB         = СтрЗаменить(МассивНаименования[6], "d", "");
		//ОбластьСтрока.Параметры.Цвет       = МассивНаименования[7];
		ОбластьСтрока.Параметры.Модель     = Строка.Наименование;
		ОбластьСтрока.Параметры.Количество = Строка.Количество;
		ОбластьСтрока.Параметры.ШтКомп     = ?(Строка.Производитель = Справочники.Производители.НайтиПоКоду("65"), "Set/комплект", "Piece/Штуки");
		ОбластьСтрока.Параметры.Состав     = ?(Строка.Производитель = Справочники.Производители.НайтиПоКоду("65"), "", "1 wheel/диск");
		ОбластьСтрока.Параметры.Цена       = Строка.Цена;
		ОбластьСтрока.Параметры.Стоимость  = Строка.Сумма;
		
		ТабДокумент.Вывести(ОбластьСтрока);
		
	КонецЦикла;
	
	//Итог
	ОбластьИтог.Параметры.ИтогКоличество = ТЗТоваров.Итог("Количество");
	ОбластьИтог.Параметры.ИтогСтоимость = ТЗТоваров.Итог("Сумма");
	ТабДокумент.Вывести(ОбластьИтог);
	
	//Подвал
	ОбластьПодвал.Параметры.СуммаРус = ЧислоПрописью(ТЗТоваров.Итог("Сумма"), "L=ru_RU", "доллар США, доллара США, долларов США, м, цент, цента, центов, м");
	ОбластьПодвал.Параметры.СуммаАнг = ЧислоПрописью(ТЗТоваров.Итог("Сумма"), "L=en_US", "USD, USD, USD, cents, cents, cents, 0");
	Если СсылкаНаОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду("92540") Тогда
		ОбластьПодвал.Параметры.Производитель = "ZHANGZHOU SHUANGSHENG WHEELS CO.,LTD.";
	ИначеЕсли СсылкаНаОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду("91535") Тогда
		ОбластьПодвал.Параметры.Производитель = "Jiangsu Sanhe Aluminium Wheel Manufacturing Co. LTD.";
	Иначе
		ОбластьПодвал.Параметры.Производитель = СсылкаНаОбъект.Контрагент.НаименованиеПолное;	
	КонецЕсли;
	ОбластьПодвал.Параметры.ТорговыеМарки = СтрокаСостава;
	
	КомплектПоставки = "";
	КомплектПоставкиАнг = "";
	
	Если Найти(СтрокаСостава, "LEGEARTIS") Тогда
		КомплектПоставки = КомплектПоставки + "Legeartis: коробка, диск, заглушка со стикером, болты или гайки, количество болтов или гаек указано в упаковочном листе."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "Legeartis: box, cap and sticker, bolts or nuts, quantity of bolts or nuts are indicated in packing list."+Символы.ПС;
	КонецЕсли;
		
	Если Найти(СтрокаСостава, "NZ") Тогда	
		КомплектПоставки = КомплектПоставки + "NZ: коробка, диск, заглушка со стикером."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "NZ: box, cap and sticker."+Символы.ПС;	
	КонецЕсли;
		
	Если Найти(СтрокаСостава, "ALCASTA") Тогда
		КомплектПоставки = КомплектПоставки + "ALCASTA: коробка, диск, заглушка со стикером."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "ALCASTA: box, cap and sticker."+Символы.ПС;
	КонецЕсли;
		
	Если Найти(СтрокаСостава, "TREBL") Тогда
		КомплектПоставки = КомплектПоставки + "TREBL: коробка, диск."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "TREBL: wheel, carton box."+Символы.ПС;
	КонецЕсли;
		
	Если Найти(СтрокаСостава, "ALEKS") Тогда
		КомплектПоставки = КомплектПоставки + "ALEKS: коробка, диск, заглушка со стикером."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "ALEKS: box, cap and sticker."+Символы.ПС;
	КонецЕсли;
	
	Если Найти(СтрокаСостава, "YST") Тогда	
		КомплектПоставки = КомплектПоставки + "YST: коробка, диск, заглушка со стикером."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "YST: box, cap and sticker."+Символы.ПС;	
	КонецЕсли;	
	
	Если Найти(СтрокаСостава, "CROSS STREET") Тогда	
		КомплектПоставки = КомплектПоставки + "CROSS STREET: коробка, диск, заглушка со стикером."+Символы.ПС;		
		КомплектПоставкиАнг = КомплектПоставкиАнг + "CROSS STREET: box, cap and sticker."+Символы.ПС;	
	КонецЕсли;
	
	ОбластьПодвал.Параметры.Перенос = Символы.ПС;
	ОбластьПодвал.Параметры.КомплектПоставки    = КомплектПоставки;
	ОбластьПодвал.Параметры.КомплектПоставкиАнг = КомплектПоставкиАнг;
	
	ТабДокумент.Вывести(ОбластьПодвал);
	
	ТабДокумент.АвтоМасштаб = Истина;
	ТабДокумент.ОтображатьСетку = Ложь;
	
	Возврат ТабДокумент;
	
КонецФункции // ПечатьСпецификации()

//Общая процедура печати
Функция Печать(МассивЗаказов) Экспорт
	
	ТабДокумент = Неопределено;

	ТабДокумент = ПечатьСпецификации(МассивЗаказов);
	
	Возврат ТабДокумент;
	
КонецФункции