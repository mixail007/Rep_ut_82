<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Счет</dataPath>
				<field>Счет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСчет</dataPath>
				<field>КорСчет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто1</dataPath>
				<field>КорСубконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто2</dataPath>
				<field>КорСубконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто3</dataPath>
				<field>КорСубконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто1</dataPath>
				<field>Субконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто2</dataPath>
				<field>Субконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто3</dataPath>
				<field>Субконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Валюта</dataPath>
				<field>Валюта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаКор</dataPath>
				<field>ВалютаКор</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Заказ</dataPath>
				<field>Заказ</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Менеджер</dataPath>
				<field>Менеджер</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НоменклатурнаяГруппа</dataPath>
				<field>НоменклатурнаяГруппа</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Организация</dataPath>
				<field>Организация</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Период</dataPath>
				<field>Период</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПериодПланирования</dataPath>
				<field>ПериодПланирования</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Подразделение</dataPath>
				<field>Подразделение</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтатьяЗатрат</dataPath>
				<field>СтатьяЗатрат</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
					<ignoreNullValues xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтатьяЗатратУпр</dataPath>
				<field>СтатьяЗатратУпр</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>План</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаФакт</dataPath>
				<field>СуммаФакт</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Факт</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПериодПланированияКод</dataPath>
				<field>ПериодПланированияКод</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ХозрасчетныйОбороты.ПериодСекунда, МЕСЯЦ) КАК Период,
	ХозрасчетныйОбороты.Субконто2 КАК СтатьяЗатрат,
	ХозрасчетныйОбороты.СуммаОборот КАК Сумма,
	ХозрасчетныйОбороты.Менеджер,
	ХозрасчетныйОбороты.ПериодПланирования.Код
ПОМЕСТИТЬ План
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(, &amp;ТекущаяДата, Авто, Счет = &amp;Затраты, , ПериодПланирования В (&amp;ПериодПланирования), , ) КАК ХозрасчетныйОбороты
ГДЕ
	НАЧАЛОПЕРИОДА(ХозрасчетныйОбороты.ПериодСекунда, МЕСЯЦ) МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И ВЫБОР
			КОГДА НАЧАЛОПЕРИОДА(ХозрасчетныйОбороты.ПериодСекунда, МЕСЯЦ) &lt; &amp;Отсечка
				ТОГДА ЕСТЬNULL(ХозрасчетныйОбороты.ПериодПланирования.Код, "0") &lt;&gt; "000000010"
			ИНАЧЕ ЕСТЬNULL(ХозрасчетныйОбороты.ПериодПланирования.Код, "0") &lt;&gt; "000000003"
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыОбороты.СтатьяЗатрат,
	ЗатратыОбороты.СтатьяЗатрат.Ответственный КАК Менеджер,
	НАЧАЛОПЕРИОДА(ЗатратыОбороты.ПериодМесяц, МЕСЯЦ) КАК Период,
	ЗатратыОбороты.СуммаОборот КАК Сумма
ПОМЕСТИТЬ Факт
ИЗ
	РегистрНакопления.Затраты.Обороты(&amp;НачалоПериода, &amp;КонецПериода, Авто, ) КАК ЗатратыОбороты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(План.Период, Факт.Период) КАК Период,
	ЕСТЬNULL(План.СтатьяЗатрат, Факт.СтатьяЗатрат) КАК СтатьяЗатрат,
	ЕСТЬNULL(План.Менеджер, Факт.Менеджер) КАК Менеджер,
	ВЫБОР
		КОГДА &amp;ТекМомент = ИСТИНА
			ТОГДА ВЫБОР
					КОГДА ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(&amp;ТекДата, МЕСЯЦ), СЕКУНДА, 5) = План.Период
						ТОГДА План.Сумма * РАЗНОСТЬДАТ(План.Период, &amp;ТекДата, ДЕНЬ) / 30
					ИНАЧЕ План.Сумма
				КОНЕЦ
		ИНАЧЕ План.Сумма
	КОНЕЦ КАК Сумма,
	Факт.Сумма КАК СуммаФакт,
	План.ПериодПланированияКод
ИЗ
	План КАК План
		ПОЛНОЕ СОЕДИНЕНИЕ Факт КАК Факт
		ПО План.Период = Факт.Период
			И План.СтатьяЗатрат = Факт.СтатьяЗатрат
			И План.Менеджер = Факт.Менеджер

УПОРЯДОЧИТЬ ПО
	Период,
	СтатьяЗатрат,
	Менеджер</query>
		</dataSet>
		<calculatedField>
			<dataPath>Разница</dataPath>
			<expression>isnull(Сумма,0)-isnull( СуммаФакт,0)</expression>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Разница</d4p1:content>
				</d4p1:item>
			</title>
		</calculatedField>
		<totalField>
			<dataPath>Сумма</dataPath>
			<expression>Сумма(Сумма)</expression>
		</totalField>
		<totalField>
			<dataPath>СуммаФакт</dataPath>
			<expression>Сумма(СуммаФакт)</expression>
		</totalField>
		<totalField>
			<dataPath>Разница</dataPath>
			<expression>Сумма(Разница)</expression>
		</totalField>
		<parameter>
			<name>НачалоПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>КонецПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Конец периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>Затраты</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Затраты</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core" xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:ChartOfAccountsRef.Хозрасчетный</Type>
			</valueType>
			<value xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xsi:type="dcscor:DesignTimeValue">ПланСчетов.Хозрасчетный.ОбщехозяйственныеРасходы</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>Отсечка</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Отсечка</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>Date</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">2017-05-01T00:00:00</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>ПериодПланирования</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Период планирования</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core" xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:CatalogRef.ПериодыПланирования</Type>
			</valueType>
			<useRestriction>false</useRestriction>
			<valueListAllowed>true</valueListAllowed>
		</parameter>
		<parameter>
			<name>ТекДата</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Тек дата</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
			<expression>текущаяДата()</expression>
		</parameter>
		<parameter>
			<name>ТекМомент</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Тек момент</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:boolean</Type>
			</valueType>
			<value xsi:type="xs:boolean">false</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>ТекущаяДата</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Текущая дата</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>Отсечка</dcscor:parameter>
			<dcscor:value xsi:type="xs:dateTime">2017-06-01T00:00:00</dcscor:value>
		</dcscor:item>
	</dataParameters>
	<item xsi:type="StructureItemTable">
		<column>
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Период</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
		</column>
		<column>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto">
					<use>false</use>
				</item>
				<item xsi:type="SelectedItemField">
					<field>Разница</field>
				</item>
			</selection>
		</column>
		<row>
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Менеджер</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
			<item>
				<groupItems>
					<item xsi:type="GroupItemField">
						<field>СтатьяЗатрат</field>
						<groupType>Items</groupType>
						<periodAdditionType>None</periodAdditionType>
						<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
						<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
					</item>
				</groupItems>
				<order>
					<item xsi:type="OrderItemAuto"/>
				</order>
				<selection>
					<item xsi:type="SelectedItemAuto"/>
				</selection>
			</item>
		</row>
		<selection>
			<item xsi:type="SelectedItemField">
				<field>Сумма</field>
			</item>
			<item xsi:type="SelectedItemField">
				<field>СуммаФакт</field>
			</item>
		</selection>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>