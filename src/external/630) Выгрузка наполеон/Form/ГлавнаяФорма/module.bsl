// 
// Copyright (c) 2005 - 2008 "Гильдия разработчиков"
//
// Модуль обмена информацией КПК <-> 1C
//
// 

//
// Синхронизация КПК с базой может происходить в любой момент времени.
// Из-за этого для правильной работы синхронизации с КПК, все файлы сначала создаются с 
// временными именами и только по окончанию работы файлы переименовываются.
// 

Процедура ПриемЗаявокНажатие(Элемент)
	ПриемЗаявок();
КонецПроцедуры

Процедура ВыгрузкаОстатковНажатие(Элемент)
	ВыгрузкаОстатков();	
КонецПроцедуры

Процедура ВыгрузкаНакладныхНажатие(Элемент)
	ВыгрузкаДолгов();	
КонецПроцедуры

Процедура ПапкаОбменаНачалоВыбора(Элемент, СтандартнаяОбработка)
    СтандартнаяОбработка = Ложь;

	Диалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.ВыборКаталога);    
    Диалог.Заголовок = "Выберите папку обмена";

	Диалог.Каталог = ПапкаОбмена;
    Если Диалог.Выбрать() Тогда
        ПапкаОбмена = Диалог.Каталог;
	КонецЕсли;
КонецПроцедуры

Процедура ПриЗакрытии()
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)	
	
	Настройки();
		
КонецПроцедуры

Процедура СохранитьНастройки() Экспорт
	
	ИмяПапки = "\\IISSERVER\Napoleon_exchange\Настройки\";
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"ИзменятьТипЦены"+".1с", ИзменятьТипЦены);
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"ГлубинаВыгрузкиДолгов"+".1с", ГлубинаВыгрузкиДолгов);
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"ПапкаОбмена"+".1с", ПапкаОбмена);
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"Агенты"+".1с", Агенты.Выгрузить());
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"ВыгружатьКонтрагентов"+".1с", ВыгружатьКонтрагентов);
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"ВыгружатьТовары"+".1с", ВыгружатьТовары);
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"ВыгружатьДолги"+".1с", ВыгружатьДолги);
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"Каталоги"+".1с",  ГруппыНоментклатуры.Выгрузить());
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"ИзменятьТипЦены"+".1с", ИзменятьТипЦены);
	ЗначениеВФайл(ИмяПапки+"Наполеон"+"Регионы"+".1с", регион.Выгрузить());
	
КонецПроцедуры


Процедура ОсновныеДействияФормыДействие(Кнопка)
	СохранитьНастройки();
КонецПроцедуры
	