<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Заказ</dataPath>
				<field>Заказ</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НоменклатурнаяГруппа</dataPath>
				<field>НоменклатурнаяГруппа</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Подразделение</dataPath>
				<field>Подразделение</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтатьяЗатрат</dataPath>
				<field>СтатьяЗатрат</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Менеджер</dataPath>
				<field>Менеджер</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Месяц</dataPath>
				<field>Месяц</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Ответственный</dataPath>
				<field>Ответственный</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>План</dataPath>
				<field>План</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Статья</dataPath>
				<field>Статья</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
					<ignoreNullValues xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Факт</dataPath>
				<field>Факт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Отклонение</dataPath>
				<field>Отклонение</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтатьяЗатратУпр</dataPath>
				<field>СтатьяЗатратУпр</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Счет</dataPath>
				<field>Счет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСчет</dataPath>
				<field>КорСчет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто1</dataPath>
				<field>КорСубконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто2</dataPath>
				<field>КорСубконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КорСубконто3</dataPath>
				<field>КорСубконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто1</dataPath>
				<field>Субконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто2</dataPath>
				<field>Субконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто3</dataPath>
				<field>Субконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Валюта</dataPath>
				<field>Валюта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаКор</dataPath>
				<field>ВалютаКор</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Организация</dataPath>
				<field>Организация</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПериодПланирования</dataPath>
				<field>ПериодПланирования</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(ХозрасчетныйОбороты.ПериодСекунда, МЕСЯЦ) КАК ПериодМесяц,
	ХозрасчетныйОбороты.Субконто2 КАК Статья,
	ХозрасчетныйОбороты.СуммаОборот КАК СуммаМесяцОборот,
	ХозрасчетныйОбороты.Менеджер КАК СтатьяОтветственный,
	ХозрасчетныйОбороты.Субконто1 КАК Подразделение
ПОМЕСТИТЬ Проводки
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(, , Авто, Счет = &amp;Затраты, , ПериодПланирования = &amp;ПериодПланирования, , ) КАК ХозрасчетныйОбороты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ЗатратыОбороты.СтатьяЗатрат.Ответственный, Проводки.СтатьяОтветственный) КАК Ответственный,
	ЕСТЬNULL(ЗатратыОбороты.СтатьяЗатрат, Проводки.Статья) КАК Статья,
	НАЧАЛОПЕРИОДА(ЕСТЬNULL(ЗатратыОбороты.ПериодМесяц, Проводки.ПериодМесяц), МЕСЯЦ) КАК Месяц,
	ЗатратыОбороты.СуммаОборот КАК Факт,
	Проводки.СуммаМесяцОборот КАК План,
	Проводки.СуммаМесяцОборот - ЗатратыОбороты.СуммаОборот КАК Отклонение,
	ВЫБОР
		КОГДА ЕСТЬNULL(ЗатратыОбороты.Подразделение.Родитель, Проводки.Подразделение.Родитель) = &amp;ГоловноеПодразделение
			ТОГДА &amp;ГоловноеПодразделение
		ИНАЧЕ ЕСТЬNULL(ЗатратыОбороты.Подразделение, Проводки.Подразделение)
	КОНЕЦ КАК Подразделение
ИЗ
	РегистрНакопления.Затраты.Обороты(&amp;НачалоПериода, &amp;КонецПериода, Авто, ) КАК ЗатратыОбороты
		ПОЛНОЕ СОЕДИНЕНИЕ Проводки КАК Проводки
		ПО ЗатратыОбороты.СтатьяЗатрат = Проводки.Статья
			И ЗатратыОбороты.Подразделение = Проводки.Подразделение
			И (НАЧАЛОПЕРИОДА(ЗатратыОбороты.ПериодМесяц, МЕСЯЦ) = Проводки.ПериодМесяц)</query>
		</dataSet>
		<totalField>
			<dataPath>План</dataPath>
			<expression>Сумма(План)</expression>
		</totalField>
		<totalField>
			<dataPath>Факт</dataPath>
			<expression>Сумма(Факт)</expression>
		</totalField>
		<totalField>
			<dataPath>Отклонение</dataPath>
			<expression>Сумма(Отклонение)</expression>
		</totalField>
		<parameter>
			<name>НачалоПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>КонецПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Конец периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>ГоловноеПодразделение</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Головное подразделение</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core" xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:CatalogRef.Подразделения</Type>
			</valueType>
			<value xsi:nil="true"/>
			<useRestriction>true</useRestriction>
			<expression>справочники.Подразделения.найтиПокоду("00005")</expression>
		</parameter>
		<parameter>
			<name>Затраты</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Затраты</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core" xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:ChartOfAccountsRef.Хозрасчетный</Type>
			</valueType>
			<value xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xsi:type="dcscor:DesignTimeValue"/>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>ПериодПланирования</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Период планирования</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core" xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:CatalogRef.ПериодыПланирования</Type>
			</valueType>
			<value xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xsi:type="dcscor:DesignTimeValue"/>
			<useRestriction>true</useRestriction>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<selection>
		<item xsi:type="SelectedItemField">
			<field>План</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Факт</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Отклонение</field>
		</item>
	</selection>
	<dataParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>Затраты</dcscor:parameter>
			<dcscor:value xsi:nil="true"/>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>ПериодПланирования</dcscor:parameter>
			<dcscor:value xsi:nil="true"/>
		</dcscor:item>
	</dataParameters>
	<conditionalAppearance>
		<item>
			<selection>
				<item>
					<field>Месяц</field>
				</item>
			</selection>
			<filter/>
			<appearance>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>ДФ='ММММ гггг "г."'</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
			</appearance>
		</item>
		<item>
			<selection>
				<item>
					<field>Отклонение</field>
				</item>
			</selection>
			<filter>
				<item xsi:type="FilterItemComparison">
					<left xsi:type="dcscor:Field">Отклонение</left>
					<comparisonType>Less</comparisonType>
					<right xsi:type="xs:decimal">0</right>
				</item>
			</filter>
			<appearance>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>ЦветТекста</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:Color">style:SpecialTextColor</dcscor:value>
				</dcscor:item>
			</appearance>
		</item>
	</conditionalAppearance>
	<item xsi:type="StructureItemTable">
		<column>
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Месяц</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
		</column>
		<row>
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Ответственный</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
			<item>
				<groupItems>
					<item xsi:type="GroupItemField">
						<field>Подразделение</field>
						<groupType>Items</groupType>
						<periodAdditionType>None</periodAdditionType>
						<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
						<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
					</item>
				</groupItems>
				<order>
					<item xsi:type="OrderItemAuto"/>
				</order>
				<selection>
					<item xsi:type="SelectedItemAuto"/>
				</selection>
				<item>
					<groupItems>
						<item xsi:type="GroupItemField">
							<field>Статья</field>
							<groupType>Items</groupType>
							<periodAdditionType>None</periodAdditionType>
							<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
							<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
						</item>
					</groupItems>
					<order>
						<item xsi:type="OrderItemAuto"/>
					</order>
					<selection>
						<item xsi:type="SelectedItemAuto"/>
					</selection>
				</item>
			</item>
		</row>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>