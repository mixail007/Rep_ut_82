
Процедура ВыгрузитьВTerminalНажатие(Элемент)
	
ВыгрузитьВТерминал();

КонецПроцедуры

Процедура ПриОткрытии()
	Период = КонецДня(ТекущаяДата());


КонецПроцедуры

Процедура ПериодПриИзменении(Элемент)
   ПараметрСКД = КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти("Период");
   ПараметрСКД.Использование = Истина;
   ПараметрСКД.Значение  = КонецДня(Период);
КонецПроцедуры

Процедура ДействияФормыСравнитьСТерминалом(Кнопка)
	ТЗСравнения = ПолучитьДанныеСТерминала();
	ТабДок = ЭлементыФормы.Результат;
	ТабДок.Очистить();
	Макет = ПолучитьМакет("МакетСравнения");
	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
	
	ТабДок.Вывести(ОбластьЗаголовок);

    
    ОбластьШапкаТаблицы = Макет.ПолучитьОбласть("Шапка");
	
	ТабДок.Вывести(ОбластьШапкаТаблицы);
	
	НомерПП = 0;
	ИтогоКоличествоТерминал = 0;
	ИтогоКоличество1С = 0;

	Для каждого СтрТЗ ИЗ ТЗСравнения Цикл	
		НомерПП=НомерПП+1;
		ОбластьСтрокаСтрока = Макет.ПолучитьОбласть("Строка");
		ОбластьСтрокаСтрока.Параметры.Заполнить(СтрТЗ);
		ОбластьСтрокаСтрока.Параметры.НомерПП = НомерПП;
		Если СтрТЗ.Номенклатура = Справочники.Номенклатура.ПустаяСсылка() Тогда
			ОбластьСтрокаСтрока.Параметры.Номенклатура = Справочники.Номенклатура.НайтиПоКоду(СтрТЗ.Код);
		КонецЕсли;
			
 		ТабДок.Вывести(ОбластьСтрокаСтрока);
		ИтогоКоличествоТерминал = ИтогоКоличествоТерминал + СтрТЗ.КоличествоТерминал;
		ИтогоКоличество1С = ИтогоКоличество1С + СтрТЗ.Количество1С;
	КонецЦикла;	
    ОбластьИтогоТаблицы = Макет.ПолучитьОбласть("Итого");
	ОбластьИтогоТаблицы.Параметры.КолвоНесовпадений = НомерПП; 
	ОбластьИтогоТаблицы.Параметры.ИтогоКоличество1С = ИтогоКоличество1С; 
	ОбластьИтогоТаблицы.Параметры.ИтогоКоличествоТерминал = ИтогоКоличествоТерминал; 
    ТабДок.Вывести(ОбластьИтогоТаблицы);

    ЭлементыФормы.Результат.ТолькоПросмотр=Истина;
  
КонецПроцедуры

Процедура ДействияФормыпроверка(Кнопка)
	
	табл = ПодготовитьТабДляВыгрузки();
	
	ТабДокумент = Новый ТабличныйДокумент;
	Построитель = Новый ПостроительОтчета;
	Построитель.ИсточникДанных=Новый ОписаниеИсточникаДанных(табл);       
	Построитель.Вывести(ТабДокумент);
	ТабДокумент.Показать("Пользователи");    
	
КонецПроцедуры
