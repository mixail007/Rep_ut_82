<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДисконтнаяКарта</dataPath>
				<field>ДисконтнаяКарта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДоговорКонтрагента</dataPath>
				<field>ДоговорКонтрагента</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДокументОприходования</dataPath>
				<field>ДокументОприходования</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДокументПродажи</dataPath>
				<field>ДокументПродажи</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗаказПокупателя</dataPath>
				<field>ЗаказПокупателя</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Качество</dataPath>
				<field>Качество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоОстаток</dataPath>
				<field>КоличествоОстаток</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наценка</dataPath>
				<field>Наценка</field>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Оборот</dataPath>
				<field>Оборот</field>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Подразделение</dataPath>
				<field>Подразделение</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Проект</dataPath>
				<field>Проект</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Себестоимость</dataPath>
				<field>Себестоимость</field>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Склад</dataPath>
				<field>Склад</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Код</dataPath>
				<field>Код</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	ТоварыНаСкладахОбороты.Номенклатура,
	ТоварыНаСкладахОбороты.Склад,
	ТоварыНаСкладахОбороты.Регистратор,
	ТоварыНаСкладахОбороты.КоличествоРасход
ПОМЕСТИТЬ ВТ
ИЗ
	РегистрНакопления.ТоварыНаСкладах.Обороты(, , Регистратор, Склад В (&amp;склады)) КАК ТоварыНаСкладахОбороты
ГДЕ
	ТоварыНаСкладахОбороты.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПродажиОбороты.Номенклатура,
	ПродажиОбороты.ДокументПродажи,
	СУММА(ПродажиОбороты.СтоимостьОборот) КАК Стоимость,
	СУММА(ПродажиОбороты.КоличествоОборот) КАК Количество,
	СУММА(ПродажиОбороты.СтоимостьОборот - ПродажиСебестоимостьОбороты.СтоимостьОборот) КАК Наценка,
	СУММА(ПродажиСебестоимостьОбороты.СтоимостьОборот) КАК Себестоимость
ПОМЕСТИТЬ Продажи
ИЗ
	РегистрНакопления.Продажи.Обороты(
			,
			,
			Регистратор,
			ДокументПродажи В
				(ВЫБРАТЬ РАЗЛИЧНЫЕ
					ВТ.Регистратор
				ИЗ
					ВТ КАК ВТ)) КАК ПродажиОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПродажиСебестоимость.Обороты(, , Регистратор, ) КАК ПродажиСебестоимостьОбороты
		ПО ПродажиОбороты.Регистратор = ПродажиСебестоимостьОбороты.Регистратор
			И ПродажиОбороты.Номенклатура = ПродажиСебестоимостьОбороты.Номенклатура
			И ПродажиОбороты.ЗаказПокупателя = ПродажиСебестоимостьОбороты.ЗаказПокупателя
			И ПродажиОбороты.Подразделение = ПродажиСебестоимостьОбороты.Подразделение

СГРУППИРОВАТЬ ПО
	ПродажиОбороты.Номенклатура,
	ПродажиОбороты.ДокументПродажи
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ.Склад,
	ВТ.Номенклатура,
	ВТ.КоличествоРасход КАК Количество,
	ВЫБОР
		КОГДА Продажи.Количество = 0
			ТОГДА 0
		ИНАЧЕ Продажи.Стоимость / Продажи.Количество * ВТ.КоличествоРасход
	КОНЕЦ КАК Оборот,
	ВЫБОР
		КОГДА Продажи.Количество = 0
			ТОГДА 0
		ИНАЧЕ Продажи.Себестоимость / Продажи.Количество * ВТ.КоличествоРасход
	КОНЕЦ КАК Себестоимость,
	ВЫБОР
		КОГДА Продажи.Количество = 0
			ТОГДА 0
		ИНАЧЕ Продажи.Наценка / Продажи.Количество * ВТ.КоличествоРасход
	КОНЕЦ КАК Наценка
ПОМЕСТИТЬ ПродажиСоСклада
ИЗ
	ВТ КАК ВТ
		ЛЕВОЕ СОЕДИНЕНИЕ Продажи КАК Продажи
		ПО ВТ.Номенклатура = Продажи.Номенклатура
			И ВТ.Регистратор = Продажи.ДокументПродажи
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(ТоварыНаСкладахОстатки.Номенклатура, ПродажиСоСклада.Номенклатура) КАК Номенклатура,
	ТоварыНаСкладахОстатки.КоличествоОстаток,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.Склад, ПродажиСоСклада.Склад) КАК Склад,
	ЕСТЬNULL(ПродажиСоСклада.Количество, 0) КАК Количество,
	ЕСТЬNULL(ПродажиСоСклада.Оборот, 0) КАК Оборот,
	ЕСТЬNULL(ПродажиСоСклада.Себестоимость, 0) КАК Себестоимость,
	ЕСТЬNULL(ПродажиСоСклада.Наценка, 0) КАК Наценка,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.Номенклатура.Код, ПродажиСоСклада.Номенклатура.Код) КАК Код
ИЗ
	РегистрНакопления.ТоварыНаСкладах.Остатки({(&amp;КонецПериода)}, Склад В (&amp;Склады)) КАК ТоварыНаСкладахОстатки
		ПОЛНОЕ СОЕДИНЕНИЕ ПродажиСоСклада КАК ПродажиСоСклада
		ПО ТоварыНаСкладахОстатки.Склад = ПродажиСоСклада.Склад
			И ТоварыНаСкладахОстатки.Номенклатура = ПродажиСоСклада.Номенклатура</query>
		</dataSet>
		<totalField>
			<dataPath>Количество</dataPath>
			<expression>Сумма(Количество)</expression>
		</totalField>
		<totalField>
			<dataPath>КоличествоОстаток</dataPath>
			<expression>Сумма(КоличествоОстаток)</expression>
		</totalField>
		<totalField>
			<dataPath>Наценка</dataPath>
			<expression>Сумма(Наценка)</expression>
		</totalField>
		<totalField>
			<dataPath>Оборот</dataPath>
			<expression>Сумма(Оборот)</expression>
		</totalField>
		<totalField>
			<dataPath>Себестоимость</dataPath>
			<expression>Сумма(Себестоимость)</expression>
		</totalField>
		<parameter>
			<name>НачалоПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>КонецПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Конец периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>склады</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Склады</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core" xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:CatalogRef.Склады</Type>
			</valueType>
			<useRestriction>true</useRestriction>
			<valueListAllowed>true</valueListAllowed>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<selection>
		<item xsi:type="SelectedItemField">
			<field>КоличествоОстаток</field>
		</item>
		<item xsi:type="SelectedItemFolder">
			<lwsTitle>
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Продажи </v8:content>
				</v8:item>
			</lwsTitle>
			<item xsi:type="SelectedItemField">
				<field>Количество</field>
			</item>
			<item xsi:type="SelectedItemField">
				<field>Оборот</field>
			</item>
			<item xsi:type="SelectedItemField">
				<field>Себестоимость</field>
			</item>
			<item xsi:type="SelectedItemField">
				<field>Наценка</field>
			</item>
			<placement>Auto</placement>
		</item>
	</selection>
	<item xsi:type="StructureItemGroup">
		<groupItems>
			<item xsi:type="GroupItemField">
				<field>Склад</field>
				<groupType>Items</groupType>
				<periodAdditionType>None</periodAdditionType>
				<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
				<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
			</item>
		</groupItems>
		<order>
			<item xsi:type="OrderItemAuto"/>
		</order>
		<selection>
			<item xsi:type="SelectedItemAuto"/>
		</selection>
		<item xsi:type="StructureItemGroup">
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Код</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
				<item xsi:type="GroupItemField">
					<field>Номенклатура</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
			<outputParameters>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>РасположениеРеквизитов</dcscor:parameter>
					<dcscor:value xsi:type="DataCompositionAttributesPlacement">SpecialPosition</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>АвтоПозицияРесурсов</dcscor:parameter>
					<dcscor:value xsi:type="DataCompositionResourcesAutoPosition">DontUse</dcscor:value>
				</dcscor:item>
			</outputParameters>
		</item>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>