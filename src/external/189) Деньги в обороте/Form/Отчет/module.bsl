
Процедура ДействияФормыОтчетСформировать(Кнопка)
	//{{КОНСТРУКТОР_ВЫХОДНЫХ_ФОРМ_ПРОЦЕДУРА_ВЫЗОВА(Отчет)
	// Данный фрагмент построен конструктором.
	// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!

	ТабДок = ЭлементыФормы.ПолеТабличногоДокумента;
	Отчет(ТабДок);

	//}}КОНСТРУКТОР_ВЫХОДНЫХ_ФОРМ_ПРОЦЕДУРА_ВЫЗОВА
КонецПроцедуры

Процедура Отчет(ТабДок) Экспорт
	
	Макет = ПолучитьМакет("Отчет");
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	А.ВидАктивов,
	|	А.Сумма КАК Сумма
	|ИЗ
	|	(ВЫБРАТЬ
	|		""Деньги в товарных группах"" КАК ВидАктивов,
	|		СУММА(ДТГ.Сумма) КАК Сумма
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ВЫБОР
	|				КОГДА ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток > 0
	|					ТОГДА ""Дебиторка""
	|				ИНАЧЕ ""Кредиторка""
	|			КОНЕЦ КАК Вид,
	|			ВзаиморасчетыСКонтрагентамиОстатки.ДоговорКонтрагента.Владелец КАК Контрагент,
	|			ВзаиморасчетыСКонтрагентамиОстатки.ДоговорКонтрагента КАК ДоговорКонтрагента,
	|			ВзаиморасчетыСКонтрагентамиОстатки.Сделка КАК Сделка,
	|			Заказы.Номенклатура КАК Номенклатура,
	|			ВЫБОР
	|				КОГДА ЕСТЬNULL(Заказы.СуммаДокумента, 0) = 0
	|					ТОГДА 0
	|				ИНАЧЕ ВЫБОР
	|						КОГДА ВзаиморасчетыСКонтрагентамиОстатки.Сделка.СуммаВключаетНДС
	|							ТОГДА ВЫРАЗИТЬ(Заказы.Сумма / Заказы.СуммаДокумента * ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток КАК ЧИСЛО(15, 2))
	|						ИНАЧЕ ВЫРАЗИТЬ((Заказы.Сумма + Заказы.СуммаНДС) / Заказы.СуммаДокумента * ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток КАК ЧИСЛО(15, 2))
	|					КОНЕЦ
	|			КОНЕЦ КАК Сумма
	|		ИЗ
	|			РегистрНакопления.ВзаиморасчетыСКонтрагентами.Остатки(&КонДата, ДоговорКонтрагента.ВедениеВзаиморасчетов = &ПоЗаказам) КАК ВзаиморасчетыСКонтрагентамиОстатки
	|				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|					ЗаказПокупателяТовары.Ссылка.ДоговорКонтрагента КАК ДоговорКонтрагента,
	|					ЗаказПокупателяТовары.Ссылка КАК Сделка,
	|					ЗаказПокупателяТовары.Номенклатура КАК Номенклатура,
	|					ЗаказПокупателяТовары.Сумма КАК Сумма,
	|					ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС,
	|					ЗаказПокупателяТовары.Ссылка.СуммаДокумента КАК СуммаДокумента
	|				ИЗ
	|					Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
	|				
	|				ОБЪЕДИНИТЬ
	|				
	|				ВЫБРАТЬ
	|					ЗаказПоставщикуТовары.Ссылка.ДоговорКонтрагента,
	|					ЗаказПоставщикуТовары.Ссылка,
	|					ЗаказПоставщикуТовары.Номенклатура,
	|					ЗаказПоставщикуТовары.Сумма,
	|					ЗаказПоставщикуТовары.СуммаНДС,
	|					ЗаказПоставщикуТовары.Ссылка.СуммаДокумента
	|				ИЗ
	|					Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары) КАК Заказы
	|				ПО ВзаиморасчетыСКонтрагентамиОстатки.ДоговорКонтрагента = Заказы.ДоговорКонтрагента
	|					И ВзаиморасчетыСКонтрагентамиОстатки.Сделка = Заказы.Сделка
	|		ГДЕ
	|			Заказы.СуммаДокумента > 0
	|		
	|		ОБЪЕДИНИТЬ
	|		
	|		ВЫБРАТЬ
	|			""Склад"",
	|			"""",
	|			"""",
	|			"""",
	|			ПартииТоваровНаСкладахОстатки.Номенклатура,
	|			ПартииТоваровНаСкладахОстатки.СтоимостьОстаток
	|		ИЗ
	|			РегистрНакопления.ПартииТоваровНаСкладах.Остатки(&КонДата, ) КАК ПартииТоваровНаСкладахОстатки) КАК ДТГ
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		""Денежные средства"",
	|		ДенежныеСредства.СуммаУпрОстаток
	|	ИЗ
	|		РегистрНакопления.ДенежныеСредства.Остатки(&КонДата, ) КАК ДенежныеСредства
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		""Прочие взаиморасчеты"",
	|		ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток
	|	ИЗ
	|		РегистрНакопления.ВзаиморасчетыСКонтрагентами.Остатки(
	|				&КонДата,
	|				ДоговорКонтрагента.ВедениеВзаиморасчетов <> &ПоЗаказам
	|					И ДоговорКонтрагента.ТипДоговора <> &ТипДоговораИнвестиции
	|					И ДоговорКонтрагента.ТипДоговора <> &ТипДоговораКредиты
	|					И ДоговорКонтрагента.ТипДоговора <> &ТипДоговораПроцентыПоИнвестициям
	|					И ДоговорКонтрагента.ТипДоговора <> &ТипДоговораПроцентыПоКредитам) КАК ВзаиморасчетыСКонтрагентамиОстатки) КАК А
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";

	Запрос.Текст="ВЫБРАТЬ
|"" Обмен по ТГ"" Вид,
|НоменклатурнаяГруппа,
|Производитель,
|"""" Контрагент,	
|"""" ДоговорКонтрагента,
|"""" Сделка,
|Сумма Сумма
| ПОМЕСТИТЬ ВТ_ОбменМеждуТГ
|ИЗ
|(ВЫБРАТЬ
|НоменклатурнаяГруппаПриход НоменклатурнаяГруппа,
|ПроизводительПриход Производитель,
|СУММА(СуммаДокумента) Сумма
|ИЗ 	Документ.ВзаимозачетНоменклатурныеГруппы 
|ГДЕ	Проведен 
|И ВидОперации=Значение(Перечисление.ВидОбменаМеждуТоварнымиГруппами.ОбменТоварами)
|И  ДатаНачала<=&КонДата И 
|(ДатаОкончания=ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) ИЛИ ДатаОкончания>=&КонДата)
| СГРУППИРОВАТЬ ПО НоменклатурнаяГруппаПриход,ПроизводительПриход
|ОБЪЕДИНИТЬ
|ВЫБРАТЬ
|НоменклатурнаяГруппаРасход НоменклатурнаяГруппа,
|ПроизводительРасход Производитель,
|-СУММА(СуммаДокумента) Сумма
|ИЗ 	Документ.ВзаимозачетНоменклатурныеГруппы 
|ГДЕ	Проведен 
|И ВидОперации=Значение(Перечисление.ВидОбменаМеждуТоварнымиГруппами.ОбменТоварами)
|И  ДатаНачала<=&КонДата И 
|(ДатаОкончания=ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) ИЛИ ДатаОкончания>=&КонДата)
|СГРУППИРОВАТЬ ПО НоменклатурнаяГруппаРасход,ПроизводительРасход ) А
|
| ;
|
| ВЫБРАТЬ ВидАктивов, Сумма  ИЗ
|(ВЫБРАТЬ
|""1. Деньги в товарных группах"" КАК ВидАктивов,
|СУММА(Сумма) Сумма
|ИЗ
|(ВЫБРАТЬ 
|ДТГ.Вид,
|ДТГ.Номенклатура.НоменклатурнаяГруппа НоменклатурнаяГруппа,
|ДТГ.Номенклатура.Производитель Производитель,
|Контрагент,
|ДоговорКонтрагента,
|Сделка,
|СУММА(Сумма) Сумма
|ИЗ
|(ВЫБРАТЬ
|ВЫБОР КОГДА ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток>0 ТОГДА
|	 ""Дебиторка""
|ИНАЧЕ
|	 ""Кредиторка""
|КОНЕЦ
|Вид,
|	ВзаиморасчетыСКонтрагентамиОстатки.ДоговорКонтрагента.Владелец КАК Контрагент,
|	ВзаиморасчетыСКонтрагентамиОстатки.ДоговорКонтрагента КАК ДоговорКонтрагента,
|	ВзаиморасчетыСКонтрагентамиОстатки.Сделка КАК Сделка,
|	Заказы.Номенклатура Номенклатура,
|//ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток КАК СуммаУпрОстаток,
|   ВЫБОР КОГДА ЕстьNULL(Заказы.СуммаДокумента,0)=0 ТОГДА 0
|   ИНАЧЕ
|   ВЫБОР КОГДА ВзаиморасчетыСКонтрагентамиОстатки.Сделка.СуммаВключаетНДС Тогда
|	 ВЫРАЗИТЬ (Заказы.Сумма/Заказы.Сделка.СуммаДокумента*ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток КАК ЧИСЛО (15,2))
|   ИНАЧЕ
|	  ВЫРАЗИТЬ ((Заказы.Сумма+Заказы.СуммаНДС)/Заказы.Сделка.СуммаДокумента*ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток КАК ЧИСЛО (15,2))
|   КОНЕЦ 
|КОНЕЦ Сумма
|	//ВЫРАЗИТЬ (Заказы.Сумма/Заказы.СуммаДокумента*ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток КАК ЧИСЛО (15,2)) Сумма
|ИЗ
|	РегистрНакопления.ВзаиморасчетыСКонтрагентами.Остатки( &КонДата
|		, ДоговорКонтрагента.ВедениеВзаиморасчетов = &ПоЗаказам) ВзаиморасчетыСКонтрагентамиОстатки
|ЛЕВОЕ СОЕДИНЕНИЕ		    
|(
| ВЫБРАТЬ ДоговорКОнтрагента, Сделка,Номенклатура, СУММА(Сумма) Сумма, СУММА(СуммаНДС) СуммаНДС, СУММА(СуммаДокумента) СуммаДокумента
| ИЗ
|(ВЫБРАТЬ
|	ЗаказПокупателяТовары.Ссылка.ДоговорКонтрагента ДоговорКонтрагента,
|	ЗаказПокупателяТовары.Ссылка Сделка,
|	ЗаказПокупателяТовары.Номенклатура Номенклатура,
|	ЗаказПокупателяТовары.Сумма Сумма,
|	ЗаказПокупателяТовары.СуммаНДС СуммаНДС,
|	ЗаказПокупателяТовары.Ссылка.СуммаДокумента  СуммаДокумента
|ИЗ
|	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
|ОБЪЕДИНИТЬ ВСЕ
|ВЫБРАТЬ
|	ЗаказПоставщикуТовары.Ссылка.ДоговорКонтрагента ДоговорКонтрагента,
|	ЗаказПоставщикуТовары.Ссылка Сделка,
|	ЗаказПоставщикуТовары.Номенклатура Номенклатура,
|	ЗаказПоставщикуТовары.Сумма Сумма,
|	ЗаказПоставщикуТовары.СуммаНДС СуммаНДС,
|	ЗаказПоставщикуТовары.Ссылка.СуммаДокумента  СуммаДокумента
|ИЗ
|	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары ) А
| СГРУППИРОВАТЬ ПО ДоговорКОнтрагента, Сделка,Номенклатура
|) Заказы
|ПО	ВзаиморасчетыСКонтрагентамиОстатки.ДоговорКонтрагента=Заказы.ДоговорКонтрагента
|И  ВзаиморасчетыСКонтрагентамиОстатки.Сделка= Заказы.Сделка
|//ГДЕ Заказы.СуммаДокумента>0 
|ОБЪЕДИНИТЬ
|ВЫБРАТЬ
|""Склад"" Вид,
|"""" Контрагент,	
|"""" ДоговорКонтрагента,
|"""" Сделка,
|Номенклатура,
|СтоимостьОстаток Сумма
|ИЗ РегистрНакопления.ПартииТоваровНаСкладах.Остатки(&КонДата,) ПартииТоваровНаСкладахОстатки 
|) ДТГ
| СГРУППИРОВАТЬ ПО ДТГ.Вид,
|ДТГ.Номенклатура.НоменклатурнаяГруппа,
|ДТГ.Номенклатура.Производитель,
|Контрагент,
|ДоговорКонтрагента,
|Сделка
|ОБЪЕДИНИТЬ
| ВЫБРАТЬ * ИЗ ВТ_ОбменМеждуТГ
| ОБЪЕДИНИТЬ
| ВЫБРАТЬ 
| ВЫБОР КОГДА Сумма>0 ТОГДА ""Дебиторка"" ИНАЧЕ ""Кредиторка"" КОНЕЦ Вид,
| НоменклатурнаяГруппа, Производитель, Контрагент, ДоговорКонтрагента, Сделка, Сумма
| ИЗ	
|	(ВЫБРАТЬ 
| //  ""Дебиторка"" Вид,
|ВзаиморасчетыУслуги.ДоговорКонтрагента.НоменклатурнаяГруппа НоменклатурнаяГруппа,
|"""" Производитель,
|ВзаиморасчетыУслуги.ДоговорКонтрагента.Владелец Контрагент,
|ВзаиморасчетыУслуги.ДоговорКонтрагента ДоговорКонтрагента,
|"""" Сделка, 
|   СУММА(ВзаиморасчетыУслуги.СуммаУпрОстаток) Сумма ИЗ
|   РегистрНакопления.ВзаиморасчетыСКонтрагентами.Остатки( &КонДата
| , ДоговорКонтрагента.ВедениеВзаиморасчетов <> &ПоЗаказам И
|		ДоговорКонтрагента.НоменклатурнаяГруппа<>&ПустаяНГ) ВзаиморасчетыУслуги
|	СГРУППИРОВАТЬ ПО ВзаиморасчетыУслуги.ДоговорКонтрагента.НоменклатурнаяГруппа,	 
|	ВзаиморасчетыУслуги.ДоговорКонтрагента.Владелец,
|   ВзаиморасчетыУслуги.ДоговорКонтрагента ) ВзаиморасчетыУслуги
|) Б
|	
|	ОБЪЕДИНИТЬ
|	ВЫБРАТЬ
|		""2. Денежные средства"" ВидАктивов,
|		ДенежныеСредства.СуммаУпрОстаток  Сумма
|	ИЗ
|		РегистрНакопления.ДенежныеСредства.Остатки(&КонДата, ) КАК ДенежныеСредства
|	
|	ОБЪЕДИНИТЬ
|	
|	ВЫБРАТЬ
|		""3. Прочие взаиморасчеты"" ВидАктивов,
|		ВзаиморасчетыСКонтрагентамиОстатки.СуммаУпрОстаток  Сумма
|	ИЗ
|		РегистрНакопления.ВзаиморасчетыСКонтрагентами.Остатки(
|				&КонДата,
|				ДоговорКонтрагента.ВедениеВзаиморасчетов <> &ПоЗаказам
|					И ДоговорКонтрагента.ТипДоговора <> &ТипДоговораИнвестиции
|					И ДоговорКонтрагента.ТипДоговора <> &ТипДоговораКредиты
|					И ДоговорКонтрагента.ТипДоговора <> &ТипДоговораПроцентыПоИнвестициям
|					И ДоговорКонтрагента.ТипДоговора <> &ТипДоговораПроцентыПоКредитам 
|					И ДоговорКонтрагента.НоменклатурнаяГруппа=&ПустаяНГ) КАК ВзаиморасчетыСКонтрагентамиОстатки
| ОБЪЕДИНИТЬ
|ВЫБРАТЬ ВидАктивов,
|СУММА(СуммаУпрОстаток) СуммаУпрОстаток
|ИЗ
|( ВЫБРАТЬ
|    ВЫБОР КОГДА СуммаУпрОстаток>0 ТОГДА 
|    ""4. Неразнесенная дебиторка (см. контроль разнесения)""
|    ИНАЧЕ
|    ""5. Неразнесенная кредиторка (см. контроль разнесения)""
|    КОНЕЦ 
|     ВидАктивов,
|	ДоговорКонтрагента,
|	СуммаУпрОстаток
|ИЗ  РегистрНакопления.ВзаиморасчетыСКонтрагентами.Остатки(&КонДата, 
|(ДоговорКонтрагента.ВидДоговора = &СПокупателем
| ИЛИ ДоговорКонтрагента.ВидДоговора = &СПоставщиком) И
|ДоговорКонтрагента.ВедениеВзаиморасчетов = ЗНАЧЕНИЕ(Перечисление.ВедениеВзаиморасчетовПоДоговорам.ПоЗаказам)) 
|ГДЕ Сделка = &ПустаяСделка ) НеразнесенныеДС
|СГРУППИРОВАТЬ ПО ВидАктивов
|) КАК А
|ИТОГИ
|	СУММА(Сумма)
|ПО
|	ОБЩИЕ";
		
	Запрос.УстановитьПараметр("КонДата", НачалоДня(КонецДня(ДатаКон)+1));
	Запрос.УстановитьПараметр("ПоЗаказам", Перечисления.ВедениеВзаиморасчетовПоДоговорам.ПоЗаказам);
	Запрос.УстановитьПараметр("ТипДоговораИнвестиции", Справочники.ТипыДоговоров.Инвестиции);
	Запрос.УстановитьПараметр("ТипДоговораКредиты", Справочники.ТипыДоговоров.Кредит);
	Запрос.УстановитьПараметр("ТипДоговораПроцентыПоИнвестициям", Справочники.ТипыДоговоров.ПроцентыПоИнвестициям);
	Запрос.УстановитьПараметр("ТипДоговораПроцентыПоКредитам", Справочники.ТипыДоговоров.ПроцентыПоКредитам);
	Запрос.УстановитьПараметр("ПустаяНГ", Справочники.НоменклатурныеГруппы.ПустаяСсылка());
	Запрос.УстановитьПараметр("СПокупателем", Перечисления.ВидыДоговоровКонтрагентов.СПокупателем);
	Запрос.УстановитьПараметр("СПоставщиком", Перечисления.ВидыДоговоровКонтрагентов.СПоставщиком);
    Запрос.УстановитьПараметр("ПустаяСделка", Неопределено);
	Результат = Запрос.Выполнить();

	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
	ОбластьЗаголовок.Параметры.ПредставлениеДатыКон=Формат(ДатаКон,"ДФ=dd.MM.yyyy");
	ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
	ОбластьШапкаТаблицы = Макет.ПолучитьОбласть("ШапкаТаблицы");
	ОбластьПодвалТаблицы = Макет.ПолучитьОбласть("ПодвалТаблицы");
	ОбластьОбщийИтог = Макет.ПолучитьОбласть("ОбщиеИтоги");
	ОбластьДетальныхЗаписей = Макет.ПолучитьОбласть("Детали");

	ТабДок.Очистить();
	ТабДок.Вывести(ОбластьЗаголовок);
	ТабДок.Вывести(ОбластьШапкаТаблицы);
	ТабДок.НачатьАвтогруппировкуСтрок();

	ВыборкаОбщийИтог = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);

	ВыборкаОбщийИтог.Следующий();		// Общий итог
	ОбластьОбщийИтог.Параметры.Заполнить(ВыборкаОбщийИтог);
	ТабДок.Вывести(ОбластьОбщийИтог, ВыборкаОбщийИтог.Уровень());

	ВыборкаДетали = ВыборкаОбщийИтог.Выбрать();

	Пока ВыборкаДетали.Следующий() Цикл
		ОбластьДетальныхЗаписей.Параметры.Заполнить(ВыборкаДетали);
		ТабДок.Вывести(ОбластьДетальныхЗаписей, ВыборкаДетали.Уровень());
	КонецЦикла;

	ТабДок.ЗакончитьАвтогруппировкуСтрок();
	ТабДок.Вывести(ОбластьПодвалТаблицы);
	ТабДок.Вывести(ОбластьПодвал);

	//}}КОНСТРУКТОР_ВЫХОДНЫХ_ФОРМ
КонецПроцедуры

Процедура ПолеТабличногоДокументаОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)
	Если Расшифровка="3. Прочие взаиморасчеты" Тогда
		  ОбработкаДЗ = Отчеты.ЗадолженностьПоКонтрагентам.Создать();
		ОбработкаДЗ.ЗаполнитьНачальныеНастройки();
		ОбработкаДЗ.ОбщийОтчет.ДатаКон = ДатаКон;
		ОбработкаДЗ.ПереключательЗадолженность = 3;
		Для Каждого СтрОтб из ОбработкаДЗ.ОбщийОтчет.ПостроительОтчета.Отбор Цикл
			СтрОтб.Использование = Ложь;	
		КонецЦикла;
		СписокТипов = новый СписокЗначений;
		СписокТипов.Добавить(Справочники.ТипыДоговоров.Инвестиции);
		СписокТипов.Добавить(Справочники.ТипыДоговоров.Кредит);
		СписокТипов.Добавить(Справочники.ТипыДоговоров.ПроцентыПоИнвестициям);
		СписокТипов.Добавить(Справочники.ТипыДоговоров.ПроцентыПоКредитам);
		СтрОтб = ОбработкаДЗ.ОбщийОтчет.ПостроительОтчета.Отбор.Добавить("ДоговорКонтрагента.ТипДоговора");
		СтрОтб.ВидСравнения = ВидСравнения.НеВСписке;
		СтрОтб.Значение = СписокТипов;
		СтрОтб.Использование = Истина;	
		СтрОтб = ОбработкаДЗ.ОбщийОтчет.ПостроительОтчета.Отбор.Добавить("ДоговорКонтрагента.ВедениеВзаиморасчетов");
		СтрОтб.ВидСравнения = ВидСравнения.НеРавно;
		СтрОтб.Значение = Перечисления.ВедениеВзаиморасчетовПоДоговорам.ПоЗаказам;
		СтрОтб.Использование = Истина;	
		СтрОтб = ОбработкаДЗ.ОбщийОтчет.ПостроительОтчета.Отбор.Добавить("ДоговорКонтрагента.НоменклатурнаяГруппа");
		СтрОтб.ВидСравнения = ВидСравнения.Равно;
		СтрОтб.Значение = Справочники.НоменклатурныеГруппы.ПустаяСсылка();
		СтрОтб.Использование = Истина;
		ФормаОбработки = ОбработкаДЗ.ПолучитьОсновнуюФорму();
		ФормаОбработки.Открыть();
		ФормаОбработки.ОбновитьОтчет();
		СтандартнаяОбработка = Ложь;
	ИначеЕсли  Расшифровка="2. Денежные средства" Тогда
		// Отчет по ДЗН
		ОбработкаДЗ = Отчеты.ОстаткиДенежныхСредств.Создать();
		ОбработкаДЗ.ЗаполнитьНачальныеНастройки();
		ОбработкаДЗ.ОбщийОтчет.ДатаКон = ДатаКон;
		ФормаОбработки = ОбработкаДЗ.ПолучитьОсновнуюФорму();
		ФормаОбработки.Открыть();
		ФормаОбработки.ОбновитьОтчет();
		СтандартнаяОбработка = Ложь;
	ИначеЕсли Расшифровка="1. Деньги в товарных группах" Тогда
		ЭлементСправочника = Справочники.ВнешниеОбработки.НайтиПоКоду("147");
		ХранилищеВО = ЭлементСправочника.ХранилищеВнешнейОбработки.Получить();
		ИмяФайла = КаталогВременныхФайлов()+"PrnForm.tmp";
		ХранилищеВО.Записать(ИмяФайла);  
		ОбработкаДЗ = ВнешниеОтчеты.Создать(ИмяФайла);
		ФормаОбработки = ОбработкаДЗ.ПолучитьОсновнуюФорму();
		ФормаОбработки.Открыть();
		ОбработкаДЗ.ОбщийОтчет.ДатаКон = ДатаКон;
		ФормаОбработки.ОбновитьОтчет();
		СтандартнаяОбработка = Ложь;
		Возврат;	

	КонецЕсли;	
	
КонецПроцедуры
