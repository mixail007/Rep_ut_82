<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Контрагент</dataPath>
				<field>Контрагент</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Подразделение</dataPath>
				<field>Подразделение</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СезонныйЗаказ</dataPath>
				<field>СезонныйЗаказ</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Аналог</dataPath>
				<field>Аналог</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВРезерве</dataPath>
				<field>ВРезерве</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДисконтнаяКарта</dataPath>
				<field>ДисконтнаяКарта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДоговорКонтрагента</dataPath>
				<field>ДоговорКонтрагента</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДокументПродажи</dataPath>
				<field>ДокументПродажи</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗаказПокупателя</dataPath>
				<field>ЗаказПокупателя</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗаказПокупателяСезонный</dataPath>
				<field>ЗаказПокупателяСезонный</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Проект</dataPath>
				<field>Проект</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЗаказПокупателяРезервный</dataPath>
				<field>ЗаказПокупателяРезервный</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КонтрагентДляРезерваИМ</dataPath>
				<field>КонтрагентДляРезерваИМ</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Покупатель</dataPath>
				<field>Покупатель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РезервСПриходов</dataPath>
				<field>РезервСПриходов</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоВМатрице</dataPath>
				<field>КоличествоВМатрице</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	ЗаказПокупателяСезонныйТовары.Ссылка.Контрагент КАК Контрагент,
	ЗаказПокупателяСезонныйТовары.Ссылка КАК СезонныйЗаказ,
	ЗаказПокупателяСезонныйТовары.Номенклатура,
	ЗаказПокупателяСезонныйТовары.Количество КАК КоличествоВМатрице,
	ЗаказыПокупателейСезонныеОстаткиИОбороты.ЗаказПокупателя КАК ЗаказПокупателяРезервный,
	ЕСТЬNULL(РезервДляИМОбороты.КоличествоПриход, 0) КАК РезервСПриходов,
	ВЫБОР
		КОГДА ЕСТЬNULL(ПродажиОбороты.КоличествоОборот, 0) &gt; ЕСТЬNULL(РезервДляИМОбороты.КоличествоРасход, 0)
			ТОГДА ЕСТЬNULL(РезервДляИМОбороты.КоличествоРасход, 0)
		ИНАЧЕ ЕСТЬNULL(ПродажиОбороты.КоличествоОборот, 0)
	КОНЕЦ КАК Количество,
	ЕСТЬNULL(ПродажиОбороты.СтоимостьОборот, 0) / ЕСТЬNULL(ПродажиОбороты.КоличествоОборот, 1) * ВЫБОР
		КОГДА ЕСТЬNULL(ПродажиОбороты.КоличествоОборот, 0) &gt; ЕСТЬNULL(РезервДляИМОбороты.КоличествоРасход, 0)
			ТОГДА ЕСТЬNULL(РезервДляИМОбороты.КоличествоРасход, 0)
		ИНАЧЕ ЕСТЬNULL(ПродажиОбороты.КоличествоОборот, 0)
	КОНЕЦ КАК Сумма,
	ПродажиОбороты.ДоговорКонтрагента.Владелец КАК Покупатель,
	ПродажиОбороты.ЗаказПокупателя,
	ПродажиОбороты.ДокументПродажи
ИЗ
	Документ.ЗаказПокупателяСезонный.Товары КАК ЗаказПокупателяСезонныйТовары
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ЗаказыПокупателейСезонные.ОстаткиИОбороты(&amp;ДатаНач, &amp;ДатаКон, , , Контрагент = Контрагент.КонтрагентДляРезерваИМ) КАК ЗаказыПокупателейСезонныеОстаткиИОбороты
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РезервДляИМ.Обороты(&amp;ДатаНач, &amp;ДатаКон, Регистратор, ) КАК РезервДляИМОбороты
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.Продажи.Обороты(&amp;ДатаНач, &amp;ДатаКон, , ДоговорКонтрагента.Владелец.КонтрагентДляРезерваИМ &lt;&gt; ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)) КАК ПродажиОбороты
				ПО РезервДляИМОбороты.Регистратор = ПродажиОбороты.ЗаказПокупателя
					И РезервДляИМОбороты.Номенклатура = ПродажиОбороты.Номенклатура
					И РезервДляИМОбороты.КонтрагентДляРезерваИМ = ПродажиОбороты.ДоговорКонтрагента.КонтрагентДляРезерваИМ
			ПО ЗаказыПокупателейСезонныеОстаткиИОбороты.Контрагент = РезервДляИМОбороты.КонтрагентДляРезерваИМ
				И ЗаказыПокупателейСезонныеОстаткиИОбороты.Номенклатура = РезервДляИМОбороты.Номенклатура
		ПО ЗаказПокупателяСезонныйТовары.Ссылка = ЗаказыПокупателейСезонныеОстаткиИОбороты.ЗаказПокупателяСезонный
			И ЗаказПокупателяСезонныйТовары.Номенклатура = ЗаказыПокупателейСезонныеОстаткиИОбороты.Номенклатура
ГДЕ
	ЗаказПокупателяСезонныйТовары.Ссылка.Дата &gt;= &amp;ДатаНач
	И ЗаказПокупателяСезонныйТовары.Ссылка.Контрагент = ЗаказПокупателяСезонныйТовары.Ссылка.Контрагент.КонтрагентДляРезерваИМ</query>
		</dataSet>
		<totalField>
			<dataPath>Количество</dataPath>
			<expression>Сумма(Количество)</expression>
		</totalField>
		<totalField>
			<dataPath>Сумма</dataPath>
			<expression>Сумма(Сумма)</expression>
		</totalField>
		<totalField>
			<dataPath>КоличествоВМатрице</dataPath>
			<expression>Максимум(КоличествоВМатрице)</expression>
			<group>Номенклатура</group>
			<group>Номенклатура Иерархия</group>
		</totalField>
		<totalField>
			<dataPath>КоличествоВМатрице</dataPath>
			<expression>Сумма(ВычислитьВыражениеСГруппировкойМассив("Максимум(КоличествоВМатрице)","Номенклатура"))</expression>
			<group>ДокументПродажи</group>
			<group>ЗаказПокупателя</group>
			<group>Контрагент</group>
			<group>Контрагент Иерархия</group>
			<group>Покупатель</group>
			<group>Покупатель Иерархия</group>
			<group>СезонныйЗаказ</group>
			<group>ОбщийИтог</group>
		</totalField>
		<totalField>
			<dataPath>РезервСПриходов</dataPath>
			<expression>Сумма(РезервСПриходов)</expression>
		</totalField>
		<parameter>
			<name>НачалоПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>КонецПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Конец периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>ДатаКон</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Дата кон</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>ДатаНач</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Дата нач</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<userFields>
		<item xsi:type="UserFieldExpression">
			<dataPath>ПользовательскиеПоля.Поле1</dataPath>
			<lwsTitle>
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>%</v8:content>
				</v8:item>
			</lwsTitle>
			<detailExpression>Выбор
	Когда РезервСПриходов &gt; 0
		Тогда 100 * Количество / РезервСПриходов
	Иначе 0
Конец</detailExpression>
			<detailExpressionPresentation>Выбор
	Когда [Резерв с приходов] &gt; 0
		Тогда 100 * Количество / [Резерв с приходов]
	Иначе 0
Конец</detailExpressionPresentation>
			<totalExpression>Выбор
	Когда РезервСПриходов &gt; 0
		Тогда 100 * Количество / РезервСПриходов
	Иначе 0
Конец</totalExpression>
			<totalExpressionPresentation>Выбор
	Когда [Резерв с приходов] &gt; 0
		Тогда 100 * Количество / [Резерв с приходов]
	Иначе 0
Конец</totalExpressionPresentation>
		</item>
	</userFields>
	<selection>
		<item xsi:type="SelectedItemFolder">
			<lwsTitle>
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>РЕЗЕРВ</v8:content>
				</v8:item>
			</lwsTitle>
			<item xsi:type="SelectedItemField">
				<field>КоличествоВМатрице</field>
			</item>
			<item xsi:type="SelectedItemField">
				<field>РезервСПриходов</field>
			</item>
			<placement>Auto</placement>
		</item>
		<item xsi:type="SelectedItemFolder">
			<lwsTitle>
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>ПРОДАЖИ</v8:content>
				</v8:item>
			</lwsTitle>
			<item xsi:type="SelectedItemField">
				<field>Сумма</field>
			</item>
			<item xsi:type="SelectedItemField">
				<field>Количество</field>
			</item>
			<item xsi:type="SelectedItemField">
				<field>ПользовательскиеПоля.Поле1</field>
			</item>
			<placement>Auto</placement>
		</item>
	</selection>
	<filter>
		<item xsi:type="FilterItemComparison">
			<left xsi:type="dcscor:Field">СезонныйЗаказ.Контрагент</left>
			<comparisonType>NotEqual</comparisonType>
		</item>
	</filter>
	<dataParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>ДатаКон</dcscor:parameter>
			<dcscor:value xsi:type="v8:StandardBeginningDate">
				<v8:variant xsi:type="v8:StandardBeginningDateVariant">BeginningOfNextDay</v8:variant>
			</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>ДатаНач</dcscor:parameter>
			<dcscor:value xsi:type="v8:StandardBeginningDate">
				<v8:variant xsi:type="v8:StandardBeginningDateVariant">Custom</v8:variant>
				<v8:date>2018-09-19T00:00:00</v8:date>
			</dcscor:value>
		</dcscor:item>
	</dataParameters>
	<conditionalAppearance>
		<item>
			<selection>
				<item>
					<field>ПользовательскиеПоля.Поле1</field>
				</item>
			</selection>
			<filter/>
			<appearance>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>ЧДЦ=1</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
			</appearance>
		</item>
		<item>
			<selection>
				<item>
					<field>Количество</field>
				</item>
				<item>
					<field>РезервСПриходов</field>
				</item>
				<item>
					<field>КоличествоВМатрице</field>
				</item>
			</selection>
			<filter/>
			<appearance>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>ЧДЦ=0</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
			</appearance>
		</item>
	</conditionalAppearance>
	<outputParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>РасположениеРеквизитов</dcscor:parameter>
			<dcscor:value xsi:type="DataCompositionAttributesPlacement">Separately</dcscor:value>
		</dcscor:item>
	</outputParameters>
	<item xsi:type="StructureItemGroup">
		<groupItems>
			<item xsi:type="GroupItemField">
				<field>Номенклатура.НоменклатурнаяГруппа</field>
				<groupType>Items</groupType>
				<periodAdditionType>None</periodAdditionType>
				<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
				<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
			</item>
		</groupItems>
		<order>
			<item xsi:type="OrderItemAuto"/>
		</order>
		<selection>
			<item xsi:type="SelectedItemAuto"/>
		</selection>
		<item xsi:type="StructureItemGroup">
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Контрагент</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
			<item xsi:type="StructureItemGroup">
				<groupItems>
					<item xsi:type="GroupItemField">
						<field>Номенклатура</field>
						<groupType>Items</groupType>
						<periodAdditionType>None</periodAdditionType>
						<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
						<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
					</item>
					<item xsi:type="GroupItemField">
						<field>Номенклатура.Код</field>
						<groupType>Items</groupType>
						<periodAdditionType>None</periodAdditionType>
						<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
						<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
					</item>
				</groupItems>
				<order>
					<item xsi:type="OrderItemAuto"/>
				</order>
				<selection>
					<item xsi:type="SelectedItemAuto"/>
				</selection>
				<item xsi:type="StructureItemGroup">
					<groupItems>
						<item xsi:type="GroupItemField">
							<field>Покупатель</field>
							<groupType>Items</groupType>
							<periodAdditionType>None</periodAdditionType>
							<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
							<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
						</item>
					</groupItems>
					<order>
						<item xsi:type="OrderItemAuto"/>
					</order>
					<selection>
						<item xsi:type="SelectedItemAuto"/>
					</selection>
					<item xsi:type="StructureItemGroup">
						<use>false</use>
						<groupItems>
							<item xsi:type="GroupItemField">
								<field>ЗаказПокупателя</field>
								<groupType>Items</groupType>
								<periodAdditionType>None</periodAdditionType>
								<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
								<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
							</item>
							<item xsi:type="GroupItemField">
								<field>ДокументПродажи</field>
								<groupType>Items</groupType>
								<periodAdditionType>None</periodAdditionType>
								<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
								<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
							</item>
						</groupItems>
						<order>
							<item xsi:type="OrderItemAuto"/>
						</order>
						<selection>
							<item xsi:type="SelectedItemAuto"/>
						</selection>
					</item>
				</item>
			</item>
		</item>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>