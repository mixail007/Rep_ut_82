Перем Элемент;

Процедура ОКНажатие(Элемент)
	Если (НомерАвтомобиля=неопределено) или (НомерАвтомобиля=" ") или (НомерАвтомобиля="  ")или (НомерАвтомобиля="   ") или (НомерАвтомобиля="    ") или  (НомерАвтомобиля="     ") или  (НомерАвтомобиля="      ") или  (НомерАвтомобиля="       ") или  (НомерАвтомобиля="        ") или (НомерАвтомобиля="") тогда 
		Предупреждение("Номер автомобиля не может быть незаполненным");
		Возврат;
	Конецесли;
	Элемент = Справочники.МаркиИНомераАвтомобилей.СоздатьЭлемент();
	
	ТекущееПодразделение = ПолучитьЗначениеПоУмолчанию(глТекущийПользователь,"ОсновноеПодразделение");
	Если (ТекущееПодразделение<>Справочники.Подразделения.ПустаяСсылка()) Тогда 
		Элемент.УстановитьНовыйКод(СокрЛП(ТекущееПодразделение.ПрефиксИБ));
	Иначе 
		Предупреждение("У пользователя не заполнено основное подразделение.");
		Возврат;		
	КонецЕсли;

	Элемент.НомерАвто = НомерАвтомобиля;
	Элемент.Наименование = МаркаАвтомобиля;
	Элемент.Примечание = Примечание;
	Элемент.Записать();		
	Закрыть(Элемент.Ссылка); 
КонецПроцедуры

Процедура ПриОткрытии()
	НомерАвтомобиля = неопределено;
КонецПроцедуры

Процедура МаркаАвтомобиляАвтоПодборТекста(Элемент, Текст, ТекстАвтоПодбора, СтандартнаяОбработка)
	СтандартнаяОбработка=Ложь;
	ТекстЗапроса=" ВЫБРАТЬ Спр.Наименование КАК Наименование
	| ИЗ Справочник.МаркиИНомераАвтомобилей КАК Спр
	| ГДЕ(Спр.Наименование ПОДОБНО &Шаблон)
	|";
	Запрос=Новый Запрос(ТекстЗапроса);
	Запрос.УстановитьПараметр("Шаблон",""+Текст+"%");
	р=Запрос.Выполнить().Выгрузить();
	Мас=р.ВыгрузитьКолонку("Наименование");
	СЗ=Новый СписокЗначений();
	СЗ.ЗагрузитьЗначения(Мас);
	ТекстАвто =ВыбратьИзСписка(СЗ, Элемент,);
	Если ТекстАвто<>Неопределено Тогда
	 	ТекстАвтоПодбора=ТекстАвто;
	 	МаркаАвтомобиляОкончаниеВводаТекста(Элемент, ТекстАвтоПодбора, "", Истина);
	КонецЕсли;
КонецПроцедуры

Процедура МаркаАвтомобиляОкончаниеВводаТекста(Элемент, Текст, Значение, СтандартнаяОбработка)
КонецПроцедуры




                        