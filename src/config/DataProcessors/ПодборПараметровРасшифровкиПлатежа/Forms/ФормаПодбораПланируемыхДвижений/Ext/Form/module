Процедура ПриОткрытии()
	
	Если ИмяРегистраПлан="ЗаявкиНаРасходованиеСредств" Тогда
		ИмяДокумента="ЗаявкаНаРасходование";
		ПредставлениеДокумента="Заявки на расходование средств";
	Иначе
		ИмяДокумента="ДокументПланирования";
		ПредставлениеДокумента="Планируемые поступления денежных средств";
	КонецЕсли;
	
	ЭтаФорма.Заголовок=ПредставлениеДокумента+". Вид операции: "+Строка(ВидОперацииПлан);
		
	СформироватьСписокПланируемыхДвижений(ИмяДокумента);
	
	ВидимостьРеквизитаПроект(, ЭлементыФормы, "ПланируемыеДвижения.Проект");
		
КонецПроцедуры

Процедура ПланируемыеДвиженияВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	
	Перем КурсВзаиморасчетов,КратностьВзаиморасчетов,СуммаПлатежа,СуммаВзаиморасчетов;
		
	Если ТипЗнч(ВыбраннаяСтрока)=Тип("Массив") Тогда
		СтрокаДоговор=ВыбраннаяСтрока[0];
	Иначе
		СтрокаДоговор=ВыбраннаяСтрока;
	КонецЕсли;
		
	СтруктураПодбора=Новый Структура;
	
	СтруктураПодбора.Вставить("ДоговорКонтрагента",				СтрокаДоговор.ДоговорКонтрагента);
	СтруктураПодбора.Вставить("Сделка",							СтрокаДоговор.Сделка);
	СтруктураПодбора.Вставить("ДокументПланирования",			СтрокаДоговор.ДокументПланирования);
	СтруктураПодбора.Вставить("Проект",							СтрокаДоговор.Проект);
	СтруктураПодбора.Вставить("СтатьяДвиженияДенежныхСредств",	СтрокаДоговор.СтатьяДвиженияДенежныхСредств);
	СтруктураПодбора.Вставить("СуммаПлатежаПлан",				СтрокаДоговор.СуммаПлатежа);
	СтруктураПодбора.Вставить("СуммаПлатежа",					СтрокаДоговор.СуммаПлатежа);
	СтруктураПодбора.Вставить("КурсВзаиморасчетов",				СтрокаДоговор.КурсВзаиморасчетов);
	СтруктураПодбора.Вставить("КратностьВзаиморасчетов",		СтрокаДоговор.КратностьВзаиморасчетов);
	СтруктураПодбора.Вставить("СуммаВзаиморасчетов",			СтрокаДоговор.СуммаВзаиморасчетов);
	СтруктураПодбора.Вставить("КурсВзаиморасчетовПлан",			СтрокаДоговор.КурсВзаиморасчетовПлан);

    ОповеститьОВыборе(СтруктураПодбора);
		
КонецПроцедуры

Процедура КоманднаяПанель1Выбрать(Кнопка)
	
	Перем КурсВзаиморасчетов,КратностьВзаиморасчетов,СуммаПлатежа,СуммаВзаиморасчетов;
	
	СтрокаДоговор=ЭлементыФормы.ПланируемыеДвижения.ТекущиеДанные;
	
	Если НЕ СтрокаДоговор=Неопределено Тогда
		
		СтруктураПодбора=Новый Структура;
		
		СтруктураПодбора.Вставить("ДоговорКонтрагента",				СтрокаДоговор.ДоговорКонтрагента);
		СтруктураПодбора.Вставить("Сделка",							СтрокаДоговор.Сделка);
		СтруктураПодбора.Вставить("ДокументПланирования",			СтрокаДоговор.ДокументПланирования);
		СтруктураПодбора.Вставить("Проект",							СтрокаДоговор.Проект);
		СтруктураПодбора.Вставить("СтатьяДвиженияДенежныхСредств",	СтрокаДоговор.СтатьяДвиженияДенежныхСредств);
		СтруктураПодбора.Вставить("СуммаПлатежа",		 			СтрокаДоговор.СуммаПлатежа);
		СтруктураПодбора.Вставить("СуммаПлатежаПлан",		 		СтрокаДоговор.СуммаПлатежа);
		СтруктураПодбора.Вставить("КурсВзаиморасчетов",				СтрокаДоговор.КурсВзаиморасчетов);
		СтруктураПодбора.Вставить("КратностьВзаиморасчетов",		СтрокаДоговор.КратностьВзаиморасчетов);
		СтруктураПодбора.Вставить("СуммаВзаиморасчетов",			СтрокаДоговор.СуммаВзаиморасчетов);
		СтруктураПодбора.Вставить("КурсВзаиморасчетовПлан",			СтрокаДоговор.КурсВзаиморасчетовПлан);
		
		ОповеститьОВыборе(СтруктураПодбора);
		
	КонецЕсли;
	
КонецПроцедуры





