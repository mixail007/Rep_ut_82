////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ
// 

// Процедура устанавливает доступность элементов управления, 
// чьи действия зависят от установленности узла
//
// Параметры:
//  Узел - ссылка на узел
//
Процедура ОбновитьДоступностьПоУзлу(Узел)

	Доступность = Ложь;
	// Определяем наличие установленного узла
	Если Узел <> ПланыОбмена.СинхронизацияСтатейЗатрат.ПустаяСсылка()
	   И Узел <> ПланыОбмена.СинхронизацияСтатейЗатрат.ЭтотУзел() 
	   И Узел.ПолучитьОбъект() <> Неопределено Тогда
					
		Доступность = Истина;
					
	КонецЕсли;
					
	// Устанавливаем доступность элементов управления, чьи действия зависят от установленности узла
	ЭлементыФормы.ВыполнитьОбмен.Доступность = Доступность;
	ЭлементыФормы.ВыполнитьВыгрузку.Доступность = Доступность;
	ЭлементыФормы.ВыполнитьЗагрузку.Доступность = Доступность;
	ЭлементыФормы.ВыполнитьПолнуюРегистрацию.Доступность = Доступность;
	ЭлементыФормы.УдалитьРегистрациюИзменений.Доступность = Доступность;

КонецПроцедуры // ОбновитьДоступностьПоУзлу()

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ
// 

// Процедура обработчик события ПередОткрытием
//
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	// Восстанавливаем сохраненные настройки
	Узел = ВосстановитьЗначение("УзелОбмена");
	АвтоОбмен = ВосстановитьЗначение("АвтоОбмен");
	ИнтервалОбмена = ВосстановитьЗначение("ИнтервалОбмена");
	
	// Устанавливаем доступность элементов управления, чьи действия зависят от установленности узла
	ОбновитьДоступностьПоУзлу(Узел);
	
КонецПроцедуры // ПередОткрытием(Отказ, СтандартнаяОбработка)

// Процедура обработчик события ПриЗакрытии
//
Процедура ПриЗакрытии()
	
	// Сохраняем настройки
	СохранитьЗначение("УзелОбмена", Узел);
	
КонецПроцедуры // ПриЗакрытии()

// Процедура обработчик действия СписокУзлов командной панели ОсновнаяПанель
//
Процедура ОсновнаяПанельСписокУзлов(Кнопка)
	
	ПланыОбмена.СинхронизацияСтатейЗатрат.ПолучитьФормуСписка().Открыть();
	
КонецПроцедуры // ОсновнаяПанельСписокУзлов(Кнопка)

// Процедура обработчик события ПриИзменении флажка АвтоОбмен
//
Процедура АвтоОбменПриИзменении(Элемент)
	
	//СохранитьЗначение("АвтоОбмен", АвтоОбмен);
	//глУстановитьАвтоОбмен();
	
КонецПроцедуры // АвтоОбменПриИзменении(Элемент)

// Процедура обработчик события ПриИзменении поля ввода ИнтервалОбмена
//
Процедура ИнтервалОбменаПриИзменении(Элемент)
	
	//СохранитьЗначение("ИнтервалОбмена", ИнтервалОбмена);
	//глУстановитьАвтоОбмен();
	
КонецПроцедуры // ИнтервалОбменаПриИзменении(Элемент)

// Процедура обработчик события ПриИзменении поля ввода Узел
//
Процедура УзелПриИзменении(Элемент)
	
	// Устанавливаем доступность элементов управления, чьи действия зависят от установленности узла
	ОбновитьДоступностьПоУзлу(Элемент.Значение);
	
КонецПроцедуры

// Процедура обработчик события Нажатие гиперссылки ВыполнитьОбменСоВсемиУзлами
//
Процедура ВыполнитьОбменСоВсемиУзламиНажатие(Элемент)
	
	ОбменНоменклатурой();
	
КонецПроцедуры // ВыполнитьОбменСоВсемиУзламиНажатие(Элемент)

// Процедура обработчик события Нажатие гиперссылки ВыполнитьОбмен
//
Процедура ВыполнитьОбменНажатие(Элемент)
	
	// Получаем объект узла обмена
	УзелОбмена = Узел.ПолучитьОбъект();
	// Читаем новое сообщение обмена
	УзелОбмена.ПрочитатьСообщениеСИзменениями();
	// Записываем новое сообщение обмена
	УзелОбмена.ЗаписатьСообщениеСИзменениями();
	
КонецПроцедуры // ВыполнитьОбменНажатие(Элемент)

// Процедура обработчик события Нажатие гиперссылки ВыполнитьВыгрузку
//
Процедура ВыполнитьВыгрузкуНажатие(Элемент)
	
	// Получаем объект узла обмена
	УзелОбмена = Узел.ПолучитьОбъект();
	// Записываем новое сообщение обмена
	УзелОбмена.ЗаписатьСообщениеСИзменениями();
	
КонецПроцедуры // ВыполнитьВыгрузкуНажатие(Элемент)

// Процедура обработчик события Нажатие гиперссылки ВыполнитьЗагрузку
//
Процедура ВыполнитьЗагрузкуНажатие(Элемент)
	
	// Получаем объект узла обмена
	УзелОбмена = Узел.ПолучитьОбъект();
	// Читаем новое сообщение обмена
	УзелОбмена.ПрочитатьСообщениеСИзменениями();
	
КонецПроцедуры // ВыполнитьЗагрузкуНажатие(Элемент)

// Процедура обработчик события Нажатие гиперссылки ВыполнитьПолнуюРегистрацию
//
Процедура ВыполнитьПолнуюРегистрациюНажатие(Элемент)
	
	// Выполняем полную регистрацию изменений данных для данного узла
	ПолнаяРегистрацияДанныхПоУзлу(Узел, Истина);
	
КонецПроцедуры // ВыполнитьПолнуюРегистрациюНажатие(Элемент)

// Процедура обработчик события Нажатие гиперссылки УдалитьРегистрациюИзменений
//
Процедура УдалитьРегистрациюИзмененийНажатие(Элемент)
	
	// Выполняем полное удаление регистрации изменений данных для данного узла
	ПолноеУдалениеРегистрацииДанныхПоУзлу(Узел);
	
КонецПроцедуры // УдалитьРегистрациюИзмененийНажатие(Элемент)
