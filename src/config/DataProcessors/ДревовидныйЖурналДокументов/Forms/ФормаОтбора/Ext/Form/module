///////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ
// 
Перем СписокДокументов;

///////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ МОДУЛЯ
//


Процедура ОсновныеДействияФормыОК(Кнопка)
	
	Закрыть(Истина);
	
КонецПроцедуры

Процедура ОтборПриНачалеРедактирования(Элемент, НоваяСтрока, Копирование)
	
	//Очень нужная процедура. Она пустая, но без неё не работает переопределение списка для отбора по виду документа
	
КонецПроцедуры

Процедура ОтборПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	Если ЭлементыФормы.Отбор.ТекущиеДанные <> Неопределено
		и ЭлементыФормы.Отбор.ТекущиеДанные.ПутьКДанным = "ВидДокумента" Тогда
		ЭлементУправления = Элемент.Колонки.Значение.ЭлементУправления;
		ЭлементУправления.КнопкаВыбора = Истина;
	КонецЕсли;
	
КонецПроцедуры

Процедура ОтборИмяПриИзменении(Элемент)
	
	Если Элемент.Значение = "Вид документа" Тогда
		ЭлементУправления = Элемент.Колонки.Значение.ЭлементУправления;
		ЭлементУправления.КнопкаВыбора = Истина;
	КонецЕсли;
	
КонецПроцедуры

Процедура ОтборЗначениеНачалоВыбора(Элемент, СтандартнаяОбработка)
	
	ТекущиеДанныеОтбора = ЭлементыФормы.Отбор.ТекущиеДанные;
	
	Если ТекущиеДанныеОтбора.ПутьКДанным = "ВидДокумента"
		и ТекущиеДанныеОтбора.ВидСравнения <> ВидСравнения.ВСписке
		и ТекущиеДанныеОтбора.ВидСравнения <> ВидСравнения.НеВСписке Тогда
		СтандартнаяОбработка = Ложь;
		ВыбЭлемент = СписокДокументов.ВыбратьЭлемент(,Элемент.Значение);
		Если ВыбЭлемент <> Неопределено Тогда
			Элемент.Значение = ВыбЭлемент.Значение;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

///////////////////////////////////////////////////////////////////////////////
// ПРЕДОПРЕДЕЛЕННЫЕ ПРОЦЕДУРЫ МОДУЛЯ
//

// Процедура - обработчик события "ОбработкаОповещения" формы
//
Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	
	Если ИмяСобытия = "ЗавершитьРаботуСистемы" Тогда
		Закрыть();
	КонецЕсли;
	
КонецПроцедуры // ОбработкаОповещения()

///////////////////////////////////////////////////////////////////////////////
// ОПЕРАТОРЫ ОСНОВНОЙ ПРОГРАММЫ
//

СписокДокументов = Новый СписокЗначений;
Для каждого Документ Из ДоступныеДокументы Цикл МетаданныеДокумента = СтруктураМетаданныеДокументы[Документ.ИмяДокумента]; Если МетаданныеДокумента = Неопределено Тогда Продолжить; КонецЕсли; СписокДокументов.Добавить(МетаданныеДокумента.Представление, , ,БиблиотекаКартинок.ДокументОбъект); КонецЦикла;
