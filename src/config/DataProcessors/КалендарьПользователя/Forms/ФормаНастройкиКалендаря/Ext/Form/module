
////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

// Процедура управляет доступоностью переключателей
// настройки отображения заказов
Процедура ДоступностьПереключателейЗаказов()

	ЭлементыФормы.ОтображатьЗаказыПокупателей.Доступность = ОтображатьЗаказы;
	ЭлементыФормы.ОтображатьЗаказыПоставщикам.Доступность = ОтображатьЗаказы;
	ЭлементыФормы.ОтображатьВсеЗаказы.Доступность         = ОтображатьЗаказы;

КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Обработчик события ПередОткрытием формы.
//
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)

	СохраненныеЗначения = ВосстановитьЗначение("КалендарьПользователя");
	Если СохраненныеЗначения <> Неопределено И ТипЗнч(СохраненныеЗначения) = Тип("Структура") Тогда
		СохраненныеЗначения.Свойство("КоличествоДнейНедели", КоличествоДнейНедели);
		СохраненныеЗначения.Свойство("ОтображатьЗапланированныеСобытия", ОтображатьЗапланированныеСобытия);
		СохраненныеЗначения.Свойство("ТипСобытияКалендаря", ТипСобытияКалендаря);
		СохраненныеЗначения.Свойство("ОтображатьЗаказы", ОтображатьЗаказы);
		СохраненныеЗначения.Свойство("ОтображаемыеЗаказы", ОтображаемыеЗаказы);
	КонецЕсли; 
	
	Если КоличествоДнейНедели = 0 Тогда
		КоличествоДнейНедели = 7;
	КонецЕсли; 
	
	Если ОтображаемыеЗаказы = 0 Тогда
		ОтображаемыеЗаказы = 3;
	КонецЕсли; 
	
КонецПроцедуры

// Обработчик события ПриОткрытии формы.
//
Процедура ПриОткрытии()
	
	ДоступностьПереключателейЗаказов();
	
	Если ПолучитьЗначениеПоУмолчанию(глТекущийПользователь,"ИзменениеПользователяВКалендареПользователя") <> Истина Тогда
		ЭлементыФормы.ПользовательКалендаря.ТолькоПросмотр = Истина;
	КонецЕсли;
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ, ВЫЗЫВАЕМЫЕ ИЗ ОБРАБОТЧИКОВ ЭЛЕМЕНТОВ ФОРМЫ

// Обработчик события Нажатие элемента формы ОсновныеДействияФормы.ОК.
//
Процедура ОсновныеДействияФормыОК(Кнопка)
	
	Если ПользовательКалендаря.Пустая() Тогда
		Предупреждение("Обязательно выберите пользователя календаря");
		Возврат;
	КонецЕсли; 

	СтруктураСохраняемыхЗначений = Новый Структура;
	СтруктураСохраняемыхЗначений.Вставить("КоличествоДнейНедели", КоличествоДнейНедели);
	СтруктураСохраняемыхЗначений.Вставить("ОтображатьЗапланированныеСобытия", ОтображатьЗапланированныеСобытия);
	СтруктураСохраняемыхЗначений.Вставить("ТипСобытияКалендаря", ТипСобытияКалендаря);
	СтруктураСохраняемыхЗначений.Вставить("ОтображатьЗаказы", ОтображатьЗаказы);
	СтруктураСохраняемыхЗначений.Вставить("ОтображаемыеЗаказы", ОтображаемыеЗаказы);

	СохранитьЗначение("КалендарьПользователя", СтруктураСохраняемыхЗначений);

	ЭтаФорма.Закрыть(Истина);
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы НеОтображатьЗаказы.
//
Процедура НеОтображатьЗаказыПриИзменении(Элемент)
	
	ДоступностьПереключателейЗаказов();
	
КонецПроцедуры



