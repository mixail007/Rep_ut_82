Процедура ДействияФормыФайлы(Кнопка)
	// Вставить содержимое обработчика.
	//Если ОбъектДоговорКонтрагента.Ссылка.Пустая() Тогда
	//	Предупреждение("Нет договора!");
	//	Возврат;
	//КонецЕсли;

	//ФормаВыб = Справочники.ХранилищеДополнительнойИнформации.ПолучитьФорму("ФормаСписка",ЭтаФорма);
	//ФормаВыб.Отбор.Объект.Значение = ОбъектДоговорКонтрагента.Ссылка;
	//ФормаВыб.Отбор.Объект.Использование = Истина;
	//ФормаВыб.Открыть();
	Если НЕ ЭлементыФормы.ДокументСписок.ТекущаяСтрока = Неопределено Тогда
	    ФормаВыб = Справочники.ХранилищеДополнительнойИнформации.ПолучитьФорму("ФормаСписка",ЭтаФорма);
		ФормаВыб.Отбор.Объект.Значение = ЭлементыФормы.ДокументСписок.ТекущаяСтрока.Ссылка;
		ФормаВыб.Отбор.Объект.Использование = Истина;
	    ФормаВыб.Открыть();
	КонецЕсли; 
КонецПроцедуры

// Процедура вызывается при выборе пункта подменю "Движения документа по регистрам" меню "Перейти".
// командной панели формы. Процедура отрабатывает печать движений документа по регистрам.
//
Процедура ДействияФормыДвиженияДокументаПоРегистрам(Кнопка)

	Если ЭлементыФормы.ДокументСписок.ТекущиеДанные = Неопределено тогда
		Возврат
	КонецЕсли;

	НапечататьДвиженияДокумента(ЭлементыФормы.ДокументСписок.ТекущиеДанные.Ссылка);

КонецПроцедуры // ДействияФормыДвиженияДокументаПоРегистрам()

// Процедура вызывается при выборе пункта подменю "Структура подчиненности" меню "Перейти".
Процедура ДействияФормыСтруктураПодчиненностиДокумента(Кнопка)
	
	Если ЭлементыФормы.ДокументСписок.ТекущиеДанные = Неопределено тогда
		Возврат
	КонецЕсли;
	
	ПоказатьСтруктуруПодчиненностиДокумента(ЭтаФорма.ЭлементыФормы.ДокументСписок.ТекущаяСтрока);
	
КонецПроцедуры

Процедура ПриОткрытии()
	
	Если ПолучитьЗначениеПоУмолчанию(ПараметрыСеанса.ТекущийПользователь, "УчетТолькоПоПодразделениюПользователя") Тогда
		Если РольДоступна("Кассир") Тогда
			//ограничение, чтоб видели все заявки по подразделению
			Отбор["Подразделение"].Использование = Истина;
			Отбор["Подразделение"].ВидСравнения = ВидСравнения.Равно;
			Отбор["Подразделение"].Значение = ПараметрыСеанса.ТекущийПользователь.ОсновноеПодразделение;
			ЭлементыФормы.ДокументСписок.НастройкаОтбора["Подразделение"].Доступность = Ложь;
		Иначе
			//ограничение, чтоб видели только свои заявки
			Отбор["Ответственный"].Использование = Истина;
			Отбор["Ответственный"].ВидСравнения = ВидСравнения.Равно;
			Отбор["Ответственный"].Значение = ПараметрыСеанса.ТекущийПользователь;
			ЭлементыФормы.ДокументСписок.НастройкаОтбора["Ответственный"].Доступность = Ложь;
		КонецЕсли;
	Иначе
		Если РольДоступна("ПолныеПрава") ИЛИ РольДоступна("яштФинДиректор") ИЛИ РольДоступна("ПравоЗавершенияРаботыПользователей") Тогда
		Иначе
			//ограничение, чтоб видели только свои заявки
			Отбор["Ответственный"].Использование = Истина;
			Отбор["Ответственный"].ВидСравнения = ВидСравнения.Равно;
			Отбор["Ответственный"].Значение = ПараметрыСеанса.ТекущийПользователь;
			ЭлементыФормы.ДокументСписок.НастройкаОтбора["Ответственный"].Доступность = Ложь;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры
