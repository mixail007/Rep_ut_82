
Процедура ТоварыПриПолученииДанных(Элемент, ОформленияСтрок)
	Для каждого ОформлениеСтроки из ОформленияСтрок Цикл
		ДанныеСтроки = ОформлениеСтроки.ДанныеСтроки;
		ОформлениеСтроки.Ячейки.Код.УстановитьТекст(ДанныеСтроки.Номенклатура.Код);
		Если  ДанныеСтроки.Результат1<=283 и ДанныеСтроки.ТестПройден1= Истина тогда
			Сообщить("Признак Тест пройден не может быть установлен для нагрузки 283 и менее.");
			ДанныеСтроки.ТестПройден1= Ложь;
		конецЕсли;
		Если  ДанныеСтроки.Результат2<=283 и ДанныеСтроки.ТестПройден2= Истина тогда
			Сообщить("Признак Тест пройден не может быть установлен для нагрузки 283 и менее.");
			ДанныеСтроки.ТестПройден2= Ложь;
		конецЕсли;
		Если  ДанныеСтроки.Результат3<=283 и ДанныеСтроки.ТестПройден3= Истина тогда
			Сообщить("Признак Тест пройден не может быть установлен для нагрузки 283 и менее.");
			ДанныеСтроки.ТестПройден3= Ложь;
		конецЕсли;
		Если ДанныеСтроки.Дубль тогда
		 оформлениеСтроки.Ячейки.Дата1.ТолькоПросмотр = истина;
		 оформлениеСтроки.Ячейки.Дата2.ТолькоПросмотр = истина;
		 оформлениеСтроки.Ячейки.Дата3.ТолькоПросмотр = истина;
		конецесли;
		Если ДанныеСтроки.ВПроцессе тогда
		оформлениеСтроки.ЦветФона = WebЦвета.СветлоЖелтый;	
		конецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры

Процедура ТоварыРезультат1ПриИзменении(Элемент)
	ТекСтрока = ЭлементыФормы.Товары.ТекущиеДанные;
	Если  ТекСтрока.Результат1<=283 и ТекСтрока.ТестПройден1= Истина тогда
		Сообщить("Признак Тест пройден не может быть установлен для нагрузки 283 и менее.");
		ТекСтрока.ТестПройден1= Ложь;
	конецЕсли;
	ТекСтрока.Дата1 = ТекущаяДата();
КонецПроцедуры

Процедура ТоварыРезультат2ПриИзменении(Элемент)
	ТекСтрока = ЭлементыФормы.Товары.ТекущиеДанные;
	Если  ТекСтрока.Результат2<=283 и ТекСтрока.ТестПройден2= Истина тогда
		Сообщить("Признак Тест пройден не может быть установлен для нагрузки 283 и менее.");
		ТекСтрока.ТестПройден2= Ложь;
	конецЕсли;
	ТекСтрока.Дата2 = ТекущаяДата();
КонецПроцедуры

Процедура ТоварыРезультат3ПриИзменении(Элемент)
	ТекСтрока = ЭлементыФормы.Товары.ТекущиеДанные;
	Если  ТекСтрока.Результат3<=283 и ТекСтрока.ТестПройден3= Истина тогда
		Сообщить("Признак Тест пройден не может быть установлен для нагрузки 283 и менее.");
		ТекСтрока.ТестПройден3= Ложь;
	конецЕсли;
	ТекСтрока.Дата3 = ТекущаяДата();
КонецПроцедуры

Процедура ДокументОснованиеНажатие(Элемент)
	форма = ДокументОснование.ПолучитьФорму();
	форма.Открыть();
КонецПроцедуры

Процедура ТоварыПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	// Вставить содержимое обработчика.
КонецПроцедуры

Процедура ТоварыНомерПартииПриИзменении(Элемент)
	текСтрока = ЭлементыФормы.Товары.ТекущиеДанные;

	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ПровереннаяНагрузкаДисков.Документ,
		|	ПровереннаяНагрузкаДисков.Дата,
		|	ПровереннаяНагрузкаДисков.Номенклатура,
		|	ПровереннаяНагрузкаДисков.НомерПартии,
		|	ПровереннаяНагрузкаДисков.НомерКонтейнера,
		|	ПровереннаяНагрузкаДисков.ТестПройден,
		|	ПровереннаяНагрузкаДисков.ПрошедшаяНагрузка
		|ИЗ
		|	РегистрСведений.ПровереннаяНагрузкаДисков КАК ПровереннаяНагрузкаДисков
		|ГДЕ
		|	ПровереннаяНагрузкаДисков.Номенклатура = &Номенклатура
		|	И ПровереннаяНагрузкаДисков.НомерПартии = &НомерПартии
		|	И ПровереннаяНагрузкаДисков.Дата >= &Дата";

	Запрос.УстановитьПараметр("Дата", ДобавитьМесяц(Дата,-2));
	Запрос.УстановитьПараметр("Номенклатура", текСтрока.Номенклатура);
	Запрос.УстановитьПараметр("НомерПартии", текСтрока.НомерПартии);

	Результат = Запрос.Выполнить();

	Выборка = Результат.Выбрать();

	Если Выборка.Следующий() тогда
      текСтрока.Результат1 = Выборка.прошедшаяНагрузка;
	  текСтрока.тестПройден1 = Выборка.ТестПройден;
	  текСтрока.Дата1 = Выборка.Дата;
	  текСтрока.дубль = Истина;
	  текСтрока.впроцессе = ложь;
	конецесли;	
		
	Если Выборка.Следующий() тогда
      текСтрока.Результат2 = Выборка.прошедшаяНагрузка;
	  текСтрока.тестПройден2 = Выборка.ТестПройден;
	  текСтрока.Дата2 = Выборка.Дата;
	конецесли;	
	Если Выборка.Следующий() тогда
      текСтрока.Результат3 = Выборка.прошедшаяНагрузка;
	  текСтрока.тестПройден3 = Выборка.ТестПройден;
	  текСтрока.Дата3 = Выборка.Дата;
	конецесли;	
	
КонецПроцедуры
