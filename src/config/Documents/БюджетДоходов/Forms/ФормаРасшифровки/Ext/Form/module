Перем ТЧ Экспорт;
Перем ПериодПланирования Экспорт;
Процедура ПриОткрытии()
		
	соответствие = Новый Соответствие;
		соответствие.Вставить(1,"Январь");
		соответствие.Вставить(2,"Февраль");
		соответствие.Вставить(3,"Март");
		соответствие.Вставить(4,"Апрель");
		соответствие.Вставить(5,"Май");
		соответствие.Вставить(6,"Июнь");
		соответствие.Вставить(7,"Июль");
		соответствие.Вставить(8,"Август");
		соответствие.Вставить(9,"Сентябрь");
		соответствие.Вставить(10,"Октябрь");
		соответствие.Вставить(11,"Ноябрь");
		соответствие.Вставить(12,"Декабрь");
		
		Если Число(Формат(ПериодПланирования.ДатаНачала,"ДФ=yyyy")) = Число(Формат(ПериодПланирования.ДатаКонца,"ДФ=yyyy")) Тогда	
			КоличествоМесяцев = Число(Формат(ПериодПланирования.ДатаКонца,"ДФ=MM")) - Число(Формат(ПериодПланирования.ДатаНачала,"ДФ=MM")) +1;
		иначе
			КоличествоМесяцев = 12 - Число(Формат(ПериодПланирования.ДатаНачала,"ДФ=MM")) +1 + Число(Формат(ПериодПланирования.ДатаКонца,"ДФ=MM"));
		КонецЕсли;
				
		Датаии = ПериодПланирования.ДатаНачала;
		для ии = 1 по КоличествоМесяцев Цикл
			
			ЭлементыФормы.ТабличноеПоле1.Колонки["Месяц"+Строка(ии)].ТекстШапки = соответствие.Получить(Число(Формат(Датаии,"ДФ=MM")));
						
			Датаии = ДобавитьМесяц(Датаии,1);
			
		КонецЦикла;
		
		для ии = (КоличествоМесяцев +1) по 12 Цикл
			
			ЭлементыФормы.ТабличноеПоле1.Колонки["Месяц"+Строка(ии)].Видимость = Ложь;
						
		КонецЦикла;

	    ТабличноеПоле1 = ТЧ;

КонецПроцедуры
