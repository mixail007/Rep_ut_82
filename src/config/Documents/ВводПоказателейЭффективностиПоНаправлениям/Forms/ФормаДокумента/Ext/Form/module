
Процедура ПриОткрытии()
	
	Если ЭтоНовый() Тогда
		ПериодРегистрации = НачалоМесяца(ТекущаяДата());
	КонецЕсли;
	
	// Заполним реквизит формы МесяцСтрока.
	МесяцСтрока = ДатаКакМесяцПредставление(ПериодРегистрации);
	
	//+++ 10.09.2015 названия "реальные" из НаправленияПродаж  без последнего столбца - Итого
	//изменен порядок колонок в форме - по текущей "нумерации" в названиях...
	для i=5 по ЭлементыФормы.Данные.Колонки.Количество()-2 цикл
		кол1 = ЭлементыФормы.Данные.Колонки[i];
		назв = прав(кол1.Имя, стрДлина(кол1.Имя)-4); //План....
		кол1.ТекстШапки = справочники.НаправленияПродаж[назв].Наименование;
	КонецЦикла;
	
КонецПроцедуры

Процедура ПериодРегистрацииНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	
	НачалоВыбораИзСпискаПредставленияПериодаРегистрации(Элемент, СтандартнаяОбработка, ПериодРегистрации, ЭтаФорма);
	
КонецПроцедуры

Процедура ПериодРегистрацииРегулирование(Элемент, Направление, СтандартнаяОбработка)
	
	ПериодРегистрации = ДобавитьМесяц(ПериодРегистрации, Направление);
	Элемент.Значение = ДатаКакМесяцПредставление(ПериодРегистрации);
	
КонецПроцедуры

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	Если Данные.Итог("Вес") > 1 Тогда
		Сообщить("Сумма колонки ""Вес"" не должна превышать 1", СтатусСообщения.Важное);
		Отказ = Истина;
	КонецЕсли;
	
КонецПроцедуры

Процедура ДанныеПланПриИзменении(Элемент)
	
	ТекСтрока = ЭлементыФормы.Данные.ТекущиеДанные;
	//+++ 06.12.2016
	ТекСтрока.Итого = 0;
	для i=5 по ЭлементыФормы.Данные.Колонки.Количество()-2 цикл
  	кол1 = ЭлементыФормы.Данные.Колонки[i].Имя;
	ТекСтрока.Итого = ТекСтрока.Итого + ТекСтрока[кол1];
	КонецЦикла;
	//ТекСтрока.Итого = ТекСтрока.ПланПодмосковье + ТекСтрока.ПланМосква + ТекСтрока.ПланЦентрРоссии + ТекСтрока.ПланНижнийНовгород  + ТекСтрока.ПланСеверЮг
	//                + ТекСтрока.ПланФилиалРнД + ТекСтрока.ПланФилиалСПб + ТекСтрока.ПланФилиалЕкб  + ТекСтрока.ПланБондаренкоКорпоративныеКлиенты;
		
КонецПроцедуры



