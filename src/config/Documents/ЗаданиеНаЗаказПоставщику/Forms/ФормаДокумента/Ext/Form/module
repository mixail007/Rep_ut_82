
Процедура ТоварыНоменклатураПриИзменении(Элемент)
	ОбновитьЗавод(ЭлементыФормы.Товары.ТекущаяСтрока);
КонецПроцедуры

Процедура ТоварыПриПолученииДанных(Элемент, ОформленияСтрок)
	Для каждого ОформлениеСтроки Из ОформленияСтрок Цикл
		ОформлениеСтроки.Ячейки.Код.ОтображатьТекст = истина;
		Данныестроки = ОформлениеСтроки.Данныестроки;
		ОформлениеСтроки.Ячейки.Код.Текст = Данныестроки.Номенклатура.Код;
   КонецЦикла;
КонецПроцедуры

Процедура КоманднаяПанель1кнОбновитьЗавод(Кнопка)
	Для каждого стр из товары Цикл
		ОбновитьЗавод(стр);
	КонецЦикла;
КонецПроцедуры

процедура ОбновитьЗавод(стр)
	МенеджерЗаписи = РегистрыСведений.СезонныйАссортимент.СоздатьМенеджерЗаписи();
	МенеджерЗаписи.Номенклатура = стр.Номенклатура;
	МенеджерЗаписи.Прочитать();
	Если МенеджерЗаписи.Выбран() тогда
		стр.Завод = МенеджерЗаписи.Завод;
	КонецЕсли;	
КонецПроцедуры

Процедура ДействияФормыкнАнализЗадания(Кнопка)
	ТекСсылка=Справочники.ВнешниеОбработки.НайтиПоКоду("546"); //План-факт задания поставщикам
	ИмяФайла = ПолучитьИмяВременногоФайла(); 
	ДвоичныеДанные = ТекСсылка.ХранилищеВнешнейОбработки.Получить(); 
	ДвоичныеДанные.Записать(ИмяФайла); 
	Если ТекСсылка.ВидОбработки = Перечисления.ВидыДополнительныхВнешнихОбработок.Отчет Тогда 
		Обработка = ВнешниеОтчеты.Создать(ИмяФайла,ложь); 
	Иначе 
		Обработка = ВнешниеОбработки.Создать(ИмяФайла,Ложь); 
	КонецЕсли;
	ФормаОтчета = Обработка.ПолучитьФорму("ФормаОтчета");
	ФормаОтчета.Параметр = Ссылка;
	ФормаОтчета.Открыть();
КонецПроцедуры

Процедура ДнейДоСогласования(Элемент)
	ДатаСогласования = КонецДня(Дата)+24*60*60*ДнейДоСогласования+1;
КонецПроцедуры

Процедура ДатаСогласованияПриИзменении(Элемент)
	Запрос = новый Запрос;
	Запрос.Текст="ВЫБРАТЬ РАЗНОСТЬДАТ(&Дата1, &Дата2, ДЕНЬ) КАК Разность";
	Запрос.УстановитьПараметр("Дата2",НачалоДня(ДатаСогласования));
	Запрос.УстановитьПараметр("Дата1",НачалоДня(Дата));
	ДнейДоСогласования = Запрос.Выполнить().Выгрузить()[0].Разность;
КонецПроцедуры

Процедура ПриЗаписи(Отказ)
	Если не Согласован тогда
		Документы.ЗаданиеНаЗаказПоставщику.ОтправитьНапоминание(Ссылка);
	КонецЕсли;
КонецПроцедуры
