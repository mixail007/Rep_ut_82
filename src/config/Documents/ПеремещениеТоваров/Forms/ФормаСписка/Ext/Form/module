//  Процедура печатает выбранный документ 
// Печатается та форма, которая была отпечатана при нажатии в документе кнопки
// печати по умолчанию
//
Процедура ДействияФормыДействиеПечать(Кнопка)

	Если ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока = Неопределено тогда
		Возврат
	КонецЕсли;

	НапечататьДокументИзФормыСписка(ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока.ПолучитьОбъект());

КонецПроцедуры // ДействиеПечать()

// Процедура вызывается при выборе пункта подменю "Движения документа по регистрам" меню "Перейти".
// командной панели формы. Процедура отрабатывает печать движений документа по регистрам.
//
Процедура ДействияФормыДвиженияДокументаПоРегистрам(Кнопка)

	Если ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока = Неопределено тогда
		Возврат
	КонецЕсли;

	НапечататьДвиженияДокумента(ЭлементыФормы.Список.ТекущиеДанные.Ссылка);

КонецПроцедуры // ДействияФормыДвиженияДокументаПоРегистрам()

// Процедура вызывается при выборе пункта подменю "Структура подчиненности" меню "Перейти".
Процедура ДействияФормыСтруктураПодчиненностиДокумента(Кнопка)
	
	Если ЭлементыФормы.Список.ТекущиеДанные = Неопределено тогда
		Возврат
	КонецЕсли;
	
	ПоказатьСтруктуруПодчиненностиДокумента(ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока);
	
КонецПроцедуры

Процедура ПриОткрытии()
	
	Если ПолучитьЗначениеПоУмолчанию(ПараметрыСеанса.ТекущийПользователь, "УчетТолькоПоПодразделениюПользователя") Тогда
		
		ПодразделениеПользователя = ПараметрыСеанса.ТекущийПользователь.ОсновноеПодразделение;
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("Подразделение", ПодразделениеПользователя);
		Запрос.Текст = "ВЫБРАТЬ
		               |	Склады.Ссылка
		               |ИЗ
		               |	Справочник.Склады КАК Склады
		               |ГДЕ
		               |	Склады.Подразделение = &Подразделение";
		Результат = Запрос.Выполнить().Выбрать();
		МассивСкладов = Новый СписокЗначений;
		Пока Результат.Следующий() Цикл
			МассивСкладов.Добавить(Результат.Ссылка); 
		КонецЦикла;
					   
		Отбор["СкладПолучатель"].Использование = Истина;
		Отбор["СкладПолучатель"].ВидСравнения = ВидСравнения.ВСписке;
		Отбор["СкладПолучатель"].Значение = МассивСкладов;
		
		ЭлементыФормы.Список.НастройкаОтбора["СкладПолучатель"].Доступность = Ложь;
		
	КонецЕсли;
	
	Если РольДоступна("ТолькоПросмотрНоменклатура") Тогда
		//нужны поступления только по валютным договорам
			ДокументСписок.Отбор["СкладПолучатель"].Использование = Истина;
			ДокументСписок.Отбор["СкладПолучатель"].ВидСравнения = ВидСравнения.Равно;
			ДокументСписок.Отбор["СкладПолучатель"].значение = справочники.Склады.НайтиПоКоду("02332");
		    ЭлементыФормы.Список.НастройкаОтбора["СкладПолучатель"].Доступность = Ложь;
	конецЕсли;		


КонецПроцедуры

//Орлов + 11.10.2013
Процедура СписокПриПолученииДанных(Элемент, ОформленияСтрок)
	
	Для Каждого Строка Из ОформленияСтрок Цикл
		
		Строка.ячейки.ОтметкаПечататьСтраховоеЗаявление.ОтображатьФлажок=Истина;
		Если Не ЗначениеНеЗаполнено (Строка.ДанныеСтроки.Ссылка.ВнутреннийЗаказ)
			И Не ЗначениеНеЗаполнено (Строка.ДанныеСтроки.Ссылка.ВнутреннийЗаказ.ДокументОснование) 
			И Строка.ДанныеСтроки.Ссылка.ВнутреннийЗаказ.ДокументОснование.ПечататьСтраховоеЗаявление Тогда	
			Строка.ячейки.ОтметкаПечататьСтраховоеЗаявление.Флажок=Истина;
		КонецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры
//Орлов -

