
////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ

// Процедура при необходимости сортирует дерево значений
//
Процедура ОтсортироватьДерево()

	//Если ФлажокПеремещения Тогда
	//	ДеревоПроизводители.Строки.Сортировать("Пометка УБЫВ");
	//КонецЕсли;

КонецПроцедуры // ОтсортироватьДерево()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ДЕЙСТВИЯ КОМАНДНЫХ ПАНЕЛЕЙ ФОРМЫ

// Процедура вызывается при нажатии кнопки "ОК" формы
//
Процедура ОсновныеДействияФормыОК(Кнопка)

	СписокПроизводителей.Очистить();

	Для Каждого СтрокаДерева Из ДеревоПроизводители.Строки Цикл
		Если СтрокаДерева.Пометка Тогда
			СписокПроизводителей.Добавить(СтрокаДерева.ПроизводительСсылка);
		КонецЕсли;
	КонецЦикла;

	СтруктураВозвращаемыхЗначений = Новый Структура();
	СтруктураВозвращаемыхЗначений.Вставить("СписокПроизводителей", СписокПроизводителей);
	СтруктураВозвращаемыхЗначений.Вставить("Команда",        "ИзменениеПроизводителей");
	ОповеститьОВыборе(СтруктураВозвращаемыхЗначений);

КонецПроцедуры // ОсновныеДействияФормыОК()

// Процедура вызывается при нажатии кнопки "Установить все пометки" формы
//
Процедура ПанельТиповЦенСкидокКнопкаВыборатьВсе(Кнопка)

	Для Каждого СтрокаДерева Из ДеревоПроизводители.Строки Цикл
		СтрокаДерева.Пометка = Истина;
	КонецЦикла;

КонецПроцедуры // ПанельТиповЦенСкидокКнопкаВыборатьВсе()

// Процедура вызывается при нажатии кнопка "Снять все пометки" формы
//
Процедура ПанельТиповЦенСкидокКнопкаСнятьВсе(Кнопка)

	Для Каждого СтрокаДерева Из ДеревоПроизводители.Строки Цикл
		СтрокаДерева.Пометка = Ложь;
	КонецЦикла;

КонецПроцедуры // ПанельТиповЦенСкидокКнопкаСнятьВсе()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Обработчик события "ПриОткрытии" формы.
//
Процедура ПриОткрытии()

	ДеревоПроизводители.Колонки.Добавить("ПроизводительСсылка", Новый ОписаниеТипов("СправочникСсылка.Производители"));
	ДеревоПроизводители.Строки.ЗагрузитьКолонку(СписокПроизводителей.ВыгрузитьЗначения() ,"ПроизводительСсылка");

	// Заполнить пометки и строковое представление
	Для Каждого Производитель Из СписокПроизводителей Цикл
		НоваяСтрокаДерева = ДеревоПроизводители.Строки.Добавить();
		НоваяСтрокаДерева.Пометка            = Истина;
		НоваяСтрокаДерева.ПроизводительСсылка = Производитель.Значение;
		НоваяСтрокаДерева.ПроизводительСтрока = СокрЛП(Производитель.Значение);
	КонецЦикла;

	Выборка = Справочники["Производители"].Выбрать(Справочники.Производители.НайтиПоКоду("763"));//Диски
	Пока Выборка.Следующий() Цикл
		Если НЕ Выборка.ПометкаУдаления Тогда
			//Если ИмяСправочникаВыбора = "ТипыЦенНоменклатуры" И Выборка.Рассчитывается Тогда
			//	Продолжить;
			//КОнецЕсли;
			Если ДеревоПроизводители.Строки.Найти(Выборка.Ссылка) = Неопределено Тогда
				НоваяСтрокаДерева = ДеревоПроизводители.Строки.Добавить();
				НоваяСтрокаДерева.ПроизводительСсылка = Выборка.Ссылка;
				НоваяСтрокаДерева.ПроизводительСтрока = СокрЛП(Выборка);
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;

КонецПроцедуры // ПриОткрытии()

// Обработчик события "ПриЗакрытии" формы.
//
Процедура ПриЗакрытии()

	//СохранитьЗначение("ФормированиеЦен_ФормаВыбораТипаЦен_ФлажокПеремещения", ФлажокПеремещения);

КонецПроцедуры // ПриЗакрытии()

// Обработчик события "ОбновлениеОтображения" формы.
//
Процедура ОбновлениеОтображения()

	//ОтсортироватьДерево()

КонецПроцедуры

// Обработчик нажатия кнопки "Добавить новый тип цен" .
//
Процедура ПанельТиповЦенСкидокКнопкаДобавить(Кнопка)

КонецПроцедуры // ПанельТиповЦенСкидокКнопкаДобавить()







