
Процедура ПриОткрытии()
	
	Если ЭтоНовый() Тогда
		
		Дата = КонецМесяца(ТекущаяДата());
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("Должность", Справочники.ДолжностиОрганизаций.НайтиПоНаименованию("2. Менеджер по транспорту (прямого направления)"));
		Запрос.Текст = "ВЫБРАТЬ
		               |	СотрудникиДляРасчетаМотивации.Пользователь
		               |ИЗ
		               |	РегистрСведений.СотрудникиДляРасчетаМотивации КАК СотрудникиДляРасчетаМотивации
		               |ГДЕ
		               |	СотрудникиДляРасчетаМотивации.Должность = &Должность";
		Результат = Запрос.Выполнить().Выбрать();
		Пока Результат.Следующий() Цикл
			СтрТЧ = ДанныеПоСотрудникам.Добавить();
			СтрТЧ.Показатель = "Передача документов в бухгалтерию";
			СтрТЧ.Сотрудник = Результат.Пользователь;
			СтрТЧ.ЗначениеПоказателя = Ложь;
			
			СтрТЧ = ДанныеПоСотрудникам.Добавить();
			СтрТЧ.Показатель = "Своевременная подача транспортных средств";
			СтрТЧ.Сотрудник = Результат.Пользователь;
			СтрТЧ.ЗначениеПоказателя = 0;
		КонецЦикла;
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("Должность", Справочники.ДолжностиОрганизаций.НайтиПоНаименованию("4. Старший оператор"));
		Запрос.Текст = "ВЫБРАТЬ
		               |	СотрудникиДляРасчетаМотивации.Пользователь
		               |ИЗ
		               |	РегистрСведений.СотрудникиДляРасчетаМотивации КАК СотрудникиДляРасчетаМотивации
		               |ГДЕ
		               |	СотрудникиДляРасчетаМотивации.Должность = &Должность";
		Результат = Запрос.Выполнить().Выбрать();
		Пока Результат.Следующий() Цикл
			СтрТЧ = ДанныеПоСотрудникам.Добавить();
			СтрТЧ.Показатель = "Отсутствие нареканий";
			СтрТЧ.Сотрудник = Результат.Пользователь;
			СтрТЧ.ЗначениеПоказателя = 0;
			
			СтрТЧ = ДанныеПоСотрудникам.Добавить();
			СтрТЧ.Показатель = "Закрытие заявок на возврат/брак";
			СтрТЧ.Сотрудник = Результат.Пользователь;
			СтрТЧ.ЗначениеПоказателя = 0;
			
			СтрТЧ = ДанныеПоСотрудникам.Добавить();
			СтрТЧ.Показатель = "Своевременная обработка долговых документов";
			СтрТЧ.Сотрудник = Результат.Пользователь;
			СтрТЧ.ЗначениеПоказателя = 0;
		КонецЦикла;
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("Должность", Справочники.ДолжностиОрганизаций.НайтиПоНаименованию("5. Оператор"));
		Запрос.Текст = "ВЫБРАТЬ
		               |	СотрудникиДляРасчетаМотивации.Пользователь
		               |ИЗ
		               |	РегистрСведений.СотрудникиДляРасчетаМотивации КАК СотрудникиДляРасчетаМотивации
		               |ГДЕ
		               |	СотрудникиДляРасчетаМотивации.Должность = &Должность";
		Результат = Запрос.Выполнить().Выбрать();
		Пока Результат.Следующий() Цикл
			СтрТЧ = ДанныеПоСотрудникам.Добавить();
			СтрТЧ.Показатель = "Отсутствие нареканий";
			СтрТЧ.Сотрудник = Результат.Пользователь;
			СтрТЧ.ЗначениеПоказателя = 0;
			
			СтрТЧ = ДанныеПоСотрудникам.Добавить();
			СтрТЧ.Показатель = "Закрытие заявок на возврат/брак";
			СтрТЧ.Сотрудник = Результат.Пользователь;
			СтрТЧ.ЗначениеПоказателя = 0;
			
			СтрТЧ = ДанныеПоСотрудникам.Добавить();
			СтрТЧ.Показатель = "Своевременная обработка долговых документов";
			СтрТЧ.Сотрудник = Результат.Пользователь;
			СтрТЧ.ЗначениеПоказателя = 0;
		КонецЦикла;
		
		Запрос = Новый Запрос;
		Запрос.Текст = "ВЫБРАТЬ
		               |	СотрудникиДляРасчетаМотивации.Пользователь
		               |ИЗ
		               |	РегистрСведений.СотрудникиДляРасчетаМотивации КАК СотрудникиДляРасчетаМотивации";
		Результат = Запрос.Выполнить().Выбрать();
		Пока Результат.Следующий() Цикл
			СтрТЧ = ДанныеПоСотрудникам.Добавить();
			СтрТЧ.Сотрудник = Результат.Пользователь;
			СтрТЧ.ЗначениеПоказателя = 0;
		КонецЦикла;
	КонецЕсли;
	
	УстановитьОтборИВидимостьОбъектов();

КонецПроцедуры

Процедура УстановитьОтборИВидимостьОбъектов()
	
	ЭлементыФормы.ДанныеПоСотрудникамПередачаДокументов.ОтборСтрок.Показатель.Использование = Истина;
	ЭлементыФормы.ДанныеПоСотрудникамПередачаДокументов.ОтборСтрок.Показатель.ВидСравнения = ВидСравнения.Равно;
	ЭлементыФормы.ДанныеПоСотрудникамПередачаДокументов.ОтборСтрок.Показатель.Значение = "Передача документов в бухгалтерию"; 
	
	ЭлементыФормы.ДанныеПоСотрудникамСвоевременнаяПодачаТС.ОтборСтрок.Показатель.Использование = Истина;
	ЭлементыФормы.ДанныеПоСотрудникамСвоевременнаяПодачаТС.ОтборСтрок.Показатель.ВидСравнения = ВидСравнения.Равно;
	ЭлементыФормы.ДанныеПоСотрудникамСвоевременнаяПодачаТС.ОтборСтрок.Показатель.Значение = "Своевременная подача транспортных средств"; 
	
	ЭлементыФормы.ДанныеПоСотрудникамОтсутствиеНареканий.ОтборСтрок.Показатель.Использование = Истина;
	ЭлементыФормы.ДанныеПоСотрудникамОтсутствиеНареканий.ОтборСтрок.Показатель.ВидСравнения = ВидСравнения.Равно;
	ЭлементыФормы.ДанныеПоСотрудникамОтсутствиеНареканий.ОтборСтрок.Показатель.Значение = "Отсутствие нареканий"; 
	
	ЭлементыФормы.ДанныеПоСотрудникамЗакрытиеЗаявок.ОтборСтрок.Показатель.Использование = Истина;
	ЭлементыФормы.ДанныеПоСотрудникамЗакрытиеЗаявок.ОтборСтрок.Показатель.ВидСравнения = ВидСравнения.Равно;
	ЭлементыФормы.ДанныеПоСотрудникамЗакрытиеЗаявок.ОтборСтрок.Показатель.Значение = "Закрытие заявок на возврат/брак"; 
	
	ЭлементыФормы.ДанныеПоСотрудникамСвоевременнаяОбработкаДокументов.ОтборСтрок.Показатель.Использование = Истина;
	ЭлементыФормы.ДанныеПоСотрудникамСвоевременнаяОбработкаДокументов.ОтборСтрок.Показатель.ВидСравнения = ВидСравнения.Равно;
	ЭлементыФормы.ДанныеПоСотрудникамСвоевременнаяОбработкаДокументов.ОтборСтрок.Показатель.Значение = "Своевременная обработка долговых документов"; 
	
	ЭлементыФормы.ДанныеПоСотрудникамДепремирование.ОтборСтрок.Показатель.Использование = Истина;
	ЭлементыФормы.ДанныеПоСотрудникамДепремирование.ОтборСтрок.Показатель.ВидСравнения = ВидСравнения.НеВСписке;
	СписокИсключений = Новый СписокЗначений;
	СписокИсключений.Добавить("Передача документов в бухгалтерию");
	СписокИсключений.Добавить("Своевременная подача транспортных средств");
	СписокИсключений.Добавить("Отсутствие нареканий");
	СписокИсключений.Добавить("Закрытие заявок на возврат/брак");
	СписокИсключений.Добавить("Своевременная обработка долговых документов");
	ЭлементыФормы.ДанныеПоСотрудникамДепремирование.ОтборСтрок.Показатель.Значение = СписокИсключений; 
	
КонецПроцедуры


Процедура ДатаПриИзменении(Элемент)
	
	Дата = КонецМесяца(Дата);
	
КонецПроцедуры


Процедура ДанныеПоСотрудникамДепремированиеЗначениеПоказателяПриИзменении(Элемент)
	
	ТекДанные = ЭлементыФормы.ДанныеПоСотрудникамДепремирование.ТекущиеДанные;
	Если ТекДанные.ЗначениеПоказателя > 0 Тогда
		ТекДанные.ЗначениеПоказателя = ТекДанные.ЗначениеПоказателя * (-1);
	КонецЕсли;
	
КонецПроцедуры

