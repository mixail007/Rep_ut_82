
Процедура ПриОткрытии()
	Если не РольДоступна("ПолныеПрава")тогда 
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ДоговорыКонтрагентов.Владелец КАК Контрагент
		|ИЗ
		|	Справочник.ДоговорыКонтрагентов КАК ДоговорыКонтрагентов
		|ГДЕ
		|	ДоговорыКонтрагентов.ТипДоговора = ЗНАЧЕНИЕ(Справочник.типыДоговоров.ПеремещениеОТХ)
		|	И ДоговорыКонтрагентов.ОтветственноеЛицо = &ОтветственноеЛицо";
		
		Запрос.УстановитьПараметр("ОтветственноеЛицо", глТекущийПользователь);
		
		Результат = Запрос.Выполнить().Выгрузить();
		
		СписокКонтрагентов  = Результат.ВыгрузитьКолонку("Контрагент");
		списокЗ = Новый СписокЗначений;
		СписокЗ.ЗагрузитьЗначения(СписокКонтрагентов);
		Список.Отбор["Контрагент"].Использование = Истина;
		Список.Отбор["Контрагент"].ВидСравнения = ВидСравнения.ВСписке;
		Список.Отбор["Контрагент"].Значение = СписокЗ;
		ЭлементыФормы.Список.НастройкаОтбора["Контрагент"].Доступность = Ложь;
	конецесли;	
КонецПроцедуры

Процедура ДействияФормыСтруктураПодчиненностиДокумента(Кнопка)
	Если ЭлементыФормы.Список.ТекущиеДанные = Неопределено тогда
		Возврат
	КонецЕсли;
	
	ПоказатьСтруктуруПодчиненностиДокумента(ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока);

КонецПроцедуры
