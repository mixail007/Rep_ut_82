
Процедура ОсновныеДействияФормыОК(Кнопка)
		ОповеститьОВыборе(ТаблицаОстатков);
КонецПроцедуры

Процедура ПриОткрытии()

	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ТоварыПереданныеОстатки.Номенклатура.Код КАК Код,
		|	ТоварыПереданныеОстатки.Номенклатура,
		|	СУММА(ТоварыПереданныеОстатки.КоличествоОстаток) КАК Остаток,
		|	0 КАК Количество,
		|	ТоварыПереданныеОстатки.Номенклатура.Артикул КАК Артикул
		|ИЗ
		|	РегистрНакопления.ТоварыПереданные.Остатки(
		|			&ДатаНач,
		|			ДоговорКонтрагента.Владелец = &Контрагент
		|				И ДоговорКонтрагента.ТипДоговора = ЗНАЧЕНИЕ(справочник.типыдоговоров.ПеремещениеОТХ)) КАК ТоварыПереданныеОстатки
		|
		|СГРУППИРОВАТЬ ПО
		|	ТоварыПереданныеОстатки.Номенклатура,
		|	ТоварыПереданныеОстатки.Номенклатура.Код";

	Запрос.УстановитьПараметр("ДатаНач", ДатаПО);
	Запрос.УстановитьПараметр("Контрагент", Контрагент);

	Результат = Запрос.Выполнить();

	ТаблицаОстатков = Результат.Выгрузить();
	
КонецПроцедуры
