// Процедура - обработчик события "ПриОткрытии" формы
//
Процедура ПриОткрытии()
	 УстановитьОтборВЖурналеДокументов(ДокументСписок.Отбор, ЭлементыФормы.Список,,Ложь);
	Если ПолучитьЗначениеПоУмолчанию(глТекущийПользователь, "ОграниченныйИнтерфейс") = Истина Тогда

		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ДоговорыКонтрагентов.Ссылка
		|ИЗ
		|	Справочник.ДоговорыКонтрагентов КАК ДоговорыКонтрагентов
		|ГДЕ
		|	НЕ ДоговорыКонтрагентов.Наименование ПОДОБНО ""%*%""
		|	И 99 = 99
		|	И 98 = 98
		|	И ДоговорыКонтрагентов.Организация = &Организация";
		
		Запрос.УстановитьПараметр("Организация",Справочники.Организации.НайтиПоКоду("00001"));	
		
		Если Отбор["ДокументыПоДоговоруКонтрагента"].Использование  = Истина Тогда
			СписокДоступныхДоговоров =Отбор["ДокументыПоДоговоруКонтрагента"].Значение; 
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"99 = 99","ДоговорыКонтрагентов.Ссылка В(&СписокДоговоров)");	
			Запрос.УстановитьПараметр("СписокДоговоров",СписокДоступныхДоговоров);	
		КонецЕсли;
		Если Отбор["ДокументыПоКонтрагенту"].Использование  = Истина Тогда
			СписокДоступныхКонтрагентов =Отбор["ДокументыПоКонтрагенту"].Значение; 
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"98 = 98","ДоговорыКонтрагентов.Владелец В(&СписокКонтрагентов)");	
			Запрос.УстановитьПараметр("СписокКонтрагентов",СписокДоступныхКонтрагентов);	
		КонецЕсли;
		Результат = Запрос.Выполнить().Выгрузить();
		СписокДоговоровМенеджера = Новый СписокЗначений;
		СписокДоговоровМенеджера.ЗагрузитьЗначения(Результат.ВыгрузитьКолонку("Ссылка"));
		Отбор["ДокументыПоДоговоруКонтрагента"].Использование = Истина;
		Отбор["ДокументыПоДоговоруКонтрагента"].ВидСравнения = ВидСравнения.ВСписке;
		Отбор["ДокументыПоДоговоруКонтрагента"].Значение = СписокДоговоровМенеджера;
		ЭлементыФормы.Список.НастройкаОтбора["ДокументыПоДоговоруКонтрагента"].Доступность = Ложь;
		
		
		Отбор["Подразделение"].Использование = Ложь;
		Отбор["Подразделение"].ВидСравнения = ВидСравнения.Равно;
		Отбор["Подразделение"].Значение = Справочники.Подразделения.ПустаяСсылка() ;
		ЭлементыФормы.Список.НастройкаОтбора["Подразделение"].Доступность = Ложь;
		
	конецесли;	
	

	 
	 
КонецПроцедуры

// Процедура вызывается при выборе пункта подменю "Движения документа по регистрам" меню "Перейти".
// командной панели формы. Процедура отрабатывает печать движений документа по регистрам.
//
Процедура ДействияФормыДвиженияДокументаПоРегистрам(Кнопка)

	Если ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока = Неопределено тогда
		Возврат
	КонецЕсли;

	НапечататьДвиженияДокумента(ЭлементыФормы.Список.ТекущиеДанные.Ссылка);

КонецПроцедуры // ДействияФормыДвиженияДокументаПоРегистрам()

// Процедура вызывается при выборе пункта подменю "Структура подчиненности" меню "Перейти".
Процедура ДействияФормыСтруктураПодчиненностиДокумента(Кнопка)
	
	Если ЭлементыФормы.Список.ТекущиеДанные = Неопределено тогда
		Возврат
	КонецЕсли;
	
	ПоказатьСтруктуруПодчиненностиДокумента(ЭтаФорма.ЭлементыФормы.Список.ТекущаяСтрока);
	
КонецПроцедуры