
Процедура ЗакрытиеСтарыхУстановок( Движения )
		Движение = Движения.РазрешениеПоРезерву.Добавить();
		Движение.Период = Дата;
		Движение.КонтрагентРезерв = КонтрагентРезерв;
		
		Движение.ВариантКод = усл.ВариантКод;
		Движение.ВидТовара  = усл.ВидТовара;
		Движение.НоменклатурнаяГруппа = усл.НоменклатурнаяГруппа;
КонецПроцедуры


Процедура ОбработкаПроведения(Отказ, Режим)

	// регистр РазрешениеПоРезерву
	Движения.РазрешениеПоРезерву.Записывать = Истина;
	Движения.РазрешениеПоРезерву.Очистить();
	
	ЗакрытиеСтарыхУстановок(Движения);	

	Для Каждого ТекСтрокаКонтрагенты Из Контрагенты Цикл
		Для Каждого усл Из Условия Цикл
			
		Движение = Движения.РазрешениеПоРезерву.Добавить();
		Движение.Период = Дата;
		Движение.КонтрагентРезерв = КонтрагентРезерв;
		
		Движение.ВариантКод = усл.ВариантКод;
		Движение.ВидТовара  = усл.ВидТовара;
		Движение.НоменклатурнаяГруппа = усл.НоменклатурнаяГруппа;
		
		КонецЦикла;	
	КонецЦикла;

КонецПроцедуры

