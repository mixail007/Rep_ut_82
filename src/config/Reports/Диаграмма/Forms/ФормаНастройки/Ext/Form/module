
////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

// Процедура изменяет доступность контрола КоличествоОграничения и его надписей
// в зависимости от значения реквизита ОграничениеСерий
Процедура ДоступностьКоличествоОграничения()

	Если ОграничениеСерий = МаксимумСерий.НеЗадано ИЛИ ОграничениеСерий = Неопределено Тогда
		ЭлементыФормы.КоличествоОграничения.Доступность                     = Ложь;
		ЭлементыФормы.НадписьПослеЗначенияКоличествоОграничения.Доступность = Ложь;
		ЭлементыФормы.НадписьДоЗначенияКоличествоОграничения.Доступность    = Ложь;
	Иначе
		ЭлементыФормы.КоличествоОграничения.Доступность                     = Истина;
		ЭлементыФормы.НадписьПослеЗначенияКоличествоОграничения.Доступность = Истина;
		ЭлементыФормы.НадписьДоЗначенияКоличествоОграничения.Доступность    = Истина;
	КонецЕсли; 

КонецПроцедуры

// Процедура отображает необходимую страницу панели для настройки параметров диаграммы.
//
Процедура ОпределитьЗакладкуДляТипаДиаграммы()

	Если ТекущийТипДиаграммы = ТипДиаграммы.График Тогда
		ЭлементыФормы.ПанельНастройки.ТекущаяСтраница = ЭлементыФормы.ПанельНастройки.Страницы.График;
	ИначеЕсли ТекущийТипДиаграммы = ТипДиаграммы.ГрафикСОбластями ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ГрафикСОбластямиИНакоплением Тогда
		ЭлементыФормы.ПанельНастройки.ТекущаяСтраница = ЭлементыФормы.ПанельНастройки.Страницы.ГрафикСЗаливкой;
	ИначеЕсли ТекущийТипДиаграммы = ТипДиаграммы.Круговая Тогда
		ЭлементыФормы.ПанельНастройки.ТекущаяСтраница = ЭлементыФормы.ПанельНастройки.Страницы.Круговая;
	ИначеЕсли ТекущийТипДиаграммы = ТипДиаграммы.КруговаяОбъемная Тогда
		ЭлементыФормы.ПанельНастройки.ТекущаяСтраница = ЭлементыФормы.ПанельНастройки.Страницы.КруговаяОбъемная;
	ИначеЕсли ТекущийТипДиаграммы = ТипДиаграммы.Гистограмма ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ГистограммаСНакоплением
		  ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ГистограммаГоризонтальная ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ГистограммаСНакоплениемГоризонтальная Тогда
		ЭлементыФормы.ПанельНастройки.ТекущаяСтраница = ЭлементыФормы.ПанельНастройки.Страницы.ГистограммаПлоская;
	ИначеЕсли ТекущийТипДиаграммы = ТипДиаграммы.ГистограммаОбъемная ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ГистограммаСНакоплениемОбъемная
		  ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ГистограммаГоризонтальнаяОбъемная ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ГистограммаСНакоплениемГоризонтальнаяОбъемная Тогда
		ЭлементыФормы.ПанельНастройки.ТекущаяСтраница = ЭлементыФормы.ПанельНастройки.Страницы.ГистограммаОбъемная;
	ИначеЕсли ТекущийТипДиаграммы = ТипДиаграммы.Изометрическая ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ИзометрическаяПирамида
		  ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ИзометрическаяНепрерывная ИЛИ ТекущийТипДиаграммы = ТипДиаграммы.ИзометрическаяЛента Тогда
		ЭлементыФормы.ПанельНастройки.ТекущаяСтраница = ЭлементыФормы.ПанельНастройки.Страницы.Изометрическая;
	КонецЕсли; 
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Обработчик события ПриОткрытии формы.
//
Процедура ПриОткрытии()
	
	// Типы диаграмм
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.График                                       , "График");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ГрафикСОбластями                             , "График с областями");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ГрафикСОбластямиИНакоплением                 , "График с областями и накоплением");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.Круговая                                     , "Круговая");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.КруговаяОбъемная                             , "Круговая объемная");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.Гистограмма                                  , "Гистограмма");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ГистограммаОбъемная                          , "Гистограмма объемная");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ГистограммаСНакоплением                      , "Гистограмма с накоплением");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ГистограммаСНакоплениемОбъемная              , "Гистограмма с накоплением объемная");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ГистограммаГоризонтальная                    , "Гистограмма горизонтальная");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ГистограммаСНакоплениемГоризонтальная        , "Гистограмма горизонтальная с накоплением");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ГистограммаГоризонтальнаяОбъемная            , "Гистограмма горизонтальная объемная");
	ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ГистограммаСНакоплениемГоризонтальнаяОбъемная, "Гистограмма горизонтальная объемная с накоплением");
	
	Если ТаблицаИсходныхДанных.Колонки.Количество() > 2 Тогда
		ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.Изометрическая              , "Изометрическая");
		ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ИзометрическаяПирамида      , "Изометрическая пирамида");
		ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ИзометрическаяНепрерывная   , "Изометрическая непрерывная");
		ЭлементыФормы.ТекущийТипДиаграммы.СписокВыбора.Добавить(ТипДиаграммы.ИзометрическаяЛента         , "Изометрическая лента");
	КонецЕсли;
	
	//Ограничение в отображении серий диаграммы
	ЭлементыФормы.ОграничениеСерий.СписокВыбора.Добавить(МаксимумСерий.НеЗадано  , "Не ограничивать");
	ЭлементыФормы.ОграничениеСерий.СписокВыбора.Добавить(МаксимумСерий.Ограничено, "Ограничивать количество");
	ЭлементыФормы.ОграничениеСерий.СписокВыбора.Добавить(МаксимумСерий.Процент   , "Ограничивать процент");
	
	// Закладка круговая диаграмма плоская
	ЭлементыФормы.ВидПодписиКруговойДиаграммы.СписокВыбора.Добавить(ВидПодписейКДиаграмме.Нет                 , "Нет");
	ЭлементыФормы.ВидПодписиКруговойДиаграммы.СписокВыбора.Добавить(ВидПодписейКДиаграмме.Значение            , "Значение");
	ЭлементыФормы.ВидПодписиКруговойДиаграммы.СписокВыбора.Добавить(ВидПодписейКДиаграмме.ЗначениеПроцент     , "Значение + процент");
	ЭлементыФормы.ВидПодписиКруговойДиаграммы.СписокВыбора.Добавить(ВидПодписейКДиаграмме.Процент             , "Процент");
	ЭлементыФормы.ВидПодписиКруговойДиаграммы.СписокВыбора.Добавить(ВидПодписейКДиаграмме.Серия               , "Имя серии");
	ЭлементыФормы.ВидПодписиКруговойДиаграммы.СписокВыбора.Добавить(ВидПодписейКДиаграмме.СерияЗначение       , "Имя серии + значение");
	ЭлементыФормы.ВидПодписиКруговойДиаграммы.СписокВыбора.Добавить(ВидПодписейКДиаграмме.СерияЗначениеПроцент, "Имя серии + значение + процент");
	ЭлементыФормы.ВидПодписиКруговойДиаграммы.СписокВыбора.Добавить(ВидПодписейКДиаграмме.СерияПроцент        , "Имя серии + процент");
	
	ЭлементыФормы.АвтоматическоеРаздвижениеСекторов.СписокВыбора.Добавить(АвтоРаздвижениеСерий.Все     , "Все");
	ЭлементыФормы.АвтоматическоеРаздвижениеСекторов.СписокВыбора.Добавить(АвтоРаздвижениеСерий.Максимум, "Максимум");
	ЭлементыФормы.АвтоматическоеРаздвижениеСекторов.СписокВыбора.Добавить(АвтоРаздвижениеСерий.Минимум , "Минимум");
	ЭлементыФормы.АвтоматическоеРаздвижениеСекторов.СписокВыбора.Добавить(АвтоРаздвижениеСерий.Нет     , "Нет");
	
	// Закладка круговая диаграмма объемная
	ЭлементыФормы.ВидПодписиКруговойДиаграммыОбъемная.СписокВыбора.Добавить(ВидПодписейКДиаграмме.Нет                 , "Нет");
	ЭлементыФормы.ВидПодписиКруговойДиаграммыОбъемная.СписокВыбора.Добавить(ВидПодписейКДиаграмме.Значение            , "Значение");
	ЭлементыФормы.ВидПодписиКруговойДиаграммыОбъемная.СписокВыбора.Добавить(ВидПодписейКДиаграмме.ЗначениеПроцент     , "Значение + процент");
	ЭлементыФормы.ВидПодписиКруговойДиаграммыОбъемная.СписокВыбора.Добавить(ВидПодписейКДиаграмме.Процент             , "Процент");
	ЭлементыФормы.ВидПодписиКруговойДиаграммыОбъемная.СписокВыбора.Добавить(ВидПодписейКДиаграмме.Серия               , "Имя серии");
	ЭлементыФормы.ВидПодписиКруговойДиаграммыОбъемная.СписокВыбора.Добавить(ВидПодписейКДиаграмме.СерияЗначение       , "Имя серии + значение");
	ЭлементыФормы.ВидПодписиКруговойДиаграммыОбъемная.СписокВыбора.Добавить(ВидПодписейКДиаграмме.СерияЗначениеПроцент, "Имя серии + значение + процент");
	ЭлементыФормы.ВидПодписиКруговойДиаграммыОбъемная.СписокВыбора.Добавить(ВидПодписейКДиаграмме.СерияПроцент        , "Имя серии + процент");
	
	ЭлементыФормы.АвтоматическоеРаздвижениеСекторовОбъемная.СписокВыбора.Добавить(АвтоРаздвижениеСерий.Все     , "Все");
	ЭлементыФормы.АвтоматическоеРаздвижениеСекторовОбъемная.СписокВыбора.Добавить(АвтоРаздвижениеСерий.Максимум, "Максимум");
	ЭлементыФормы.АвтоматическоеРаздвижениеСекторовОбъемная.СписокВыбора.Добавить(АвтоРаздвижениеСерий.Минимум , "Минимум");
	ЭлементыФормы.АвтоматическоеРаздвижениеСекторовОбъемная.СписокВыбора.Добавить(АвтоРаздвижениеСерий.Нет     , "Нет");
	
	// Гистонрамма плоская
	ЭлементыФормы.РежимПробеловГистограмма.СписокВыбора.Добавить(РежимПробеловДиаграммы.Нет           , "Нет");
	ЭлементыФормы.РежимПробеловГистограмма.СписокВыбора.Добавить(РежимПробеловДиаграммы.ПолнаяШирина  , "Полная ширина");
	ЭлементыФормы.РежимПробеловГистограмма.СписокВыбора.Добавить(РежимПробеловДиаграммы.ПоловинаШирины, "Половина ширины");
	
	// Гистонрамма объемная
	ЭлементыФормы.РежимПробеловГистограммаОбъемная.СписокВыбора.Добавить(РежимПробеловДиаграммы.Нет           , "Нет");
	ЭлементыФормы.РежимПробеловГистограммаОбъемная.СписокВыбора.Добавить(РежимПробеловДиаграммы.ПолнаяШирина  , "Полная ширина");
	ЭлементыФормы.РежимПробеловГистограммаОбъемная.СписокВыбора.Добавить(РежимПробеловДиаграммы.ПоловинаШирины, "Половина ширины");
	
	// Изометрическая
	ЭлементыФормы.ОриентацияИзометрическая.СписокВыбора.Добавить(ОриентацияДиаграммы.ЮгВосток, "Юг-Восток");
	ЭлементыФормы.ОриентацияИзометрическая.СписокВыбора.Добавить(ОриентацияДиаграммы.ЮгЗапад , "Юг-Запад");
	
	ЭлементыФормы.РежимПробеловИзометрическая.СписокВыбора.Добавить(РежимПробеловДиаграммы.Нет           , "Нет");
	ЭлементыФормы.РежимПробеловИзометрическая.СписокВыбора.Добавить(РежимПробеловДиаграммы.ПолнаяШирина  , "Полная ширина");
	ЭлементыФормы.РежимПробеловИзометрическая.СписокВыбора.Добавить(РежимПробеловДиаграммы.ПоловинаШирины, "Половина ширины");
	
	// Заполним значения контролов
	ЗаполнитьЗначенияКонтролов(КонтролДиаграмма);
	
	ДоступностьКоличествоОграничения();
	
	ОпределитьЗакладкуДляТипаДиаграммы();
	
КонецПроцедуры

// Обработчик события ОбновлениеОтображения формы.
//
Процедура ОбновлениеОтображения()
	
	УстановитьСвойстваДиаграммы(КонтролДиаграмма);
	
	ЭтаФорма.ВладелецФормы.СостояниеКнопкиТранспонирования();
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ФОРМЫ

// Обработчик события ПриИзменении элемента формы ОграничениеСерий.
//
Процедура ОграничениеСерийПриИзменении(Элемент)
	
	ДоступностьКоличествоОграничения();
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы ТекущийТипДиаграммы.
//
Процедура ТекущийТипДиаграммыПриИзменении(Элемент)
	
	ОпределитьЗакладкуДляТипаДиаграммы();
	
КонецПроцедуры
