
Процедура ПриОткрытии()
Если ПолучитьЗначениеПоУмолчанию(ПараметрыСеанса.ТекущийПользователь, "УчетТолькоПоПодразделениюПользователя") Тогда
ЭлементОтбора = ЭтотОбъект.КомпоновщикНастроек.ФиксированныеНастройки.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("Документ.Подразделение");
ЭлементОтбора.ВидСравнения=ВидСравненияКомпоновкиДанных.Равно;
ЭлементОтбора.ПравоеЗначение =ПараметрыСеанса.ТекущийПользователь.ОсновноеПодразделение;
ЭлементОтбора.Использование=Истина;
ЭлементОтбора.РежимОтображения=РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Недоступный;
конецЕсли;
УстановитьВариантыНастроек();
КонецПроцедуры

Процедура _СменаВариантаНастройки (Элемент)

Для каждого Настройка Из СхемаКомпоновкиДанных.ВариантыНастроек Цикл

Если Элемент.Текст = Настройка.Представление тогда

КомпоновщикНастроек.ЗагрузитьНастройки(Настройка.Настройки);
ЭлементыФормы.ДействияФормы.Кнопки._ВариантыОтчетов.Текст= Настройка.Представление;
Прервать;

КонецЕсли;

КонецЦикла;

КонецПроцедуры

Процедура УстановитьВариантыНастроек()

КП = ЭлементыФормы.ДействияФормы;
НоваяКнопка = КП.Кнопки.Вставить(1,"_ВариантыОтчетов", ТипКнопкиКоманднойПанели.Подменю, "Ответственные", );
НовоеДействие = Новый Действие("_СменаВариантаНастройки"); ч = 1;

Для каждого Настройка Из СхемаКомпоновкиДанных.ВариантыНастроек Цикл

НоваяКнопка = КП.Кнопки._ВариантыОтчетов.Кнопки.Добавить("Вариант"+Строка(ч), ТипКнопкиКоманднойПанели.Действие, Настройка.Представление, НовоеДействие); ч = ч + 1;

КонецЦикла;

КонецПроцедуры

