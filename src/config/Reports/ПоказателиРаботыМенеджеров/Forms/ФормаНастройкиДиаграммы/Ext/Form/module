
// Обработчик события Нажатие элемента ОсновныеДействияФормы.ОК.
//
Процедура ОсновныеДействияФормыОК(Элемент)
	
	СтрокаПоказателя = ПоказателиДиаграммы.Найти(Истина, "Использование");
	Если СтрокаПоказателя = Неопределено Тогда
		Предупреждение("Выберите показатель для построения диаграммы.");
		Возврат;
	КонецЕсли; 
	
	ТаблицаДиаграммы = мСтруктураТаблицДанныхДиаграммы[СтрокаПоказателя.Имя].ТаблицаДанных;
	
	Для каждого СтрокаТаблицы Из ТаблицаДиаграммы Цикл
		Если ЗначениеНеЗаполнено(СтрокаТаблицы.Объект) Тогда
			СтрокаТаблицы.Объект = "<...>";
		КонецЕсли; 
	КонецЦикла; 
	
	ОтчетДиаграмма = Отчеты.Диаграмма.Создать();
	ОтчетДиаграмма.ТаблицаИсходныхДанных = ТаблицаДиаграммы;
	
	ОтчетДиаграмма.ИмяДиаграммы = "Показатели работы менеджеров, " + СформироватьСтрокуПериода() + ", " + мСтруктураТаблицДанныхДиаграммы[СтрокаПоказателя.Имя].Представление;
	ОтчетДиаграмма.НастройкиДиаграммы = НастройкиДиаграммы;
	
	ФормаОтчета = ОтчетДиаграмма.ПолучитьФорму(, Этаформа.ВладелецФормы);
	
	ОтчетДиаграмма.ПостроитьДиаграмму(ФормаОтчета.ЭлементыФормы.Диаграмма);
	
	ЭтаФорма.Закрыть();
	
	ФормаОтчета.Открыть();
	
КонецПроцедуры

// Обработчик события ПриОткрытии Формы.
//
Процедура ПриОткрытии()
	
	Для каждого ЭлементСтруктуры Из мСтруктураТаблицДанныхДиаграммы Цикл
		НовыйПоказатель = ПоказателиДиаграммы.Добавить();
		НовыйПоказатель.Имя = ЭлементСтруктуры.Ключ;
		НовыйПоказатель.Представление = ЭлементСтруктуры.Значение.Представление;
	КонецЦикла;
	
	Если ПоказателиДиаграммы.Количество() > 0 Тогда
		ПоказателиДиаграммы[0].Использование = Истина;
	КонецЕсли; 
	
КонецПроцедуры

// Обработчик события ПередНачаломДобавления элемента Формы ПоказателиДиаграммы.
//
Процедура ПоказателиДиаграммыПередНачаломДобавления(Элемент, Отказ, Копирование)
	
	Отказ = Истина;
	
КонецПроцедуры

// Обработчик события ПередУдалением элемента Формы ПоказателиДиаграммы.
//
Процедура ПоказателиДиаграммыПередУдалением(Элемент, Отказ)
	
	Отказ = Истина;
	
КонецПроцедуры

// Обработчик события ПриИзмененииФлажка элемента формы ПоказателиДиаграммы.
//
Процедура ПоказателиДиаграммыПриИзмененииФлажка(Элемент, Колонка)
	
	Для каждого СтрокаТаблицы Из ПоказателиДиаграммы Цикл
		Если СтрокаТаблицы <> ЭлементыФормы.ПоказателиДиаграммы.ТекущаяСтрока Тогда
			СтрокаТаблицы.Использование = Ложь;
		КонецЕсли; 
	КонецЦикла; 
	
КонецПроцедуры

ПоказателиДиаграммы.Колонки.Добавить("Имя" , Новый ОписаниеТипов("Строка"));
