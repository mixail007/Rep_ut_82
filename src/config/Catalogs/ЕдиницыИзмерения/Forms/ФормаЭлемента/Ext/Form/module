
// Процедура - обработчик события "ПередОткрытием" формы
//
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)

	Если ЭтоНовый() Тогда

		Если Коэффициент = 0 Тогда
			Коэффициент = 1;
		КонецЕсли;

		Если ЗначениеНеЗаполнено(ЕдиницаПоКлассификатору) Тогда
			ЕдиницаПоКлассификатору = ПолучитьЗначениеПоУмолчанию(глТекущийПользователь, "ОсновнаяЕдиницаПоКлассификатору");
		КонецЕсли;

		ЭтотОбъект.УстановитьНовыйКод(Константы.ПрефиксКодаЕдиниц.Получить());  //+++ 18.05.2012
		
	КонецЕсли;

КонецПроцедуры

// Обработчик события ПриОткрытии для Формы.
//
Процедура ПриОткрытии()

	ЕдиницаИзмеренияВеса = Константы.ЕдиницаИзмеренияВеса.Получить();
	Если ЗначениеНеЗаполнено(ЕдиницаИзмеренияВеса) Тогда
		ЭлементыФормы.НадписьВес.Заголовок = "Вес";
	Иначе
		ЭлементыФормы.НадписьВес.Заголовок = "Вес (" + ЕдиницаИзмеренияВеса.Наименование +")";
	КонецЕсли;

	ЕдиницаИзмеренияОбъема = Константы.ЕдиницаИзмеренияОбъема.Получить();
	Если ЗначениеНеЗаполнено(ЕдиницаИзмеренияОбъема) Тогда
		ЭлементыФормы.НадписьОбъем.Заголовок = "Объем";
	Иначе
		ЭлементыФормы.НадписьОбъем.Заголовок = "Объем (" + ЕдиницаИзмеренияОбъема.Наименование +")";
	КонецЕсли;

КонецПроцедуры // ПриОткрытии()

Процедура ЕдиницаПоКлассификаторуПриИзменении(Элемент)
	
	Наименование = ЕдиницаПоКлассификатору.Наименование;
	
КонецПроцедуры

Процедура ОсновныеДействияФормыДействиеЗаполнитьВес(Кнопка)
	Запрос=Новый Запрос;
	Запрос.Текст="ВЫБРАТЬ
	             |	НормыЗагрузки.Ссылка,
	             |	НормыЗагрузки.Вес
	             |ИЗ
	             |	Справочник.НормыЗагрузки КАК НормыЗагрузки
	             |ГДЕ
	             |	НормыЗагрузки.Типоразмер = &Типоразмер
	             |	И НЕ НормыЗагрузки.Типоразмер = ЗНАЧЕНИЕ(Справочник.Типоразмеры.ПустаяСсылка)";
				 
	Запрос.УстановитьПараметр("Типоразмер",Владелец.Типоразмер.Ссылка);			 
	Выборка=Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		Если ЗначениеЗаполнено(Выборка.Вес) Тогда
		СправочникОбъект.Вес=Выборка.Вес;
		КонецЕсли;
	КонецЕсли;	
	
КонецПроцедуры

Процедура Кнопка2Нажатие(Элемент)
	 объем = ВычислитьОбъемНоменклатуры(Владелец, 3);
	 если объем>0 тогда
     	СправочникОбъект.объем = объем;
 	 иначе
	    Предупреждение("Объем не определяется автоматически.
					   |Проверьте параметры типоразмера товара.",30); 
	 КонецЕсли;				   
КонецПроцедуры

Процедура ДлинаПриИзменении(Элемент)
	ПересчитатьОбъемПоРазмеру();
КонецПроцедуры

Процедура ПересчитатьОбъемПоРазмеру()
	СправочникОбъект.Объем = СправочникОбъект.Длина/100*СправочникОбъект.Высота/100*СправочникОбъект.Ширина/100;
КонецПроцедуры

Процедура ШиринаПриИзменении(Элемент)
	ПересчитатьОбъемПоРазмеру();
КонецПроцедуры

Процедура ВысотаПриИзменении(Элемент)
	ПересчитатьОбъемПоРазмеру();
КонецПроцедуры






