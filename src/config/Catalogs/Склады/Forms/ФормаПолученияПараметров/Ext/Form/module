
Функция РеквизитыЗаполнены()
	
	ВсеОК = Истина;
	
	Если ПустаяСтрока(ЭлементыФормы.Наименование.Значение) Тогда
		ВсеОК = Ложь;
		Сообщить("Укажите наименование");
	КонецЕсли;
	
	Возврат ВсеОК;
	
КонецФункции // РеквизитыЗаполнены()

Процедура ОсновныеДействияФормыОтправитьНаСогласование(Кнопка)
	
	Если РеквизитыЗаполнены() Тогда
		СоздатьЗадачуДляСогласования();
		Закрыть();
	КонецЕсли;
	
КонецПроцедуры

Процедура ОсновныеДействияФормыДействиеОтказ(Кнопка)
	
	Закрыть();
	
КонецПроцедуры

Процедура СоздатьЗадачуДляСогласования()
	
	Структ = Новый Структура();
	
	НаименованиеСклада = ЭлементыФормы.Наименование.Значение;
	
	Структ.Вставить("Родитель"              , ЭлементыФормы.Родитель.Значение);
	Структ.Вставить("Наименование"          , НаименованиеСклада);
	Структ.Вставить("Транзитный"            , ЭлементыФормы.Транзитный.Значение);
	Структ.Вставить("ЗапретитьИспользование", ЭлементыФормы.ЗапретитьИспользование.Значение);
	Структ.Вставить("ТипСклада"             , ЭлементыФормы.ТипСклада.Значение);
	Структ.Вставить("Комментарий"           , ЭлементыФормы.Комментарий.Значение);	
	
	ДопПарам = Новый ХранилищеЗначения(Структ);
	
	зад = задачи.ЗадачиПользователя.СоздатьЗадачу();
	зад.Исполнитель = Справочники.Пользователи.НайтиПоКоду("Пелевин С.В.");
	зад.Инициатор   = глТекущийПользователь;
	
	зад.Дата = текущаяДата();
	зад.ДатаИсполнения = КонецДня( текущаяДата() );  // до конца дня - не просроченная задача
	зад.Оповещение = истина;
	зад.СрокОповещения = текущаяДата();
	зад.Объект = Справочники.Склады.ПустаяСсылка();
	
	//14.12.2015 ------- согласование в таблице-----------------
	зад.НаСогласование = истина;
	
	зад.Наименование = "Согласуйте создание нового склада """ + НаименованиеСклада + """";
 	зад.Описание =  зад.Наименование;
	
	зад.ДопПараметры = ДопПарам;
	
	зад.Записать();
	
КонецПроцедуры // СоздатьЗадачуДляСогласования()

Процедура ПриОткрытии()
	
	ВладелецТекСтр = ВладелецФормы.ЭлементыФормы.СправочникСписок.ТекущиеДанные;
	Если НЕ ВладелецТекСтр = Неопределено Тогда
		ЭлементыФормы.Родитель.Значение = ВладелецТекСтр.Родитель;
	КонецЕсли;
	
КонецПроцедуры
