// Обработчик события ПередОткрытием формы.
//
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)

	Если НЕ ЗначениеНеЗаполнено(ПараметрОтборПоВладельцу) Тогда

		Если НЕ ПараметрОтборПоВладельцу.ВестиУчетПоХарактеристикам Тогда

			Если ТипЗнч(ВладелецФормы) = Тип("Форма") Тогда
				Если ВладелецФормы.ЭлементыФормы.Найти("ФлажокВестиУчетПоХарактеристикам") <> Неопределено Тогда
					Если ВладелецФормы.ЭлементыФормы.ФлажокВестиУчетПоХарактеристикам.Значение Тогда
						ОтветПользователя = Вопрос("Перед работой с характеристиками необходимо записать элемент номенклатуры. Записать?",
						РежимДиалогаВопрос.ДаНетОтмена,,, "Вопрос");
						Если ОтветПользователя = КодВозвратаДиалога.Отмена 
							ИЛИ ОтветПользователя = КодВозвратаДиалога.Таймаут Тогда
							Отказ = Истина;
							Возврат;
						КонецЕсли;

						Если ОтветПользователя = КодВозвратаДиалога.Да Тогда
							Попытка
								ВладелецФормы.СправочникОбъект.Записать();
							Исключение
							КонецПопытки;
						КонецЕсли;

					КонецЕсли;
				КонецЕсли;
			КонецЕсли;

			Если НЕ ПараметрОтборПоВладельцу.ВестиУчетПоХарактеристикам Тогда
				Предупреждение("Для номенклатуры """ + ПараметрОтборПоВладельцу + """ не ведется учет по характеристикам!");
				Отказ = Истина;
			КонецЕсли;

		КонецЕсли;

	Иначе
		Предупреждение("Не выбрана номенклатура или не записан редактируемый элемент номенклатуры!");
		Отказ = Истина;

	КонецЕсли;

КонецПроцедуры

