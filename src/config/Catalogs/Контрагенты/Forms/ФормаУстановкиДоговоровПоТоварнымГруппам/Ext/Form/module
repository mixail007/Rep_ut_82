
Процедура ОсновныеДействияФормыУстановить(Кнопка)
	Отказ = Ложь;
	Если не ЗначениеЗаполнено(Подразделение) Тогда
		Сообщить("Не заполнено подразделение");
		отказ = Истина;
	конецЕсли; 
	Если не ЗначениеЗаполнено(Договор) Тогда
		Сообщить("Не заполнен договор");
		отказ = Истина;
	конецЕсли; 
Если не отказ тогда
	Для  каждого стр из ВидыТоваров Цикл
		Если стр.отметка Тогда
			Запись = РегистрыСведений.ДоговорыПоТоварнымГруппам.СоздатьМенеджерЗаписи();
			Запись.контрагент = Контрагент;
			Запись.Договор = Договор;
			Запись.Подразделение= Подразделение;
			Запись.ВидТовара = стр.ВидТовара;
			Запись.КлиентКОЛЕСАТУТ = КонтрагентКОЛЕСАТУТ;
			попытка
				Запись.Записать(ложь);
			исключение
				Сообщить("На вид товара "+стр.видтовара+ " и подразделение "+Подразделение+" уже установлен договор");
			конецПопытки;
		конецЕсли;
	конецЦикла;
конецЕсли;	
КонецПроцедуры

	Процедура ПриОткрытии()
		Контрагент = ЭтаФорма.КлючУникальности;
	Для н=1 по Перечисления.Видытоваров.Количество() Цикл
		Стр = ВидыТоваров.Добавить();
		Стр.ВидТовара=Перечисления.Видытоваров.Получить(н-1);
	КонецЦикла;
КонецПроцедуры

