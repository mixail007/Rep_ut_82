
Процедура ПриОткрытии()
	Если Не РольДоступна("ПолныеПрава") Тогда
		Отбор["Менеджер"].Использование = Истина;
		Отбор["Менеджер"].ВидСравнения = ВидСравнения.Равно;
		Отбор["Менеджер"].Значение = глТекущийПользователь;
		ЭлементыФормы.ЖурналДокументовСписок.НастройкаОтбора["Менеджер"].Доступность = Ложь;
	КонецЕсли;
КонецПроцедуры

Процедура ЖурналДокументовСписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
		//---------Цвет фона-------------------------------------------------
		Если ДанныеСтроки.Ссылка.ПометкаУдаления тогда
		ОформлениеСтроки.ЦветФона = WebЦвета.СветлоСерый;
		
		ИначеЕсли ДанныеСтроки.Состояние = Перечисления.СостоянияОбъектов.Согласован
			или ДанныеСтроки.Состояние = Перечисления.СостоянияОбъектов.Подготовлен тогда //Ждет
			ОформлениеСтроки.ЦветФона = WebЦвета.СветлоЖелтый;
			
		ИначеЕсли (ДанныеСтроки.Состояние = Перечисления.СостоянияОбъектов.Утвержден)
			и ОформлениеСтроки.ячейки.ВидДокумента.текст <> "Установка бонусов" тогда 
				ОформлениеСтроки.ЦветФона = WebЦвета.НейтральноЗеленый; //+++ 21.01.2018 - только для выплаты!
				
		ИначеЕсли ДанныеСтроки.Состояние = Перечисления.СостоянияОбъектов.Отклонен
				или ДанныеСтроки.Состояние = Перечисления.СостоянияОбъектов.Отложен тогда
			ОформлениеСтроки.ЦветФона = WebЦвета.СветлоРозовый;
		
		ИначеЕсли ДанныеСтроки.Состояние = Перечисления.СостоянияОбъектов.Выполнен тогда //если уже выполнена выплата!
				ОформлениеСтроки.ЦветФона   = WebЦвета.СветлоСерый;
		КонецЕсли;
		
		//-----------жирный----------------------------------------
		Если ДанныеСтроки.Состояние = Перечисления.СостоянияОбъектов.Утвержден 
					или ДанныеСтроки.Состояние = Перечисления.СостоянияОбъектов.Выполнен
					или ДанныеСтроки.Состояние = Перечисления.СостоянияОбъектов.Согласован тогда
			ОформлениеСтроки.Шрифт = новый Шрифт(ОформлениеСтроки.Шрифт,,,Истина);
		КонецЕсли;
	
		//-----------Цвет текста----------------------------------------
		Если ДанныеСтроки.Ссылка.Выполнен тогда
			ОформлениеСтроки.ЦветТекста = webЦвета.Синий;
		КонецЕсли;
	
		Если ЕстьРеквизитДокумента("ВидОперации", ДанныеСтроки.ссылка.Метаданные()) тогда
			Если ДанныеСтроки.ссылка.ВидОперации = Перечисления.ВидыОперацийУстановкаБонуса.Удаление  тогда
			ОформлениеСтроки.ЦветТекста = webЦвета.ТемноКрасный;
			КонецЕсли;
		КонецЕсли;
	
	
КонецПроцедуры

Процедура ДействияФормыСтавкиБонусов(Кнопка)
	
	стр1 = ЭлементыФормы.ЖурналДокументовСписок.ТекущиеДанные;
	Если стр1<>Неопределено тогда
	форма = РегистрыСведений.СтавкиБонусовКонтрагентов.ПолучитьФормуСписка();
	форма.Отбор.Контрагент.Значение = стр1.ссылка.Контрагент;
	форма.Отбор.Контрагент.Использование = Истина;
	форма.Отбор.Основание.Значение = стр1.ссылка;
	форма.Отбор.Основание.Использование = Истина;
	//чтоб не менял никто и ничё!
	форма.ЭлементыФормы.РегистрСведенийСписок.ТолькоПросмотр = Истина;
	форма.ЭлементыФормы.РегистрСведенийСписок.НастройкаОтбора.Контрагент.Доступность = ЛОЖЬ;
	форма.ЭлементыФормы.РегистрСведенийСписок.НастройкаОтбора.Основание.Доступность = РольДоступна("ПравоЗавершенияРаботыПользователей");
	
//много места на экране то что нельзя изменить
	форма.ЭлементыФормы.РегистрСведенийСписок.Колонки.Контрагент.Видимость = ЛОЖЬ;
	форма.ЭлементыФормы.РегистрСведенийСписок.Колонки.Основание.Видимость = ЛОЖЬ;
	
	форма.Открыть();
	КонецЕсли;

КонецПроцедуры
