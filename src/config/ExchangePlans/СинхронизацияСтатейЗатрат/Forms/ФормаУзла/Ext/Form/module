////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ
// 

Перем РегистрацияВНовыйУзел;

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ
// 

// Процедура обработчик события ПередОткрытием
// Процедура запрещает редактирование реквизита Главный для этого узла
//
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если Ссылка = ПланыОбмена.СинхронизацияСтатейЗатрат.ЭтотУзел() Тогда
		
		// Для текущего узла ввод этих данных не имеет смысла
		ЭлементыФормы.Главный.Доступность = Ложь;
		// Для текущего узла заполнение реквизита АдресОбмена не имеет смысла
		ЭлементыФормы.АдресОбмена.Доступность = Ложь;
		
	КонецЕсли;
	
КонецПроцедуры // ПередОткрытием(Отказ, СтандартнаяОбработка)

// Процедура обработчик события ПередЗаписью
// Для нового узла процедура устанавливает признак полной регистрации изменений данных
//
Процедура ПередЗаписью(Отказ)
	
	РегистрацияВНовыйУзел = Ложь;
	
	Если ЭтоНовый() Тогда
		
		Если Вопрос("Будет выполнена регистрация изменений всех данных для нового узла.
					|Продолжить?", РежимДиалогаВопрос.ДаНет) = КодВозвратаДиалога.Нет Тогда	
					
			Отказ = Истина;
			
		КонецЕсли;	
		
		РегистрацияВНовыйУзел = Истина;
		
	КонецЕсли;	
	
КонецПроцедуры // ПередЗаписью(Отказ)

// Процедура обработчик события ПриЗаписи
// Если необходимо, то процедура вызывает полную регистрацию изменений
// данных для данного узла
//
Процедура ПриЗаписи(Отказ)
	
	Если РегистрацияВНовыйУзел Тогда
		
		ПолнаяРегистрацияДанныхПоУзлу(Ссылка, Ложь);
		
	КонецЕсли;	
	
КонецПроцедуры // ПриЗаписи(Отказ)

// Процедура обработчик события Открытие поля ввода АдресОбмена
// Производит попытку открытия
// 
Процедура АдресОбменаОткрытие(Элемент, СтандартнаяОбработка)
	
	// Пытаемся открыть указанный каталог
	ЗапуститьПриложение(Элемент.Значение);
	
КонецПроцедуры	// АдресОбменаОткрытие(Элемент, СтандартнаяОбработка)

// Процедура обработчик события НачалоВыбора поля ввода АдресОбмена
// Открывает диалог выбора каталога
//
Процедура АдресОбменаНачалоВыбора(Элемент, СтандартнаяОбработка)
	
	// Выбор каталога обмена
	ДиалогФыбораФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.ВыборКаталога);
	ДиалогФыбораФайла.Каталог = Элемент.Значение;
	ДиалогФыбораФайла.Заголовок = "Выберите каталог обмена";
	Если ДиалогФыбораФайла.Выбрать() Тогда
		
		Элемент.Значение = ДиалогФыбораФайла.Каталог;
		
	КонецЕсли;
	
КонецПроцедуры	// АдресОбменаНачалоВыбора(Элемент, СтандартнаяОбработка)

Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	// Вставить содержимое обработчика.
КонецПроцедуры




