
Процедура ДокументПриИзменении(Элемент)
	ЗаполнитьВсеРеквизитыПоДокументу( Документ )
КонецПроцедуры

Процедура ПриОткрытии()
	
	Если Период='00010101' тогда //новая запись?!
		Период = ТекущаяДата();
		Если ПечФорма=неопределено тогда //новая запись - руками можно выбрать Вид Вх./Исх.Док!
			Входящий = ложь;
			Флажок1ПриИзменении(неопределено);
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры


процедура ЗаполнитьВсеРеквизитыПоДокументу( Док ) 
		
	ДатаДокумента     = Док.Дата;
	
	Если ЕстьРеквизитДокумента("Контрагент", Док.Метаданные() ) тогда
		Контрагент    = Док.Контрагент;
	Иначе
		Контрагент  = справочники.Контрагенты.ПустаяСсылка();
	КонецЕсли;
	
	Если ЕстьРеквизитДокумента("ДоговорКонтрагента", Док.Метаданные() ) тогда
		Менеджер = Док.ДоговорКонтрагента.ОтветственноеЛицо;
	Иначе 
		Менеджер = Контрагент.ОсновнойМенеджерКонтрагента;
	КонецЕсли;
	
КонецПроцедуры


Процедура штрихКодПриИзменении(Элемент)
	
	Если штрихКод="" тогда //очистили ШК
		возврат;
	КонецЕсли;	
	
	ВидПФ    = Сред( штрихКод, 3, 1);     //для русской раскладки...
	ПечФорма = ПолучитьВидПечатнойФормы( ВидПФ );

	Период = ТекущаяДата();	
	
	штрихКод = стрЗаменить(штрихКод, "НЫ","YS");
	штрихКод = стрЗаменить(штрихКод, "ОФЫРЕ","ЯШТ");
	
	Документ = ПолучитьДокументПоШК( штрихКод );
	Если ЗначениеНеЗаполнено(Документ) тогда
		Предупреждение("Не найден документ по Штрих-Коду!",30);
		сигнал();
		Возврат;
	КонецЕсли;
	
	ЗаполнитьВсеРеквизитыПоДокументу(Документ);

КонецПроцедуры


Процедура Флажок1ПриИзменении(Элемент)
	Если Входящий тогда
		Если НЕ значениеЗаполнено(ПечФорма) тогда
		ЭлементыФормы.Надпись2.Заголовок = "Вид документа:";
		ПечФорма = перечисления.ВидыВходящихДокументов.ПустаяСсылка();
		КонецЕсли;
	иначе
		Если НЕ значениеЗаполнено(ПечФорма) тогда
		ЭлементыФормы.Надпись2.Заголовок = "Печатная формы:";
		ПечФорма = перечисления.ВидыПечатныхФорм.ПустаяСсылка();
		КонецЕсли;
	КонецЕсли;	
КонецПроцедуры

Процедура ПечФормаПриИзменении(Элемент)
	Если НЕ значениеЗаполнено(Документ) и ЗначениеЗаполнено(ПечФорма) тогда
		
		Если ПечФорма = перечисления.ВидыВходящихДокументов.ТоварнаяНакладная
			или ПечФорма = перечисления.ВидыВходящихДокументов.ТТН
			или ПечФорма = перечисления.ВидыВходящихДокументов.УПД 
			или ПечФорма = перечисления.ВидыВходящихДокументов.Спецификация
			или ПечФорма = перечисления.ВидыВходящихДокументов.СчетФактура 
			или ПечФорма = перечисления.ВидыВходящихДокументов.АктПени тогда
			документ = документы.РеализацияТоваровУслуг.ПустаяСсылка();
			
		ИначеЕсли ПечФорма = перечисления.ВидыВходящихДокументов.АктТранспортные тогда
			документ = документы.ПоступлениеТоваровУслуг.ПустаяСсылка();
		КонецЕсли;	
			
КонецПроцедуры
