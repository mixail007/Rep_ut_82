
Процедура ДокументПриИзменении(Элемент)
	ЗаполнитьВсеРеквизитыПоДокументу( Документ )
КонецПроцедуры

Процедура ПриОткрытии()
	
	Если Период='00010101' тогда //новая запись?!
		Период = ТекущаяДата();
	КонецЕсли;
	
	Если ПечФорма=неопределено тогда //новая запись - руками можно выбрать Вид Вх./Исх.Док!
		ПечФорма = перечисления.ВидыВходящихДокументов.ПустаяСсылка();
	КонецЕсли;
	
КонецПроцедуры


процедура ЗаполнитьВсеРеквизитыПоДокументу( Док ) 
		
	ДатаДокумента     = Док.Дата;
	
	Если ЕстьРеквизитДокумента("Контрагент", Док.Метаданные() ) тогда
		Контрагент    = Док.Контрагент;
	Иначе
		Контрагент  = справочники.Контрагенты.ПустаяСсылка();
	КонецЕсли;
	
	Если ЕстьРеквизитДокумента("ДоговорКонтрагента", Док.Метаданные() ) тогда
		Менеджер = Док.ДоговорКонтрагента.ОтветственноеЛицо;
	Иначе 
		Менеджер = Контрагент.ОсновнойМенеджерКонтрагента;
	КонецЕсли;
	
КонецПроцедуры


Процедура штрихКодПриИзменении(Элемент)
	
	Если штрихКод="" тогда //очистили ШК
		возврат;
	КонецЕсли;	
	
	ВидПФ    = Сред( штрихКод, 3, 1);     //для русской раскладки...
	ПечФорма = ПолучитьВидПечатнойФормы( ВидПФ );

	Период = ТекущаяДата();	
	
	штрихКод = стрЗаменить(штрихКод, "НЫ","YS");
	штрихКод = стрЗаменить(штрихКод, "ОФЫРЕ","ЯШТ");
	
	Документ = ПолучитьДокументПоШК( штрихКод );
	Если ЗначениеНеЗаполнено(Документ) тогда
		Предупреждение("Не найден документ по Штрих-Коду!",30);
		сигнал();
		Возврат;
	КонецЕсли;
	
	ЗаполнитьВсеРеквизитыПоДокументу(Документ);

КонецПроцедуры
	