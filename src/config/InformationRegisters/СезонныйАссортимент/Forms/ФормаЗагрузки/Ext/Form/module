
Процедура ОсновныеДействияФормыЗагрузить(Кнопка)
		КоличествоЭлементов = ЭлементыФормы.ТабличныйДокумент.ВысотаТаблицы - Начальнаястрока + 1;
		Если КоличествоЭлементов <= 0 Тогда
			Предупреждение("Нет данных для загрузки");
			Возврат ;
		КонецЕсли;
		Для К = Начальнаястрока По ЭлементыФормы.ТабличныйДокумент.ВысотаТаблицы Цикл
			КодНоменклатуры= СокрЛП(ЭлементыФормы.ТабличныйДокумент.Область("R"+Формат(К,"ЧГ=")+"C"+Формат(номенклатураКолонка,"ЧГ=")).Текст);
			номенклатура = Справочники.Номенклатура.НайтиПоКоду(КодНоменклатуры);
			Завод= Элементыформы.ТабличныйДокумент.Область("R"+Формат(К,"ЧГ=")+"C"+Формат(ЗаводКолонка,"ЧГ=")).Текст;
			если Номенклатура <> Справочники.Номенклатура.ПустаяСсылка() Тогда
				Если ЗначениеЗаполнено(сокрЛП(Завод)) Тогда
					//проверим на базовую цену
					БазовыйТип = Справочники.ТипыЦенНоменклатуры.НайтиПоКоду("00008");
					отбор = новый структура;
					Отбор.Вставить("ТипЦен",БазовыйТип);
					Отбор.Вставить("Номенклатура",Номенклатура);
					//	отбор.Вставить("ХарактеристикаНоменклатуры", справочники.ХарактеристикиНоменклатуры.ПустаяСсылка());
					ЗаписьСБазовой = регистрыСведений.ЦеныНоменклатуры.ПолучитьПоследнее(ТекущаяДата(),Отбор);
					Если ЗаписьСБазовой.Цена <> 0 Тогда
						Менеджер = РегистрыСведений.СезонныйАссортимент.СоздатьМенеджерЗаписи();
						Менеджер.Номенклатура = Номенклатура;
						Менеджер.Завод = Завод;
						Если замещать Тогда
							Менеджер.Записать();
						иначе
							попытка
								Менеджер.Записать(ложь);
							исключение
							конецпопытки;
						конецесли;
					иначе
					сообщить("строка № "+К+" не загружена. Для номенклатуры с кодом "+кодНоменклатуры+ " не установлена базовая цена! ");  
	
					конецЕсли;
				иначе
					сообщить("строка № "+К+" не загружена. Не указан завод! ");  
				конецЕсли;
			иначе
				сообщить("строка № "+К+" не загружена. Не найдена номенклатура с кодом "+ КодНоменклатуры+" !");  
			конецесли;  
		конецЦикла;
КонецПроцедуры

Процедура ПриОткрытии()
	НачальнаяСтрока = 1;
	НоменклатураКолонка = 1;
	ЗаводКолонка = 2;
КонецПроцедуры
